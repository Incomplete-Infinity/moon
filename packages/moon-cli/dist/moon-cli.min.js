#!/usr/bin/env node
/**
 * Moon CLI v1.0.0-beta.4
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(){"use strict";var c=require("fs"),s=require("path"),n=require("https"),r=require("child_process").exec,u=process.argv[2],o=process.argv[3]||"kbrsh/moon-template",e={method:"GET",host:"api.github.com",path:"/repos/"+o+"/tarball/master",headers:{"User-Agent":"Node.js"}};function l(e,n){console.log("\x1b[34m"+e+"\x1b[0m "+n)}function f(e,n,t){var r=e.indexOf(n);if(-1===r)return e;var o=e.slice(0,r),i=f(e.slice(r+n.length),n,t),a=Buffer.from(t);return Buffer.concat([o,a,i],o.length+a.length+i.length)}function t(e){var n=s.join(__dirname,"moon-template.tar.gz"),t=c.createWriteStream(n);e.on("data",function(e){t.write(e)}),e.on("end",function(){t.end(),l("download",o),function(n){var t=s.join(process.cwd(),u);r("mkdir "+t,function(e){if(e)throw e;r("tar -xzf "+n+" -C "+t+" --strip=1",function(e){if(e)throw e;l("install",t),function(n,t){c.unlink(n,function(e){if(e)throw e;l("clean",n),function e(n,t){var r=c.readdirSync(n);for(var o=0;o<r.length;o++){var i=r[o],a=s.join(n,i);c.statSync(a).isDirectory()?e(a,t):(c.writeFileSync(a,f(c.readFileSync(a),"{# MoonName #}",u)),l("create",s.relative(t,a)))}}(t,t),l("success",'Generated project "'+u+'"'),console.log("To start, run:\n\tcd "+u+"\n\tnpm install\n\tnpm run dev")})}(n,t)})})}(n)})}l("Moon","Generating project"),n.get(e,function(e){300<=e.statusCode&&e.statusCode<400&&void 0!==e.headers.location?n.get(e.headers.location,function(e){t(e)}):t(e)})}();