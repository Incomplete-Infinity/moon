/**
 * Moon Browser v1.0.0-beta.4
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(){"use strict";function c(e,n){this.expected=e,this.index=n}var t={type:function(r,a){return function(e,n){var t=a(e,n);return t instanceof c?t:[{type:r,value:t[0]},t[1]]}},EOF:function(e,n){return n===e.length?["EOF",n]:new c("EOF",n)},empty:function(e,n){return["",n]},any:function(e,n){return n<e.length?[e[n],n+1]:new c("any",n)},character:function(r){return function(e,n){var t=e[n];return t===r?[t,n+1]:new c('"'+r+'"',n)}},regex:function(r){return function(e,n){var t=e[n];return void 0!==t&&r.test(t)?[t,n+1]:new c(r.toString(),n)}},string:function(r){return function(e,n){var t=n+r.length;return e.slice(n,t)===r?[r,t]:new c('"'+r+'"',n)}},not:function(a){return function(e,n){if(n<e.length){for(var t=0;t<a.length;t++){var r=a[t];if(e.slice(n,n+r.length)===r)return new c('not "'+r+'"',n)}return[e[n],n+1]}return new c("not "+a.map(JSON.stringify).join(", "),n)}},or:function(a,o){return function(e,n){var t=a(e,n);if(t instanceof c){var r=o(e,n);return r instanceof c&&t.index>r.index?t:r}return t}},and:function(a,o){return function(e,n){var t=a(e,n);if(t instanceof c)return t;var r=o(e,t[1]);return r instanceof c?r:[[t[0],r[0]],r[1]]}},sequence:function(o){return function(e,n){for(var t=[],r=0;r<o.length;r++){var a=o[r](e,n);if(a instanceof c)return a;t.push(a[0]),n=a[1]}return[t,n]}},alternates:function(o){return function(e,n){for(var t=new c("alternates",-1),r=0;r<o.length;r++){var a=o[r](e,n);if(!(a instanceof c))return a;a.index>t.index&&(t=a)}return t}},many:function(a){return function(e,n){for(var t,r=[];!((t=a(e,n))instanceof c);)r.push(t[0]),n=t[1];return[r,n]}},many1:function(a){return function(e,n){var t=[],r=a(e,n);if(r instanceof c)return r;for(t.push(r[0]),n=r[1];!((r=a(e,n))instanceof c);)t.push(r[0]),n=r[1];return[t,n]}}},r={whitespace:t.alternates([t.character(" "),t.character("\t"),t.character("\n")]),whitespaces:function(e,n){return t.many(r.whitespace)(e,n)},identifier:t.many1(t.regex(/[@$\w.?]/)),string:t.alternates([t.sequence([t.character('"'),t.many(t.or(t.and(t.character("\\"),t.any),t.not(['"']))),t.character('"')]),t.sequence([t.character("'"),t.many(t.or(t.and(t.character("\\"),t.any),t.not(["'"]))),t.character("'")]),t.sequence([t.character("`"),t.many(t.or(t.and(t.character("\\"),t.any),t.not(["`"]))),t.character("`")])]),block:function(e,n){return t.type("block",t.sequence([t.character("{"),r.expression,t.character("}")]))(e,n)},value:function(e,n){return t.alternates([r.string,r.block,r.identifier])(e,n)},text:t.type("text",t.many1(t.or(t.and(t.character("\\"),t.any),t.not(["{","<"])))),attributes:function(e,n){return t.type("attributes",t.many(t.sequence([r.identifier,t.character("="),r.value,r.whitespaces])))(e,n)},node:function(e,n){return t.type("node",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,t.string("#>")]))(e,n)},nodeData:function(e,n){return t.type("nodeData",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,t.or(r.block,r.attributes),t.string("/>")]))(e,n)},nodeDataChildren:function(e,n){return t.type("nodeDataChildren",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,r.attributes,t.character(">"),t.many(t.alternates([r.node,r.nodeData,r.nodeDataChildren,r.block,r.text])),t.string("</"),t.many(t.not([">"])),t.character(">")]))(e,n)},expression:function(e,n){return t.many(t.alternates([t.sequence([t.string("//"),t.many(t.not(["\n"]))]),t.sequence([t.string("/*"),t.many(t.not(["*/"])),t.string("*/")]),t.sequence([t.character("/"),t.many1(t.or(t.and(t.character("\\"),t.not(["\n"])),t.not(["/","\n"]))),t.character("/")]),r.string,r.block,r.node,r.nodeData,r.nodeDataChildren,t.and(t.alternates([t.character("/"),t.character("<"),t.empty]),t.many1(t.not(["/","{","}","<",'"',"'","`"])))]))(e,n)},main:function(e,n){return t.and(r.expression,t.EOF)(e,n)}};function a(e){return r.main(e,0)}a.Error=c;var m=/^\s+$/,g=/([^\\])("|\n)/g;function x(e){return"block"===e.type?"("+q(e.value[1])+")":q(e)}function w(e){for(var n=e.value,t="",r="",a=0;a<n.length;a++){var o=n[a];t+=r+'"'+q(o[0])+'":'+x(o[2])+q(o[3]),r=","}return{output:t,separator:r}}function q(e){var n=e.type;if("string"==typeof e)return e;if(Array.isArray(e)){for(var t="",r=0;r<e.length;r++)t+=q(e[r]);return t}if("block"===n)return q(e.value);if("node"===n){var a=e.value;return q(a[1])+x(a[2])+q(a[3])}if("nodeData"===n){var o=e.value,c=o[4];return""+q(o[1])+x(o[2])+q(o[3])+"("+("attributes"===c.type?"{"+w(c).output+"}":q(c.value[1]))+")"}if("nodeDataChildren"===n){var i,u=e.value,s=w(u[4]),f=u[6],l=f.length;if(0===l)i="";else{var h="";i=s.separator+"children:[";for(var d=0;d<l;d++){var p=f[d],v=p.type;if("text"===v){var y=q(p.value);m.test(y)&&-1!==y.indexOf("\n")?i+=y:(i+=h+'Moon.view.m.text({data:"'+y.replace(g,function(e,n,t){return n+"\\"+t})+'"})',h=",")}else h=(i+="block"===v?h+"Moon.view.m.text({data:"+q(p.value[1])+"})":h+q(p),",")}i+="]"}return""+q(u[1])+x(u[2])+q(u[3])+"({"+s.output+i+"})"}}function p(e,n){for(var t=n-e.length,r=0;r<t;r++)e=" "+e;return e}function o(e){console.error("[Moon] ERROR: "+e)}var i,u={compile:function(e){var n=a(e);return n instanceof a.Error&&o("Invalid input to parser.\n\nAttempted to parse input.\n\nExpected "+n.expected+".\n\nReceived:\n\n"+function(e,n){for(var t=e.split("\n"),r=1,a=1,o=0;o<e.length;o++){var c=e[o];if(o===n){var i=r-1,u=r+1,s=Math.max(Math.floor(Math.log10(i)+1),Math.floor(Math.log10(r)+1),Math.floor(Math.log10(u)+1))+2,f=t[i-1],l=t[r-1],h=t[u-1],d="";return void 0!==f&&(d+=p(i+"| ",s)+f+"\n"),d+=p(r+"| ",s)+l+"\n"+p("| ",s)+p("^",a),void 0!==h&&(d+="\n"+p(u+"| ",s)+h),d}"\n"===c?(r+=1,a=1):a+=1}}(e,n.index)),q(n[0][0])},generate:q,parse:a},s=[];document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll("script");i=document.querySelector("head");for(var n=0;n<e.length;n++){var t=e[n];"text/moon"===t.type&&s.push(t)}!function n(){if(0!==s.length){var t=s.shift(),r=t.src;if(0===r.length){var e=document.createElement("script");e.text=u.compile(t.text),i.appendChild(e),t.parentNode.removeChild(t),n()}else{var a=new XMLHttpRequest;a.onload=function(){if(a.readyState===a.DONE){if(0===a.status||200===a.status){var e=document.createElement("script");e.text=u.compile(a.responseText),i.appendChild(e)}else o('Failed to load script with source "'+r+'" and status '+a.status+".");t.parentNode.removeChild(t),n()}},a.open("GET",r,!0),a.send()}}}()})}();