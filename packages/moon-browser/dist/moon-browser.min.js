/**
 * Moon Browser v1.0.0-beta.4
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(){"use strict";var A=/^\s+$/;function L(e,a){return"\\"!==a&&('"'===e||"'"===e||"`"===e)}function n(e){console.error("[Moon] ERROR: "+e)}var r=/"[^"]*"|'[^']*'|`[^`]*`|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,N=/&amp;|&gt;|&lt;|&nbsp;|&quot;|\\|"|\n|\r/g,i=["Infinity","NaN","break","case","catch","class","const","continue","default","delete","do","else","extends","false","finally","for","function","if","in","instanceof","let","new","null","return","super","switch","this","throw","true","try","typeof","undefined","var","void","while","window"],$={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r"};function z(e){for(var a;null!==(a=r.exec(e));){var t=a[1];if(void 0!==t&&-1===i.indexOf(t))return r.lastIndex=0,!1}return!(r.lastIndex=0)}function y(e){e=e.trim();for(var a=[],t=0;t<e.length;){var r=e[t];if("<"===r){var i=e[t+1];if("/"===i){var n=e.indexOf(">",t+2),l=e.slice(t+2,n);0,a.push({type:"tagClose",value:l}),t=n+1;continue}if("!"===i&&"-"===e[t+2]&&"-"===e[t+3]){var v=e.indexOf("--\x3e",t+4);0,t=v+3;continue}var u="",f="",s=!1,o={},c=!0,d=0;for(t++;t<e.length;t++){var b=e[t];if("{"===b?d+=1:"}"===b&&(d-=1),0===d&&(">"===b||"/"===b&&">"===e[t+1]&&(s=!0)&&(t+=1))){t+=1;break}if(c)A.test(b)?c=!1:"="===b?(c=!1,f+=b):u+=b;else if(L(b,e[t-1]))for(f+=b,t++;t<e.length;t++){var h=e[t];if(f+=h,L(h,e[t-1])&&h===b)break}else f+=b}for(var p=0;p<f.length;p++){var g=f[p];if(!A.test(g)){for(var m="",S="true";p<f.length&&(g=f[p],!A.test(g));p++){if("="===g){S="";break}m+=g}if(0===S.length){var w=f[++p];"{"===w?w="}":S+=w,p+=1;for(var x=0;p<f.length;p++)if("{"===(g=f[p]))x+=1,S+=g;else if("}"===w&&L(g,f[p-1]))for(S+=g,p++;p<f.length;p++){var k=f[p];if(S+=k,L(k,f[p-1])&&k===g)break}else if(g===w){if("}"!==w){S+=g,o[m]={value:S,isStatic:!0};break}if(0===x){o[m]={value:S,isStatic:z(S)};break}x-=1,S+=g}else S+=g}else o[m]={value:S,isStatic:!0}}}a.push({type:"tagOpen",value:u,attributes:o,closed:s})}else if("{"===r){var y="",O=0;for(t++;t<e.length;t++){var C=e[t];if("{"===C)O+=1,y+=C;else if("}"===C){if(0===O)break;O-=1,y+=C}else if(L(C,e[t-1]))for(y+=C,t++;t<e.length;t++){var E=e[t];if(y+=E,L(E,e[t-1])&&E===C)break}else y+=C}a.push({type:"tagOpen",value:"text",attributes:{"":{value:y,isStatic:z(y)}},closed:!0}),t+=1}else{for(var M="";t<e.length;t++){var q=e[t];if("<"===q||"{"===q)break;M+=q}A.test(M)||a.push({type:"tagOpen",value:"text",attributes:{"":{value:'"'+M.replace(N,function(e){return $[e]})+'"',isStatic:!0}},closed:!0})}}return a}function s(e,a,t,r){this.message=e,this.start=a,this.end=t,this.next=r}function o(e,a,t){var r=t[e],i=t[a-1],n=a-e;if(0==n)return new s("",e,a);if(1==n)return"tagOpen"===r.type&&!0===r.closed?{name:r.value,attributes:r.attributes,children:[]}:new s("",e,a);if("tagOpen"!==r.type||"tagClose"!==i.type||r.value!==i.value)return new s("",e,a);var l=function e(a,t,r){var i;if(0==t-a)return[];for(var n=a+1;n<=t;n++){var l=o(a,n,r);if(l instanceof s)i=l;else{var v=e(n,t,r);if(!(v instanceof s)){for(var u=[l],f=0;f<v.length;f++)u.push(v[f]);return u}}}return new s("",a,t,i)}(e+1,a-1,t);return l instanceof s?new s("",e,a,l):{name:r.value,attributes:r.attributes,children:l}}function O(e){var a=o(0,e.length,e);return a}function E(e,a,t,r,i){var n=e+a;if(n in i)return{variable:t,variableStatic:i[n]};var l=i[n]="m"+t++;return r.push({variableStatic:l,variablePart:e+l+"="+a+";"}),{variable:t,variableStatic:l}}function M(e,a,t,r,i){var n,l=q(a.children[0],a,0,t,r,i);if(t=l.variable,l.isStatic){var v=E(l.prelude,l.node,t,r,i);t=v.variable,n=e+"="+v.variableStatic+";"}else n=""+l.prelude+e+"="+l.node+";";return{clause:n,variable:t}}function q(e,a,t,r,i,n){var l=e.name,v=!0,u=!0;if("element"===l)return function(e,a){var t=e.attributes,r=t.name,i=t.data,n=t.children;return{prelude:"",node:"Moon.view.m("+r.value+","+i.value+","+n.value+")",isStatic:r.isStatic&&i.isStatic&&n.isStatic,variable:a}}(e,r);if("if"===l)return function(e,a,t,r,i,n){var l="m"+r,v="",u=!0,f=M(l,e,r+1,i,n);if(v+="if("+e.attributes[""].value+"){"+f.clause+"}",r=f.variable,null!==a)for(var s=a.children,o=t+1;o<s.length;){var c=s[o];if("else-if"===c.name){var d=M(l,c,r,i,n);v+="else if("+c.attributes[""].value+"){"+d.clause+"}",r=d.variable,s.splice(o,1)}else{if("else"!==c.name)break;var b=M(l,c,r,i,n);v+="else{"+b.clause+"}",r=b.variable,u=!1,s.splice(o,1)}}if(u){var h=E("",'Moon.view.m("text",{"":""},[])',r,i,n);r=h.variable,v+="else{"+l+"="+h.variableStatic+";}"}return{prelude:v,node:l,isStatic:!1,variable:r}}(e,a,t,r,i,n);if("for"===l)return function(e,a,t,r){var i,n,l,v,u,f="m"+a,s="m"+(a+1),o="m"+(a+2),c=e.attributes,d=c[""].value,b=q(e.children[0],e,0,a+3,t,r);if(a=b.variable,b.isStatic){var h=E(b.prelude,b.node,a,t,r);a=h.variable,i="return "+h.variableStatic+";"}else i=b.prelude+"return "+b.node+";";if(i=s+"=function("+d+"){"+i+"};",v="in"in c?(l="for("+o+" in "+(n=c.in.value)+"){",o+","+n+"["+o+"]"):(l="for("+o+"=0;"+o+"<"+(n=c.of.value)+".length;"+o+"++){",n+"["+o+"],"+o),"data"in c)u=c.data.value;else{var p=E("","{}",a,t,r);a=p.variable,u=p.variableStatic}return{prelude:f+"=[];"+i+l+f+".push("+s+"("+v+"));}",node:"Moon.view.m("+("name"in c?c.name.value:'"span"')+","+u+","+f+")",isStatic:!1,variable:a}}(e,r,i,n);var f=e.attributes,s="",o="",c="",d="",b="";for(var h in f){var p=f[h];"children"===h?(p.isStatic||(u=!1),c=p.value):(p.isStatic||(v=!1),o+=d+'"'+h+'":'+p.value,d=",")}if(!("children"in f)){var g=e.children,m=[];c+="[";for(var S=0;S<g.length;S++){var w=q(g[S],e,S,r,i,n);w.isStatic||(u=!1),r=w.variable,m.push(w)}for(var x=0;x<m.length;x++){var k=m[x];if(u||!k.isStatic)s+=k.prelude,c+=b+k.node;else{var y=E(k.prelude,k.node,r,i,n);r=y.variable,c+=b+y.variableStatic}b=","}c+="]"}if(!v&&u){var O=E("",c,r,i,n);r=O.variable,c=O.variableStatic}if(l!==l.toLowerCase())return{prelude:s,node:l+"({"+o+d+"children:"+c+"})",isStatic:v&&u,variable:r};if(o="{"+o+"}",v&&!u){var C=E("",o,r,i,n);r=C.variable,o=C.variableStatic}return{prelude:s,node:'Moon.view.m("'+l+'",'+o+","+c+")",isStatic:v&&u,variable:r}}function C(e){for(var a=0,t=0;t<e.length;t++)"\n"===e[t]&&(a+=1);return a}var l,v={compile:function(e){for(var a="",t=0,r=0;r<e.length;){var i=e[r];if("("===i){for(a+=i,r++;r<e.length;r++){var n=e[r];if(!A.test(n))break;a+=n}if("<"===e[r]){for(var l="",v=0;r<e.length;){var u=e[r];if(")"===u&&0===v)break;if(L(u,e[r-1]))for(l+=u,r++;r<e.length;r++){var f=e[r];if(l+=f,L(f,e[r-1])&&f===u){r+=1;break}}else"("===u?v+=1:")"===u&&(v-=1),l+=u,r+=1}var s=[],o={},c=q(O(y(l)),null,0,t,s,o),d=void 0;if(t=c.variable,c.isStatic){var b=E(c.prelude,c.node,t,s,o);t=b.variable,d="(function(){if("+b.variableStatic+"===undefined){"+s[0].variablePart+"}return "+b.variableStatic+";})()"}else d="(function(){"+(0===s.length?"":"if("+s[0].variableStatic+"===undefined){"+s.map(function(e){return e.variablePart}).join("")+"}")+c.prelude+"return "+c.node+";})()";a+=d;for(var h=C(l)-C(d),p=0;p<h;p++)a+="\n"}}else if(L(i,e[r-1]))for(a+=i,r++;r<e.length;r++){var g=e[r];if(a+=g,L(g,e[r-1])&&g===i){r+=1;break}}else if("/"===i&&"/"===e[r+1])for(;r<e.length;r++){var m=e[r];if(a+=m,"\n"===m){r+=1;break}}else if("/"===i&&"*"===e[r+1])for(a+="/*",r+=2;r<e.length;r++){var S=e[r];if(a+=S,"*"===S&&"/"===e[r+1]){a+="/",r+=2;break}}else a+=i,r+=1}var w="",x="";if(0!==t){w+="var ";for(var k=0;k<t;k++)w+=x+"m"+k,x=",";w+=";"}return w+a},generate:q,lex:y,parse:O},u=[];document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll("script");l=document.querySelector("head");for(var a=0;a<e.length;a++){var t=e[a];"text/moon"===t.type&&u.push(t)}!function a(){if(0!==u.length){var t=u.shift(),r=t.src;if(0===r.length){var e=document.createElement("script");e.text=v.compile(t.text),l.appendChild(e),t.parentNode.removeChild(t),a()}else{var i=new XMLHttpRequest;i.addEventListener("load",function(){if(i.readyState===i.DONE){if(0===i.status||200===i.status){var e=document.createElement("script");e.text=v.compile(i.responseText),l.appendChild(e)}else n('Failed to load script with source "'+r+'" and status '+i.status+".");t.parentNode.removeChild(t),a()}}),i.open("GET",r,!0),i.send()}}}()})}();