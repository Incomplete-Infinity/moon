/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";function o(){}function a(e,t){return void 0===e?t:e}var w=/<([\w\d-_]+)([^>]*?)(\/?)>/g,k=/\s*([\w\d-_]*)(?:=(?:("[\w\d-_]*"|'[\w\d-_]*')|{([\w\d-_]*)}))?/g;function t(e){e=e.trim();for(var t=[],n=0;n<e.length;){var c=e[n];if("<"===c){var r=e[n+1];if("/"===r){var o=e.indexOf(">",n+2),a=e.slice(n+2,o);t.push({type:"tagClose",value:a}),n=o+1;continue}if("!"===r&&"-"===e[n+2]&&"-"===e[n+3]){n=e.indexOf("--\x3e",n+4)+3;continue}w.lastIndex=n;for(var i=w.exec(e),u=i[0],l=i[1],f=i[2],s=i[3],m={},v=void 0;null!==(v=k.exec(f));){var p=v[0],d=v[1],y=v[2],h=v[3];0===p.length?k.lastIndex+=1:m[d]=void 0===h?y:h}t.push({type:"tagOpen",value:l,attributes:m,closed:"/"===s}),n+=u.length}else if("{"===c){var g="";for(n+=1;n<e.length;n++){var x=e[n];if("}"===x)break;g+=x}t.push({type:"tagOpen",value:"Text",attributes:{"":g},closed:!0}),n+=1}else{for(var b="";n<e.length;n++){var E=e[n];if("<"===E||"{"===E)break;b+=E}t.push({type:"tagOpen",value:"Text",attributes:{"":'"'.concat(b,'"')},closed:!0})}}return t}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t,n,c){this.message=e,this.start=t,this.end=n,this.next=c}function f(e,t,n){var c=n[e],r=n[t-1],o=t-e;if(0==o)return new l("",e,t);if(1==o)return"tagOpen"===c.type&&!0===c.closed?{type:c.value,attributes:c.attributes,children:[]}:new l("",e,t);if("tagOpen"!==c.type||"tagClose"!==r.type||c.value!==r.value)return new l("",e,t);var a=function e(t,n,c){var r;if(0==n-t)return[];for(var o=t+1;o<=n;o++){var a=f(t,o,c);if(a instanceof l)r=a;else{var i=e(o,n,c);if(!(i instanceof l))return[a].concat(u(i))}}return new l("",t,n,r)}(e+1,t-1,n);return a instanceof l?new l("",e,t,a):{type:c.value,attributes:c.attributes,children:a}}function n(e){var t=f(0,e.length,e);return t}var ee=function(e){return"m".concat(e)},te=function(e,t){return"".concat(ee(e),"=").concat(t)},ne=function(e){return e.expression?e.value:'"'.concat(e.value,'"')},ce=function(e,t){return"m.rc(".concat(ee(e),",").concat(ee(t),");")},re=function(e,t,n,c,r,o){return"m.df(".concat(e,",").concat(ee(t),",").concat(n,",").concat(ee(c),",").concat(ee(r),",").concat(ee(o),");")},oe=function(e,t,n){return null===n?function(e,t){return"m.ac(".concat(ee(e),",").concat(ee(t),");")}(e,t):function(e,t,n){return"m.ib(".concat(ee(e),",").concat(ee(t),",").concat(ee(n),");")}(e,n,t)},s=function e(t,n,c,r){switch(t.type){case"If":for(var o=c.nextElement++,a=c.nextElement++,i=c.nextElement++,u=c.nextElement++,l="[",f="[",s="",m=n.children,v=m.indexOf(t);v<m.length;v++){var p=m[v];if("If"!==p.type&&"ElseIf"!==p.type&&"Else"!==p.type)break;l+=s+("Else"===p.type?"true":ne(p.attributes[0])),f+=s+"function(locals){"+ae({element:c.nextElement,nextElement:c.nextElement+1,type:"Root",attributes:[],children:p.children},a)+"}({})",s=","}return[te(a,"m.cc();")+oe(a,n.element,r)+te(u,f+"];"),te(i,l+"];")+te(o,function(e,t,n,c){return"m.di(".concat(ee(e),",").concat(ee(t),",").concat(ee(n),",").concat(ee(c),");")}(o,i,u,n.element)),ee(o)+"[2]();"];case"ElseIf":case"Else":return["","",""];case"For":for(var d=ne(t.attributes[0]),y="[",h="",g=c.nextElement++,x=c.nextElement++,b=c.nextElement++,E=c.nextElement++,w="",k="",O=0;O<d.length;O++){var I=d[O];","===I||" "===I&&"i"===d[O+1]&&"n"===d[O+2]&&" "===d[O+3]&&(O+=3)?(y+=k+'"'+w.substring(7)+'"',w="",k=","):w+=I}return y+="]",h+=w,[te(g,"m.cc();")+oe(g,n.element,r)+te(x,"function(locals){"+ae({element:c.nextElement,nextElement:c.nextElement+1,type:"Root",attributes:[],children:t.children},g)+"};")+te(b,"[];")+te(E,"[];"),re(y,E,h,x,b,n.element),re(y,E,"[]",x,b,n.element)];case"Text":var $=t.attributes[0],_=c.nextElement++,C=function(e,t){return"m.stc(".concat(ee(e),",").concat(t,");")}(_,ne($)),A=te(_,function(e){return"m.ctn(".concat(e,");")}('""')),T="";return $.dynamic?T+=C:A+=C,[A+oe(_,n.element,r),T,ce(_,n.element)];default:var j=t.attributes,R=t.children;if(function(e){return e[0]===e[0].toUpperCase()&&e[0]!==e[0].toLowerCase()}(t.type)){t.component=c.nextElement++;for(var S=te(t.component,"new m.c.".concat(t.type,"();")),U="",D=!1,q=0;q<j.length;q++){var F=j[q];if("@"===F.key[0])S+="".concat(ee(t.component),'.on("').concat(F.key.substring(1),'",function($event){locals.$event=$event;').concat(ne(F),";});");else{var L="".concat(ee(t.component),".").concat(F.key,"=").concat(ne(F),";");F.dynamic?(D=!0,U+=L):S+=L}}return S+="".concat(ee(t.component),".create(").concat(ee(n.element),");"),D?U+="".concat(ee(t.component),".update();"):S+="".concat(ee(t.component),".update();"),[S,U,"".concat(ee(t.component),".destroy();")]}t.element=c.nextElement++;for(var M=te(t.element,function(e){return'm.ce("'.concat(e,'");')}(t.type)),z="",B=0;B<j.length;B++){var G=j[B],H=void 0;if("@"===G.key[0]){var J=void 0,K=void 0;if("@bind"===G.key){var N=ne(G);H="".concat(ee(t.element),".value=").concat(N,";"),J="input",K="".concat(N,"=$event.target.value;instance.update();")}else H="",J=G.key.substring(1),K="locals.$event=$event;".concat(ne(G),";");M+=(X=t.element,Y=J,Z="function($event){".concat(K,"}"),"m.ael(".concat(ee(X),',"').concat(Y,'",').concat(Z,");"))}else V=t.element,W=G,H="m.sa(".concat(ee(V),',"').concat(W.key,'",').concat(ne(W),");");G.dynamic?z+=H:M+=H}for(var P=0;P<R.length;P++){var Q=e(R[P],t,c,null);M+=Q[0],z+=Q[1]}return[M+oe(t.element,n.element,r),z,ce(t.element,n.element)]}var V,W,X,Y,Z},ae=function(e,t){for(var n=e.children,c="",r="",o="",a=0;a<n.length;a++){var i=s(n[a],e,e,t);c+=i[0],r+=i[1],o+=i[2]}for(var u="var ".concat(ee(e.element)),l=e.element+1;l<e.nextElement;l++)u+=","+ee(l);return"".concat(u,";return [function(_0){").concat(te(e.element,"_0;")).concat(c,"},function(){").concat(r,"},function(){").concat(o,"}];")};function i(e){return n(t(e))}function e(e){function t(){}(t.prototype=e).name=a(e.name,"Root");var n=e.view;"string"==typeof n&&(n=i(n)),e.view=n,e.onCreate=a(e.onCreate,o),e.onUpdate=a(e.onUpdate,o),e.onDestroy=a(e.onDestroy,o);var c=e.root;if(delete e.root,"string"==typeof c&&(c=document.querySelector(c)),void 0===c)return t;var r=new t;return r.create(c),r}return e.lex=t,e.parse=n,e.generate=ae,e.compile=i,e});