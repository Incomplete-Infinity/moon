/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";function a(){}function i(e,t){return void 0===e?t:e}var w=/<([\w\d-_]+)([^>]*?)(\/?)>/g,k=/\s*([\w\d-_]*)(?:=(?:("[\w\d-_]*"|'[\w\d-_]*')|{([\w\d-_]*)}))?/g;function t(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var o=e[n+1];if("/"===o){var a=e.indexOf(">",n+2),i=e.slice(n+2,a);t.push({type:"tagClose",value:i}),n=a+1;continue}if("!"===o&&"-"===e[n+2]&&"-"===e[n+3]){e.indexOf("--\x3e",n+4);n=e.indexOf("--\x3e",n+4)+3;continue}w.lastIndex=n;for(var u=w.exec(e),l=u[0],c=u[1],f=u[2],s=u[3],m={},v=void 0;null!==(v=k.exec(f));){var p=v[0],d=v[1],y=v[2],x=v[3];0===p.length?k.lastIndex+=1:m[d]=void 0===x?y:x}t.push({type:"tagOpen",value:c,attributes:m,closed:"/"===s}),n+=l.length}else if("{"===r){var h="";for(n+=1;n<e.length;n++){var g=e[n];if("}"===g)break;h+=g}t.push({type:"tagOpen",value:"Text",attributes:{"":h},closed:!0}),n+=1}else{for(var E="";n<e.length;n++){var b=e[n];if("<"===b||"{"===b)break;E+=b}t.push({type:"tagOpen",value:"Text",attributes:{"":'"'+E+'"'},closed:!0})}}return t}function c(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function f(e,t,n){var r=n[e],o=n[t-1],a=t-e;if(0==a)return new c("",e,t);if(1==a)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new c("",e,t);if("tagOpen"!==r.type||"tagClose"!==o.type||r.value!==o.value)return new c("",e,t);var i=function e(t,n,r){var error;if(0==n-t)return[];for(var o=t+1;o<=n;o++){var a=f(t,o,r);if(a instanceof c)error=a;else{var i=e(o,n,r);if(!(i instanceof c)){for(var u=[a],l=0;l<i.length;l++)u.push(i[l]);return u}}}return new c("",t,n,error)}(e+1,t-1,n);return i instanceof c?new c("",e,t,i):{type:r.value,attributes:r.attributes,children:i}}function n(e){var t=f(0,e.length,e);return t}var ee=function(e){return"m"+e},te=function(e,t){return ee(e)+"="+t},ne=function(e){return e.expression?e.value:'"'+e.value+'"'},re=function(e,t){return"m.rc("+ee(e)+","+ee(t)+");"},oe=function(e,t,n,r,o,a){return"m.df("+e+","+ee(t)+","+n+","+ee(r)+","+ee(o)+","+ee(a)+");"},ae=function(e,t,n){return null===n?function(e,t){return"m.ac("+ee(e)+","+ee(t)+");"}(e,t):function(e,t,n){return"m.ib("+ee(e)+","+ee(t)+","+ee(n)+");"}(e,n,t)},s=function e(t,n,r,o){switch(t.type){case"If":for(var a=r.nextElement++,i=r.nextElement++,u=r.nextElement++,l=r.nextElement++,c="[",f="[",s="",m=n.children,v=m.indexOf(t);v<m.length;v++){var p=m[v];if("If"!==p.type&&"ElseIf"!==p.type&&"Else"!==p.type)break;c+=s+("Else"===p.type?"true":ne(p.attributes[0])),f+=s+"function(locals){"+ie({element:r.nextElement,nextElement:r.nextElement+1,type:"Root",attributes:[],children:p.children},i)+"}({})",s=","}return[te(i,"m.cc();")+ae(i,n.element,o)+te(l,f+"];"),te(u,c+"];")+te(a,function(e,t,n,r){return"m.di("+ee(e)+","+ee(t)+","+ee(n)+","+ee(r)+");"}(a,u,l,n.element)),ee(a)+"[2]();"];case"ElseIf":case"Else":return["","",""];case"For":for(var d=ne(t.attributes[0]),y="[",x="",h=r.nextElement++,g=r.nextElement++,E=r.nextElement++,b=r.nextElement++,w="",k="",O=0;O<d.length;O++){var $=d[O];","===$||" "===$&&"i"===d[O+1]&&"n"===d[O+2]&&" "===d[O+3]&&(O+=3)?(y+=k+'"'+w.substring(7)+'"',w="",k=","):w+=$}return y+="]",x+=w,[te(h,"m.cc();")+ae(h,n.element,o)+te(g,"function(locals){"+ie({element:r.nextElement,nextElement:r.nextElement+1,type:"Root",attributes:[],children:t.children},h)+"};")+te(E,"[];")+te(b,"[];"),oe(y,b,x,g,E,n.element),oe(y,b,"[]",g,E,n.element)];case"Text":var _=t.attributes[0],C=r.nextElement++,I=function(e,t){return"m.stc("+ee(e)+","+t+");"}(C,ne(_)),R=te(C,function(e){return"m.ctn("+e+");"}('""')),T="";return _.dynamic?T+=I:R+=I,[R+ae(C,n.element,o),T,re(C,n.element)];default:var U=t.attributes,D=t.children;if(function(e){return e[0]===e[0].toUpperCase()&&e[0]!==e[0].toLowerCase()}(t.type)){t.component=r.nextElement++;for(var q=te(t.component,"new m.c."+t.type+"();"),F="",L=!1,M=0;M<U.length;M++){var S=U[M];if("@"===S.key[0])q+=ee(t.component)+'.on("'+S.key.substring(1)+'",function($event){locals.$event=$event;'+ne(S)+";});";else{var j=ee(t.component)+"."+S.key+"="+ne(S)+";";S.dynamic?(L=!0,F+=j):q+=j}}return q+=ee(t.component)+".create("+ee(n.element)+");",L?F+=ee(t.component)+".update();":q+=ee(t.component)+".update();",[q,F,ee(t.component)+".destroy();"]}t.element=r.nextElement++;for(var z=te(t.element,function(e){return'm.ce("'+e+'");'}(t.type)),A="",B=0;B<U.length;B++){var G=U[B],H=void 0;if("@"===G.key[0]){var J=void 0,K=void 0;if("@bind"===G.key){var N=ne(G);H=ee(t.element)+".value="+N+";",J="input",K=N+"=$event.target.value;instance.update();"}else H="",J=G.key.substring(1),K="locals.$event=$event;"+ne(G)+";";z+=(X=t.element,Y=J,Z="function($event){"+K+"}","m.ael("+ee(X)+',"'+Y+'",'+Z+");")}else V=t.element,W=G,H="m.sa("+ee(V)+',"'+W.key+'",'+ne(W)+");";G.dynamic?A+=H:z+=H}for(var P=0;P<D.length;P++){var Q=e(D[P],t,r,null);z+=Q[0],A+=Q[1]}return[z+ae(t.element,n.element,o),A,re(t.element,n.element)]}var V,W,X,Y,Z},ie=function(e,t){for(var n=e.children,r="",o="",a="",i=0;i<n.length;i++){var u=s(n[i],e,e,t);r+=u[0],o+=u[1],a+=u[2]}for(var l="var "+ee(e.element),c=e.element+1;c<e.nextElement;c++)l+=","+ee(c);return l+";return [function(_0){"+te(e.element,"_0;")+r+"},function(){"+o+"},function(){"+a+"}];"};function u(e){return n(t(e))}function e(e){function t(){}(t.prototype=e).name=i(e.name,"Root");var n=e.view;void 0===n&&e.name,"string"==typeof n&&(n=u(n)),e.view=n,e.onCreate=i(e.onCreate,a),e.onUpdate=i(e.onUpdate,a),e.onDestroy=i(e.onDestroy,a);var r=e.root;if(delete e.root,"string"==typeof r&&(r=document.querySelector(r)),void 0===r)return t;var o=new t;return o.create(r),o}return e.lex=t,e.parse=n,e.generate=ie,e.compile=u,e});