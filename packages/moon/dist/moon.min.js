/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var b={element:0,text:1,component:2};function y(e,t){return void 0===e?t:e}var N,A=/^\s+$/,C=/<([\w\d-_]+)([^>]*?)(\/?)>/g,t=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,q=/&amp;|&gt;|&lt;|&nbsp;|&quot;|\\|"|\n|\r/g,r=["NaN","false","in","null","this","true","typeof","undefined","window"],P={class:"className",for:"htmlFor"},E={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r"};function F(e){var n=!0;return{value:e.replace(t,function(e,t){return void 0===t||-1!==r.indexOf(t)?e:(n=!1,"$"===t[0]?t:"data."+t)}),isStatic:n}}function n(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var a=e[n+1];if("/"===a){var i=e.indexOf(">",n+2),o=e.slice(n+2,i);0,t.push({type:"tagClose",value:o}),n=i+1;continue}if("!"===a&&"-"===e[n+2]&&"-"===e[n+3]){var l=e.indexOf("--\x3e",n+4);0,n=l+3;continue}C.lastIndex=n;var u=C.exec(e);0;for(var d=u[0],s=u[1],f=u[2],v=u[3],c={},p=0;p<f.length;p++){var h=f[p];if(!A.test(h)){for(var m="",g="true";p<f.length&&(h=f[p],!A.test(h));p++){if("="===h){g="";break}m+=h}var w=P[m];if(void 0!==w&&(m=w),0===g.length){var b=f[++p];"{"===b?b="}":g+=b,p+=1;for(var y=0;p<f.length;p++)if("{"===(h=f[p]))y+=1,g+=h;else if(h===b){if("}"!==b){g+=h,c[m]={value:g,isStatic:!0};break}if(0===y){64===m.charCodeAt(0)?c[m]={value:"["+F(g).value+",data]",isStatic:!1}:c[m]=F(g);break}g+=h,y-=1}else g+=h;p+=1}else c[m]={value:g,isStatic:!0}}}t.push({type:"tagOpen",value:s,attributes:c,closed:"/"===v}),n+=d.length}else if("{"===r){var N="",x=0;for(n+=1;n<e.length;n++){var k=e[n];if("{"===k)x+=1,N+=k;else if("}"===k){if(0===x)break;x-=1,N+=k}else N+=k}t.push({type:"tagOpen",value:"text",attributes:{"":F(N)},closed:!0}),n+=1}else{for(var O="";n<e.length;n++){var S=e[n];if("<"===S||"{"===S)break;O+=S}A.test(O)||t.push({type:"tagOpen",value:"text",attributes:{"":{value:'"'+O.replace(q,function(e){return E[e]})+'"',isStatic:!0}},closed:!0})}}return t}function s(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function f(e,t,n){var r=n[e],a=n[t-1],i=t-e;if(0==i)return new s("",e,t);if(1==i)return"tagOpen"===r.type&&!0===r.closed?{name:r.value,attributes:r.attributes,children:[]}:new s("",e,t);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new s("",e,t);var o=function e(t,n,r){var a;if(0==n-t)return[];for(var i=t+1;i<=n;i++){var o=f(t,i,r);if(o instanceof s)a=o;else{var l=e(i,n,r);if(!(l instanceof s)){for(var u=[o],d=0;d<l.length;d++)u.push(l[d]);return u}}}return new s("",t,n,a)}(e+1,t-1,n);return o instanceof s?new s("",e,t,o):{name:r.value,attributes:r.attributes,children:o}}function a(e){var t=f(0,e.length,e);return t}function x(e){N=e}function k(e,t,n){var r,a=O(t.children[0],t,0,n);return a.isStatic?(r=e+"=m["+n.length+"];",n.push(a)):r=""+a.prelude+e+"="+a.node+";",r}function O(e,t,n,r){var a,i=e.name,o=!0;if("if"===i)return function(e,t,n,r){var a="m"+N,i="",o=!0;if(x(N+1),i+="var "+a+";if("+e.attributes[""].value+"){"+k(a,e,r)+"}",null!==t)for(var l=t.children,u=n+1;u<l.length;){var d=l[u];if("else-if"===d.name)i+="else if("+d.attributes[""].value+"){"+k(a,d,r)+"}",l.splice(u,1);else{if("else"!==d.name)break;i+="else{"+k(a,d,r)+"}",o=!1,l.splice(u,1)}}return o&&(i+="else{"+a+"=m["+r.length+"];}",r.push({prelude:"",node:"{type:"+b.text+',name:"text",data:{"":"",children:[]}}',isStatic:!0})),{prelude:i,node:a,isStatic:!1}}(e,t,n,r);if("for"===i)return function(e,t){var n,r,a="m"+N,i=e.attributes,o=i[""].value.split(","),l=y(i.name,{value:'"span"'}).value,u=y(i.data,{value:"{}"}).value,d=i.of,s=i.in;x(N+1);var f,v=O(e.children[0],e,0,t);return v.isStatic?(f=a+".children.push(m["+t.length+"]);",t.push(v)):f=v.prelude+a+".children.push("+v.node+");",r=void 0===d?(s=s.value,"for(var "+(n=o[0])+" in "+s+"){"+(2===o.length?"var "+o[1]+"="+s+"["+n+"];":"")+f+"}"):(d=d.value,"for(var "+(n=2===o.length?o[1]:"mi")+"=0;"+n+"<"+d+".length;"+n+"++){var "+o[0]+"="+d+"["+n+"];"+f+"}"),{prelude:"var "+a+"="+u+";"+a+".children=[];"+r,node:"{type:"+b.element+",name:"+l+",data:"+a+"}",isStatic:!1}}(e,r);a="text"===i?b.text:i[0]===i[0].toLowerCase()?b.element:b.component;var l=e.attributes,u="",d="{",s="";for(var f in l){var v=l[f];"@"!==f[0]&&v.isStatic||(o=!1),d+=s+'"'+f+'":'+v.value,s=","}if(void 0===l.children){var c=e.children,p=[];d+=s+"children:[",s="";for(var h=0;h<c.length;h++){var m=O(c[h],e,h,r);m.isStatic||(o=!1),p.push(m)}for(var g=0;g<p.length;g++){var w=p[g];o||!w.isStatic?(u+=w.prelude,d+=s+w.node):(d+=s+"m["+r.length+"]",r.push(w)),s=","}d+="]"}return{prelude:u,node:"{type:"+a+',name:"'+i+'",data:'+d+"}}",isStatic:o}}function i(e){var t=[];x(0);var n=O(e,null,0,t),r=n.prelude,a=n.node;if(n.isStatic)return"if(m[0]===undefined){"+r+"m[0]="+a+";}return m[0];";if(0===t.length)return r+"return "+a+";";for(var i="if(m[0]===undefined){",o=0;o<t.length;o++){var l=t[o];i+=l.prelude+"m["+o+"]="+l.node+";"}return""+(i+="}")+r+"return "+a+";"}function d(e){return i(a(n(e)))}function S(e,t,n){if("ariaset"===e)for(var r in t)n.setAttribute("aria-"+r,t[r]);else{var a=n[e];for(var i in t)a[i]=t[i]}}function L(e,t,n,r){for(var a in t)if(!(a in n))switch(e){case"ariaset":r.removeAttribute("aria-"+a);break;case"dataset":delete r.dataset[e];break;default:r.style[e]=""}}var v,c,p,M,o={},h={},m={};function g(e){c=e}var $=[],_={updateText:0,updateData:1,appendNode:2,removeNode:3,replaceNode:4};function z(u){var d,s=[];return u.type===b.text?d=document.createTextNode(u.data[""]):function(){var r=u.data;d=document.createElement(u.name);for(var e=r.children,t=0;t<e.length;t++){var n=z(e[t]);d.appendChild(n.element),s.push(n)}function a(n){var e=r[n];if(64===n.charCodeAt(0)){i[n]=e;var t=o[n]=function(e){var t=i[n];t[0](e,t[1])};d.addEventListener(n.slice(1),t)}else"ariaset"===n||"dataset"===n||"style"===n?S(n,e,d):"children"!==n&&(d[n]=e)}var i=d.MoonEvents={},o=d.MoonListeners={};for(var l in r)a(l)}(),{element:d,node:u,children:s}}function w(e,t,n){for(;;){var r=e.pop(),a=r.node,i=t.pop();if(a!==i)if(a.name!==i.name)n.push({type:_.replaceNode,nodeOld:r,nodeNew:i,nodeParent:null});else if(a.type===b.text)a.data[""]!==i.data[""]&&n.push({type:_.updateText,nodeOld:r,nodeNew:i,nodeParent:null});else{n.push({type:_.updateData,nodeOld:r,nodeNew:i,nodeParent:null});var o=r.children,l=i.data.children,u=o.length,d=l.length;if(u===d)for(var s=0;s<u;s++)e.push(o[s]),t.push(l[s]);else if(d<u){for(var f=0;f<d;f++)e.push(o[f]),t.push(l[f]);for(var v=d;v<u;v++)n.push({type:_.removeNode,nodeOld:o[v],nodeNew:null,nodeParent:r})}else{for(var c=0;c<u;c++)e.push(o[c]),t.push(l[c]);for(var p=u;p<d;p++)n.push({type:_.appendNode,nodeOld:null,nodeNew:l[p],nodeParent:r})}}if(0===e.length){T(n);break}if(16<=performance.now()-M){requestAnimationFrame(function(){M=performance.now(),w(e,t,n)});break}}}function T(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.type){case _.updateText:var r=n.nodeOld,a=n.nodeNew;r.element.data=a.data[""],r.node=a;break;case _.updateData:var i=n.nodeOld,o=i.node.data,l=i.element,u=n.nodeNew,d=u.data;for(var s in d){var f=o[s],v=d[s];f!==v&&(64===s.charCodeAt(0)?l.MoonEvents[s]=v:"ariaset"===s||"dataset"===s||"style"===s?(S(s,v,l),void 0!==f&&L(s,f,v,l)):"children"!==s&&(l[s]=v))}for(var c in o)c in d||(64===c.charCodeAt(0)?(delete l.MoonEvents[c],l.removeEventListener(l.MoonListeners[c])):"ariaset"===c||"dataset"===c||"style"===c?L(c,o[c],{},l):l.removeAttribute(c));i.node=u;break;case _.appendNode:var p=n.nodeParent,h=z(n.nodeNew);p.element.appendChild(h.element),p.children.push(h);break;case _.removeNode:var m=n.nodeParent;m.element.removeChild(m.children.pop().element);break;case _.replaceNode:var g=n.nodeOld,w=g.element,b=z(n.nodeNew),y=b.element;w.parentNode.replaceChild(y,w),g.element=y,g.node=b.node,g.children=b.children}}$.shift(),0!==$.length&&(16<=performance.now()-M?requestAnimationFrame(function(){M=performance.now(),Z()}):Z())}function Z(){var e=$[0];for(var t in e)o[t]=e[t];var n=p(o);g(n),function e(t,n,r){for(;;){var a=t.pop(),i=n.pop(),o=r.pop();a.type===b.component&&(a=h[a.name](a.data),null===i?g(a):i.data.children[o]=a);for(var l=a.data.children,u=0;u<l.length;u++)t.push(l[u]),n.push(a),r.push(u);if(0===t.length){w([v],[c],[]);break}if(16<=performance.now()-M){requestAnimationFrame(function(){M=performance.now(),e(t,n,r)});break}}}([n],[null],[0])}function D(e){$.push(e),1===$.length&&requestAnimationFrame(function(){M=performance.now(),Z()})}function e(t){var n=y(t.name,"Root");delete t.name;var r=t.view;delete t.view,"string"==typeof r&&(r=new Function("m","data",d(r))),m[n]=[];function e(e){return r(m[n],function(e,t){var n={};for(var r in e)n[r]=e[r];for(var a in t)a in e||(n[a]=t[a]);return n}(e,t))}if("Root"===n){var a="string"==typeof t.root?document.querySelector(t.root):t.root;delete t.root;for(var i=a.attributes,o={children:[]},l=0;l<i.length;l++){var u=i[l];o[u.name]=u.value}!function(e){v=e}({element:a,node:{type:b.element,name:a.tagName.toLowerCase(),data:o},children:[]}),function(e){p=e}(e),D(t)}else h[n]=e}return e.lex=n,e.parse=a,e.generate=i,e.compile=d,e.components=h,e.get=o,e.set=D,e});