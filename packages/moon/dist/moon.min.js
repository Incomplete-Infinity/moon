/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,n){"undefined"==typeof module?e.Moon=n():module.exports=n()}(this,function(){"use strict";var b={element:0,text:1,component:2};var y,O=/^\s+$/,k=/<([\w\d-_]+)([^>]*?)(\/?)>/g,A=/\s*([\w\d-_:@]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g,n=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,t=["NaN","false","in","null","this","true","typeof","undefined","window"];function S(e){return e.replace(n,function(e,n){return void 0===n||"$"===n[0]||-1!==t.indexOf(n)?e:"data."+n})}function r(e){e=e.trim();for(var n=[],t=0;t<e.length;){var r=e[t];if("<"===r){var a=e[t+1];if("/"===a){var o=e.indexOf(">",t+2),i=e.slice(t+2,o);0,n.push({type:"tagClose",value:i}),t=o+1;continue}if("!"===a&&"-"===e[t+2]&&"-"===e[t+3]){var u=e.indexOf("--\x3e",t+4);0,t=u+3;continue}k.lastIndex=t;var l=k.exec(e);0;for(var d=l[0],f=l[1],p=l[2],s=l[3],c={},v=void 0;null!==(v=A.exec(p));){var h=v[0],m=v[1],g=v[2],w=v[3];0===h.length?A.lastIndex+=1:(c[m]=void 0===w?void 0===g?'""':g:S(w),"@"===m[0]&&(c[m]="function($event){"+c[m]+"}"))}n.push({type:"tagOpen",value:f,attributes:c,closed:"/"===s}),t+=d.length}else if("{"===r){var b="";for(t+=1;t<e.length;t++){var y=e[t];if("}"===y)break;b+=y}n.push({type:"tagOpen",value:"text",attributes:{"":S(b)},closed:!0}),t+=1}else{for(var x="";t<e.length;t++){var N=e[t];if("<"===N||"{"===N)break;x+=N}O.test(x)||n.push({type:"tagOpen",value:"text",attributes:{"":'"'+x+'"'},closed:!0})}}return n}function f(e,n,t,r){this.message=e,this.start=n,this.end=t,this.next=r}function p(e,n,t){var r=t[e],a=t[n-1],o=n-e;if(0==o)return new f("",e,n);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new f("",e,n);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new f("",e,n);var i=function e(n,t,r){var a;if(0==t-n)return[];for(var o=n+1;o<=t;o++){var i=p(n,o,r);if(i instanceof f)a=i;else{var u=e(o,t,r);if(!(u instanceof f)){for(var l=[i],d=0;d<u.length;d++)l.push(u[d]);return l}}}return new f("",n,t,a)}(e+1,n-1,t);return i instanceof f?new f("",e,n,i):{type:r.value,attributes:r.attributes,children:i}}function a(e){var n=p(0,e.length,e);return n}function x(e){y=e}function N(e,n,t){var r,a=C(n.children[0],n,0,t);return a.isStatic?(r=e+"=m["+t.length+"];",t.push(a)):r=""+a.prelude+e+"="+a.node+";",r}function C(e,n,t,r){var a,o=e.type,i=!0;if("if"===o)return function(e,n,t,r){var a="m"+y,o="",i=!0;if(x(y+1),o+="var "+a+";if("+e.attributes[""]+"){"+N(a,e,r)+"}",null!==n)for(var u=n.children,l=t+1;l<u.length;){var d=u[l];if("else-if"===d.type)o+="else if("+d.attributes[""]+"){"+N(a,d,r)+"}",u.splice(l,1);else{if("else"!==d.type)break;o+="else{"+N(a,d,r)+"}",i=!1,u.splice(l,1)}}return i&&(o+="else{"+a+"=m["+r.length+"];}",r.push({prelude:"",node:"{type:"+b.text+',name:"text",data:{"":"",children:[]}}',isStatic:!0})),{prelude:o,node:a,isStatic:!1}}(e,n,t,r);if("for"===o)return function(e,n){var t,r,a="m"+y,o=e.attributes[""].split(","),i=e.attributes.of,u=e.attributes.in;x(y+1);var l,d=C(e.children[0],e,0,n);return d.isStatic?(l=a+".push(m["+n.length+"]);",n.push(d)):l=d.prelude+a+".push("+d.node+");",r=void 0===i?"for(var "+(t=o[0])+" in "+u+"){"+(2===o.length?"var "+o[1]+"="+u+"["+t+"];":"")+l+"}":"for(var "+(t=2===o.length?o[1]:"mi")+"=0;"+t+"<"+i+".length;"+t+"++){var "+o[0]+"="+i+"["+t+"];"+l+"}",{prelude:"var "+a+"=[];"+r,node:"{type:"+b.element+',name:"span",data:{children:'+a+"}}",isStatic:!1}}(e,r);a="text"===o?b.text:o[0]===o[0].toLowerCase()?b.element:b.component;var u=e.attributes,l="",d="{",f="";for(var p in u){var s=u[p];("@"===p[0]||'"'!==s[0]&&"'"!==s[0])&&(i=!1),d+=f+'"'+p+'":'+s,f=","}if(void 0===u.children){var c=e.children,v=[];d+=f+"children:[",f="";for(var h=0;h<c.length;h++){var m=C(c[h],e,h,r);m.isStatic||(i=!1),v.push(m)}for(var g=0;g<v.length;g++){var w=v[g];i||!w.isStatic?(l+=w.prelude,d+=f+w.node):(d+=f+"m["+r.length+"]",r.push(w)),f=","}d+="]"}return{prelude:l,node:"{type:"+a+',name:"'+o+'",data:'+d+"}}",isStatic:i}}function o(e){var n=[];x(0);var t=C(e,null,0,n),r=t.prelude,a=t.node;if(t.isStatic)return"if(m[0]===undefined){"+r+"m[0]="+a+";}return m[0];";if(0===n.length)return r+"return "+a+";";for(var o="if(m[0]===undefined){",i=0;i<n.length;i++){var u=n[i];o+=u.prelude+"m["+i+"]="+u.node+";"}return""+(o+="}")+r+"return "+a+";"}function i(e){return o(a(r(e)))}var d,s,u,w,l={},c={},v=[];function h(e){s=e}var P=[],$={updateText:0,updateData:1,appendNode:2,removeNode:3,replaceNode:4};function _(e){var r,n=[];if(e.type===b.text)r=document.createTextNode(e.data[""]);else{var a=e.data;r=document.createElement(e.name);var t=function(n){var e=a[n];if("@"===n[0]){var t=r.MoonEvents;void 0===t?t=r.MoonEvents=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}({},n,e):t[n]=e,r.addEventListener(n.slice(1),function(e){t[n](e)})}else"children"!==n&&!1!==e&&r.setAttribute(n,e)};for(var o in a)t(o);for(var i=a.children,u=0;u<i.length;u++){var l=_(i[u]);r.appendChild(l.element),n.push(l)}}return{element:r,node:e,children:n}}function m(e,n,t){for(;;){var r=e.pop(),a=n.pop();if(r.node!==a)if(r.node.name!==a.name)t.push({type:$.replaceNode,nodeOld:r,nodeNew:a,nodeParent:null});else if(r.node.type===b.text)t.push({type:$.updateText,nodeOld:r,nodeNew:a,nodeParent:null});else{t.push({type:$.updateData,nodeOld:r,nodeNew:a,nodeParent:null});var o=r.children,i=a.data.children,u=o.length,l=i.length;if(u===l)for(var d=0;d<u;d++)e.push(o[d]),n.push(i[d]);else if(l<u){for(var f=0;f<l;f++)e.push(o[f]),n.push(i[f]);for(var p=l;p<u;p++)t.push({type:$.removeNode,nodeOld:o[p],nodeNew:null,nodeParent:r})}else{for(var s=0;s<u;s++)e.push(o[s]),n.push(i[s]);for(var c=u;c<l;c++)t.push({type:$.appendNode,nodeOld:null,nodeNew:i[c],nodeParent:r})}}if(0===e.length){g(t);break}if(16<=performance.now()-w){requestAnimationFrame(function(){w=performance.now(),m(e,n,t)});break}}}function g(e){for(var n=0;n<e.length;n++){var t=e[n];switch(t.type){case $.updateText:var r=t.nodeOld,a=t.nodeNew;r.element.textContent=a.data[""],r.node=a;break;case $.updateData:var o=t.nodeOld,i=o.element,u=t.nodeNew,l=u.data;for(var d in l){var f=l[d];"@"===d[0]?i.MoonEvents[d]=f:"children"!==d&&(!1===f?i.removeAttribute(d):i.setAttribute(d,f))}o.node=u;break;case $.appendNode:var p=t.nodeParent,s=_(t.nodeNew);p.element.appendChild(s.element),p.children.push(s);break;case $.removeNode:var c=t.nodeParent;c.element.removeChild(c.children.pop().element);break;case $.replaceNode:var v=t.nodeOld,h=v.element,m=_(t.nodeNew),g=m.element;h.parentNode.replaceChild(g,h),v.element=g,v.node=m.node,v.children=m.children}}P.shift(),0!==P.length&&(16<=performance.now()-w?requestAnimationFrame(function(){w=performance.now(),q()}):q())}function q(){var e=P[0];for(var n in e)l[n]=e[n];var t=u(l);h(t),function e(n,t,r){for(;;){var a=n.pop(),o=t.pop(),i=r.pop();a.type===b.component&&(a=c[a.name](a.data),null===o?h(a):o.data.children[i]=a);for(var u=a.data.children,l=0;l<u.length;l++)n.push(u[l]),t.push(a),r.push(l);if(0===n.length){m([d],[s],[]);break}if(16<=performance.now()-w){requestAnimationFrame(function(){w=performance.now(),e(n,t,r)});break}}}([t],[null],[0])}function E(e){P.push(e),1===P.length&&requestAnimationFrame(function(){w=performance.now(),q()})}function e(n){var t=function(e,n){return void 0===e?n:e}(n.name,"Root");delete n.name;var r=n.view;delete n.view,"string"==typeof r&&(r=new Function("m","data",i(r)));var e="string"==typeof n.root?document.querySelector(n.root):n.root;delete n.root,v[t]=[];var a=function(e){return r(v[t],function(e,n){var t={};for(var r in e)t[r]=e[r];for(var a in n)a in e||(t[a]=n[a]);return t}(e,n))};void 0===e?c[t]=a:(function(e){d=e}({element:e,node:{type:b.element,name:e.tagName.toLowerCase(),data:{children:[]}},children:[]}),function(e){u=e}(a),E(n))}return e.lex=r,e.parse=a,e.generate=o,e.compile=i,e.components=c,e.set=E,e});