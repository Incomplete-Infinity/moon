/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p={element:0,text:1,component:2};var a,f,c,i,E=/<([\w\d-_]+)([^>]*?)(\/?)>/g,N=/\s*([\w\d-_:@]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g;function t(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var a=e[n+1];if("/"===a){var o=e.indexOf(">",n+2),i=e.slice(n+2,o);0,t.push({type:"tagClose",value:i}),n=o+1;continue}if("!"===a&&"-"===e[n+2]&&"-"===e[n+3]){var u=e.indexOf("--\x3e",n+4);0,n=u+3;continue}E.lastIndex=n;var l=E.exec(e);0;for(var d=l[0],p=l[1],f=l[2],c=l[3],s={},v=void 0;null!==(v=N.exec(f));){var m=v[0],h=v[1],y=v[2],b=v[3];0===m.length?N.lastIndex+=1:s[h]=void 0===b?y:b}t.push({type:"tagOpen",value:p,attributes:s,closed:"/"===c}),n+=d.length}else if("{"===r){var g="";for(n+=1;n<e.length;n++){var w=e[n];if("}"===w)break;g+=w}t.push({type:"tagOpen",value:"text",attributes:{"":g},closed:!0}),n+=1}else{for(var x="";n<e.length;n++){var O=e[n];if("<"===O||"{"===O)break;x+=O}t.push({type:"tagOpen",value:"text",attributes:{"":'"'+x+'"'},closed:!0})}}return t}function s(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function v(e,t,n){var r=n[e],a=n[t-1],o=t-e;if(0==o)return new s("",e,t);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new s("",e,t);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new s("",e,t);var i=function e(t,n,r){var a;if(0==n-t)return[];for(var o=t+1;o<=n;o++){var i=v(t,o,r);if(i instanceof s)a=i;else{var u=e(o,n,r);if(!(u instanceof s)){for(var l=[i],d=0;d<u.length;d++)l.push(u[d]);return l}}}return new s("",t,n,a)}(e+1,t-1,n);return i instanceof s?new s("",e,t,i):{type:r.value,attributes:r.attributes,children:i}}function n(e){var t=v(0,e.length,e);return t}function u(e){var t,n=e.type;t="text"===n?p.text:n[0]===n[0].toLowerCase()?p.element:p.component;var r="{";for(var a in e.attributes)r+='"'+a+'":'+e.attributes[a]+",";r+="children:[";for(var o="",i=0;i<e.children.length;i++)r+=o+u(e.children[i]),o=",";return"{type:"+t+',name:"'+n+'",data:'+r+"]}}"}function l(e){return u(n(t(e)))}var h,m={};function y(e){c=e}var b={setAttributes:0,appendElement:1,removeElement:2,replaceElement:3};function g(e){if(e.type!==p.element)return document.createTextNode(e.data[""]);var t=document.createElement(e.name),n=e.data,r=n.children;for(var a in n)t.setAttribute(a,n[a]);for(var o=0;o<r.length;o++)t.appendChild(g(r[o]));return t}function w(e,t,n){for(var r=[e],a=[t];;){var o=r.pop(),i=a.pop();if(o!==i){if(o.name!==i.name)n.push({type:b.replaceElement,nodeOld:o,nodeNew:i,nodeParent:null});else{n.push({type:b.setAttributes,nodeOld:o,nodeNew:i,nodeParent:null});var u=o.data.children,l=i.data.children,d=u.length,p=l.length;if(d===p)for(var f=0;f<d;f++)r.push(u[f]),a.push(l[f]);else if(p<d){for(var c=0;c<p;c++)r.push(u[c]),a.push(l[c]);for(var s=p;s<d;s++)n.push({type:b.removeElement,nodeOld:u[s],nodeNew:null,nodeParent:o})}else{for(var v=0;v<d;v++)r.push(u[v]),a.push(l[v]);for(var m=d;m<p;m++)n.push({type:b.appendElement,nodeOld:null,nodeNew:l[m],nodeParent:o})}}if(0===r.length){x(n);break}if(8<=performance.now()-h){requestAnimationFrame(function(){h=performance.now(),w(r,a,n)});break}}}}function x(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.type){case b.setAttributes:var r=n.nodeOld,a=r.node,o=n.nodeNew.data;for(var i in r.data=o)a.setAttribute(i,o[i]);break;case b.appendElement:var u=n.nodeNew,l=n.nodeParent,d=g(u);l.data.children.push({type:u.type,name:u.name,data:u.data,node:d}),l.node.appendChild(d);break;case b.removeElement:var p=n.nodeParent;p.data.children.pop(),p.node.removeChild(n.nodeOld);break;case b.replaceElement:var f=n.nodeOld,c=n.nodeNew,s=f.node;f.type=c.type,f.name=c.name,f.data=c.data,f.node=g(c),s.parentNode.replaceChild(f.node,s)}}}function d(){h=performance.now(),function e(t,n,r){for(;;){var a=t.pop(),o=n.pop(),i=r.pop();if(a.type===p.component){var u=m[a.name](a.data);null===o?y(u):a=o.data.children[i]=u}else null===o&&y(a);for(var l=a.data.children,d=0;d<l.length;d++)t.push(l[d]),n.push(a),r.push(d);if(0===t.length){w(f,c,[]);break}if(8<=performance.now()-h){requestAnimationFrame(function(){h=performance.now(),e(t,n,r)});break}}}([i(a)],[null],[0])}function e(t){var e=function(e,t){return void 0===e?t:e}(t.name,"Root");delete t.name;var n=t.view;delete t.view,"string"==typeof n&&(n=new Function("data","return "+l(n)));var r="string"==typeof t.root?document.querySelector(t.root):t.root;delete t.root,void 0===r?m[e]=function(e){return n(function(e,t){var n={};for(var r in t)n[r]=t[r];for(var a in e)n[a]=e[a];return n}(e,t))}:(function(e){f=e}({type:p.element,name:r.tagName.toLowerCase(),data:{children:[]},node:r}),function(e){i=e}(n),function(e){a=e}(t),d())}return e.lex=t,e.parse=n,e.generate=u,e.compile=l,e.components=m,e.set=function(e){!function e(t,n){for(var r in n){var a=n[r];"object"===o(a)?e(t[r],a):t[r]=a}}(a,e),d()},e});