/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var t={silent:!0};function a(){}function o(e,t){return void 0===e?t:e}function i(e){return'"'===e||"'"===e}function u(e){!1===t.silent&&console.error("[Moon] ERROR: "+e)}var w=/<([\w\d-_]+)([^>]*?)(\/?)>/g,O=/\s*([\w\d-_]*)(?:=(?:("[\w\d-_]*"|'[\w\d-_]*')|{([\w\d-_]*)}))?/g;function l(e){if("tagOpen"!==e.type)return"</".concat(e.value,">");if("Text"===e.value){var t=e.attributes[""];return i(t[0])?t:"{".concat(t,"}")}var n="<".concat(e.value);for(var r in e.attributes){var c=e.attributes[r];n+=" ".concat(r,"=").concat(i(c)?c:"{".concat(c,"}"))}return e.closed&&(n+="/"),n+">"}function n(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var c=e[n+1];if("/"===c){var a=e.indexOf(">",n+2),o=e.slice(n+2,a);t.push({type:"tagClose",value:o}),n=a+1;continue}if("!"===c&&"-"===e[n+2]&&"-"===e[n+3]){n=e.indexOf("--\x3e",n+4)+3;continue}w.lastIndex=n;for(var i=w.exec(e),u=i[0],l=i[1],s=i[2],f=i[3],v={},m=void 0;null!==(m=O.exec(s));){var d=m[0],p=m[1],y=m[2],g=m[3];0===d.length?O.lastIndex+=1:v[p]=void 0===g?y:g}t.push({type:"tagOpen",value:l,attributes:v,closed:"/"===f}),n+=u.length}else if("{"===r){var h="";for(n+=1;n<e.length;n++){var x=e[n];if("}"===x)break;h+=x}t.push({type:"tagOpen",value:"Text",attributes:{"":h},closed:!0}),n+=1}else{for(var b="";n<e.length;n++){var E=e[n];if("<"===E||"{"===E)break;b+=E}t.push({type:"tagOpen",value:"Text",attributes:{"":'"'.concat(b,'"')},closed:!0})}}return t}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function v(e,t,n){var r=n[e],c=n[t-1],a=t-e;if(0==a)return new f("Parser expected an element but received nothing.",e,t);if(1==a)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new f('Parser expected a self-closing tag or text but received "".',e,t);if("tagOpen"!==r.type||"tagClose"!==c.type||r.value!==c.value)return new f("Parser expected an element with matching opening and closing tags.",e,t);var o=function e(t,n,r){var c;if(0==n-t)return[];for(var a=t+1;a<=n;a++){var o=v(t,a,r);if(o instanceof f)c=o;else{var i=e(a,n,r);if(!(i instanceof f))return[o].concat(s(i))}}return new f("Parser expected valid elements but encountered an error.",t,n,c)}(e+1,t-1,n);return o instanceof f?new f("Parser expected valid child elements but encountered an error.",e,t,o):{type:r.value,attributes:r.attributes,children:o}}function r(e){var t=v(0,e.length,e);if(t instanceof f){var n="",r=t;do{n+="".concat(r.message,"\n");for(var c="",a="",o=Math.max(0,r.start-1);o<Math.min(r.end+1,e.length);o++){var i=l(e[o]);c+=i,a+=(o>=r.start&&o<r.end?"^":" ").repeat(i.length)}n+="".concat(c,"\n").concat(a,"\n\n")}while(void 0!==(r=r.next));u("Parser failed to process the view.\n\n".concat(n))}return t}var ee=function(e){return"m".concat(e)},te=function(e,t){return"".concat(ee(e),"=").concat(t)},ne=function(e){return e.expression?e.value:'"'.concat(e.value,'"')},re=function(e,t){return"m.rc(".concat(ee(e),",").concat(ee(t),");")},ce=function(e,t,n,r,c,a){return"m.df(".concat(e,",").concat(ee(t),",").concat(n,",").concat(ee(r),",").concat(ee(c),",").concat(ee(a),");")},ae=function(e,t,n){return null===n?function(e,t){return"m.ac(".concat(ee(e),",").concat(ee(t),");")}(e,t):function(e,t,n){return"m.ib(".concat(ee(e),",").concat(ee(t),",").concat(ee(n),");")}(e,n,t)},m=function e(t,n,r,c){switch(t.type){case"If":for(var a=r.nextElement++,o=r.nextElement++,i=r.nextElement++,u=r.nextElement++,l="[",s="[",f="",v=n.children,m=v.indexOf(t);m<v.length;m++){var d=v[m];if("If"!==d.type&&"ElseIf"!==d.type&&"Else"!==d.type)break;l+=f+("Else"===d.type?"true":ne(d.attributes[0])),s+=f+"function(locals){"+oe({element:r.nextElement,nextElement:r.nextElement+1,type:"Root",attributes:[],children:d.children},o)+"}({})",f=","}return[te(o,"m.cc();")+ae(o,n.element,c)+te(u,s+"];"),te(i,l+"];")+te(a,function(e,t,n,r){return"m.di(".concat(ee(e),",").concat(ee(t),",").concat(ee(n),",").concat(ee(r),");")}(a,i,u,n.element)),ee(a)+"[2]();"];case"ElseIf":case"Else":return["","",""];case"For":for(var p=ne(t.attributes[0]),y="[",g="",h=r.nextElement++,x=r.nextElement++,b=r.nextElement++,E=r.nextElement++,w="",O="",k=0;k<p.length;k++){var I=p[k];","===I||" "===I&&"i"===p[k+1]&&"n"===p[k+2]&&" "===p[k+3]&&(k+=3)?(y+=O+'"'+w.substring(7)+'"',w="",O=","):w+=I}return y+="]",g+=w,[te(h,"m.cc();")+ae(h,n.element,c)+te(x,"function(locals){"+oe({element:r.nextElement,nextElement:r.nextElement+1,type:"Root",attributes:[],children:t.children},h)+"};")+te(b,"[];")+te(E,"[];"),ce(y,E,g,x,b,n.element),ce(y,E,"[]",x,b,n.element)];case"Text":var $=t.attributes[0],_=r.nextElement++,C=function(e,t){return"m.stc(".concat(ee(e),",").concat(t,");")}(_,ne($)),P=te(_,function(e){return"m.ctn(".concat(e,");")}('""')),R="";return $.dynamic?R+=C:P+=C,[P+ae(_,n.element,c),R,re(_,n.element)];default:var T=t.attributes,A=t.children;if(function(e){return e[0]===e[0].toUpperCase()&&e[0]!==e[0].toLowerCase()}(t.type)){t.component=r.nextElement++;for(var M=te(t.component,"new m.c.".concat(t.type,"();")),j="",S=!1,U=0;U<T.length;U++){var q=T[U];if("@"===q.key[0])M+="".concat(ee(t.component),'.on("').concat(q.key.substring(1),'",function($event){locals.$event=$event;').concat(ne(q),";});");else{var D="".concat(ee(t.component),".").concat(q.key,"=").concat(ne(q),";");q.dynamic?(S=!0,j+=D):M+=D}}return M+="".concat(ee(t.component),".create(").concat(ee(n.element),");"),S?j+="".concat(ee(t.component),".update();"):M+="".concat(ee(t.component),".update();"),[M,j,"".concat(ee(t.component),".destroy();")]}t.element=r.nextElement++;for(var F=te(t.element,function(e){return'm.ce("'.concat(e,'");')}(t.type)),L="",z=0;z<T.length;z++){var B=T[z],G=void 0;if("@"===B.key[0]){var H=void 0,J=void 0;if("@bind"===B.key){var K=ne(B);G="".concat(ee(t.element),".value=").concat(K,";"),H="input",J="".concat(K,"=$event.target.value;instance.update();")}else G="",H=B.key.substring(1),J="locals.$event=$event;".concat(ne(B),";");F+=(X=t.element,Y=H,Z="function($event){".concat(J,"}"),"m.ael(".concat(ee(X),',"').concat(Y,'",').concat(Z,");"))}else V=t.element,W=B,G="m.sa(".concat(ee(V),',"').concat(W.key,'",').concat(ne(W),");");B.dynamic?L+=G:F+=G}for(var N=0;N<A.length;N++){var Q=e(A[N],t,r,null);F+=Q[0],L+=Q[1]}return[F+ae(t.element,n.element,c),L,re(t.element,n.element)]}var V,W,X,Y,Z},oe=function(e,t){for(var n=e.children,r="",c="",a="",o=0;o<n.length;o++){var i=m(n[o],e,e,t);r+=i[0],c+=i[1],a+=i[2]}for(var u="var ".concat(ee(e.element)),l=e.element+1;l<e.nextElement;l++)u+=","+ee(l);return"".concat(u,";return [function(_0){").concat(te(e.element,"_0;")).concat(r,"},function(){").concat(c,"},function(){").concat(a,"}];")};function d(e){return r(n(e))}function e(e){function t(){}(t.prototype=e).name=o(e.name,"Root");var n=e.view;void 0===n&&u("The ".concat(e.name,' component requires a "view" property.')),"string"==typeof n&&(n=d(n)),e.view=n,e.onCreate=o(e.onCreate,a),e.onUpdate=o(e.onUpdate,a),e.onDestroy=o(e.onDestroy,a);var r=e.root;if(delete e.root,"string"==typeof r&&(r=document.querySelector(r)),void 0===r)return t;var c=new t;return c.create(r),c}return e.lex=n,e.parse=r,e.generate=oe,e.compile=d,e.config=t,e});