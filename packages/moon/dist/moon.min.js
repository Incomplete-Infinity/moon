/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var y={element:0,text:1,component:2};var b,A=/^\s+$/,N=/<([\w\d-_]+)([^>]*?)(\/?)>/g,k=/\s*([\w\d-_:@]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g,t=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,n=["NaN","false","in","null","this","true","typeof","undefined","window"];function E(e){return e.replace(t,function(e,t){return void 0===t||"$"===t[0]||-1!==n.indexOf(t)?e:"data."+t})}function r(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var a=e[n+1];if("/"===a){var o=e.indexOf(">",n+2),i=e.slice(n+2,o);0,t.push({type:"tagClose",value:i}),n=o+1;continue}if("!"===a&&"-"===e[n+2]&&"-"===e[n+3]){var u=e.indexOf("--\x3e",n+4);0,n=u+3;continue}N.lastIndex=n;var d=N.exec(e);0;for(var l=d[0],p=d[1],s=d[2],f=d[3],c={},v=void 0;null!==(v=k.exec(s));){var h=v[0],m=v[1],g=v[2],w=v[3];0===h.length?k.lastIndex+=1:(c[m]=void 0===w?void 0===g?'""':g:E(w),"@"===m[0]&&(c[m]="function($event){"+c[m]+"}"))}t.push({type:"tagOpen",value:p,attributes:c,closed:"/"===f}),n+=l.length}else if("{"===r){var y="";for(n+=1;n<e.length;n++){var b=e[n];if("}"===b)break;y+=b}t.push({type:"tagOpen",value:"text",attributes:{"":E(y)},closed:!0}),n+=1}else{for(var x="";n<e.length;n++){var O=e[n];if("<"===O||"{"===O)break;x+=O}A.test(x)||t.push({type:"tagOpen",value:"text",attributes:{"":'"'+x+'"'},closed:!0})}}return t}function p(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function s(e,t,n){var r=n[e],a=n[t-1],o=t-e;if(0==o)return new p("",e,t);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new p("",e,t);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new p("",e,t);var i=function e(t,n,r){var a;if(0==n-t)return[];for(var o=t+1;o<=n;o++){var i=s(t,o,r);if(i instanceof p)a=i;else{var u=e(o,n,r);if(!(u instanceof p)){for(var d=[i],l=0;l<u.length;l++)d.push(u[l]);return d}}}return new p("",t,n,a)}(e+1,t-1,n);return i instanceof p?new p("",e,t,i):{type:r.value,attributes:r.attributes,children:i}}function a(e){var t=s(0,e.length,e);return t}var x=0;function O(e){b=e}function S(e){x=e}function C(e,t,n){var r,a=$(t.children[0],t,0,n);return a.isStatic?(r=e+"=m["+x+"];",n.push(a),S(x+1)):r=""+a.prelude+e+"="+a.node+";",r}function $(e,t,n,r){var a,o=e.type,i=!0;if("if"===o)return function(e,t,n,r){var a="m"+b,o="",i=!0;if(O(b+1),o+="var "+a+";if("+e.attributes[""]+"){"+C(a,e,r)+"}",null!==t)for(var u=t.children,d=n+1;d<u.length;){var l=u[d];if("else-if"===l.type)o+="else if("+l.attributes[""]+"){"+C(a,l,r)+"}",u.splice(d,1);else{if("else"!==l.type)break;o+="else{"+C(a,l,r)+"}",i=!1,u.splice(d,1)}}return i&&(o+="else{"+a+"=m["+x+"];}",r.push({prelude:"",node:"{type:"+y.text+',name:"text",data:{"":"",children:[]}}',isStatic:!0}),S(x+1)),{prelude:o,node:a,isStatic:!1}}(e,t,n,r);if("for"===o)return function(e,t){var n,r,a="m"+b,o=e.attributes[""].split(","),i=e.attributes.of,u=e.attributes.in;O(b+1);var d,l=$(e.children[0],e,0,t);return l.isStatic?(d=a+".push(m["+x+"]);",t.push(l),S(x+1)):d=l.prelude+a+".push("+l.node+");",r=void 0===i?"for(var "+(n=o[0])+" in "+u+"){"+(2===o.length?"var "+o[1]+"="+u+"["+n+"];":"")+d+"}":"for(var "+(n=2===o.length?o[1]:"i")+"=0;"+n+"<"+i+".length;"+n+"++){var "+o[0]+"="+i+"["+n+"];"+d+"}",{prelude:"var "+a+"=[];"+r,node:"{type:"+y.element+',name:"span",data:{children:'+a+"}}",isStatic:!1}}(e,r);a="text"===o?y.text:o[0]===o[0].toLowerCase()?y.element:y.component;var u=e.attributes,d="",l="{",p="";for(var s in u){var f=u[s];"@"!==s[0]&&'"'!==f[0]&&"'"!==f[0]&&(i=!1),l+=p+'"'+s+'":'+f,p=","}if(void 0===u.children){var c=e.children,v=[];l+=p+"children:[",p="";for(var h=0;h<c.length;h++){var m=$(c[h],e,h,r);m.isStatic||(i=!1),v.push(m)}for(var g=0;g<v.length;g++){var w=v[g];i||!w.isStatic?(d+=w.prelude,l+=p+w.node):(l+=p+"m["+x+"]",r.push(w),S(x+1)),p=","}l+="]"}return{prelude:d,node:"{type:"+a+',name:"'+o+'",data:'+l+"}}",isStatic:i}}function o(e){var t=[];O(0);var n=x,r=$(e,null,0,t),a=r.prelude,o=r.node;if(r.isStatic)return S(x+1),"if(m["+n+"]===undefined){"+a+"m["+n+"]="+o+";}return m["+n+"];";if(0===t.length)return a+"return "+o+";";for(var i="if(m["+n+"]===undefined){",u=0;u<t.length;u++){var d=t[u];i+=d.prelude+"m["+(n+u)+"]="+d.node+";"}return""+(i+="}")+a+"return "+o+";"}function i(e){return o(a(r(e)))}var l,f,u,w,d={},c={},v=[];function h(e){f=e}var P=[],_={updateText:0,setAttributes:1,appendElement:2,removeElement:3,replaceElement:4};function q(e){var t,n=e.type,r=e.name,a={},o=[];if(n===y.text){var i=e.data[""];t=document.createTextNode(i),a[""]=i}else{var u=e.data;for(var d in t=document.createElement(e.name),u){var l=u[d];"@"===d[0]?(a[d]=l,t.addEventListener(d.slice(1),l)):"children"!==d&&!1!==l&&(a[d]=l,t.setAttribute(d,l))}for(var p=u.children,s=0;s<p.length;s++){var f=q(p[s]);o.push(f),t.appendChild(f.node)}}return a.children=o,{type:n,name:r,data:a,node:t}}function m(e,t,n){for(;;){var r=e.pop(),a=t.pop();if(r!==a){if(r.name!==a.name)n.push({type:_.replaceElement,nodeOld:r,nodeNew:a,nodeParent:null});else if(r.type===y.text)n.push({type:_.updateText,nodeOld:r,nodeNew:a,parent:null});else{n.push({type:_.setAttributes,nodeOld:r,nodeNew:a,nodeParent:null});var o=r.data.children,i=a.data.children,u=o.length,d=i.length;if(u===d)for(var l=0;l<u;l++)e.push(o[l]),t.push(i[l]);else if(d<u){for(var p=0;p<d;p++)e.push(o[p]),t.push(i[p]);for(var s=d;s<u;s++)n.push({type:_.removeElement,nodeOld:o[s],nodeNew:null,nodeParent:r})}else{for(var f=0;f<u;f++)e.push(o[f]),t.push(i[f]);for(var c=u;c<d;c++)n.push({type:_.appendElement,nodeOld:null,nodeNew:i[c],nodeParent:r})}}if(0===e.length){g(n);break}if(16<=performance.now()-w){requestAnimationFrame(function(){w=performance.now(),m(e,t,n)});break}}}}function g(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.type){case _.updateText:var r=n.nodeOld,a=n.nodeNew.data[""];r.data[""]=a,r.node.textContent=a;break;case _.setAttributes:var o=n.nodeOld,i=o.data,u=o.node,d=n.nodeNew.data;for(var l in d){var p=d[l];"@"!==l[0]&&"children"!==l&&(!1===(i[l]=p)?u.removeAttribute(l):u.setAttribute(l,p))}break;case _.appendElement:var s=n.nodeNew,f=n.nodeParent,c=q(s);f.data.children.push(c),f.node.appendChild(c.node);break;case _.removeElement:var v=n.nodeParent;v.data.children.pop(),v.node.removeChild(n.nodeOld.node);break;case _.replaceElement:var h=n.nodeOld,m=q(n.nodeNew),g=h.node;h.type=m.type,h.name=m.name,h.data=m.data,h.node=m.node,g.parentNode.replaceChild(h.node,g)}}P.shift(),0!==P.length&&(16<=performance.now()-w?requestAnimationFrame(function(){w=performance.now(),F()}):F())}function F(){var e=P[0];for(var t in e)d[t]=e[t];!function e(t,n,r){for(;;){var a=t.pop(),o=n.pop(),i=r.pop();a.type===y.component?(a=c[a.name](a.data),null===o?h(a):o.data.children[i]=a):null===o&&h(a);for(var u=a.data.children,d=0;d<u.length;d++)t.push(u[d]),n.push(a),r.push(d);if(0===t.length){m([l],[f],[]);break}if(16<=performance.now()-w){requestAnimationFrame(function(){w=performance.now(),e(t,n,r)});break}}}([u(d)],[null],[0])}function z(e){P.push(e),1===P.length&&requestAnimationFrame(function(){w=performance.now(),F()})}function e(t){var e=function(e,t){return void 0===e?t:e}(t.name,"Root");delete t.name;var n=t.view;delete t.view,"string"==typeof n&&(n=new Function("m","data",i(n)));var r="string"==typeof t.root?document.querySelector(t.root):t.root;delete t.root;var a=function(e){return n(v,function(e,t){var n={};for(var r in e)n[r]=e[r];for(var a in t)a in e||(n[a]=t[a]);return n}(e,t))};void 0===r?c[e]=a:(function(e){l=e}({type:y.element,name:r.tagName.toLowerCase(),data:{children:[]},node:r}),function(e){u=e}(a),z(t))}return e.lex=r,e.parse=a,e.generate=o,e.compile=i,e.components=c,e.set=z,e});