/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var E=/<([\w\d-_]+)([^>]*?)(\/?)>/g,O=/\s*([\w\d-_]*)(?:=(?:("[\w\d-_]*"|'[\w\d-_]*')|{([\w\d-_]*)}))?/g;function t(e){e=e.trim();for(var t=[],r=0;r<e.length;){var n=e[r];if("<"===n){var a=e[r+1];if("/"===a){var o=e.indexOf(">",r+2),i=e.slice(r+2,o);0,t.push({type:"tagClose",value:i}),r=o+1;continue}if("!"===a&&"-"===e[r+2]&&"-"===e[r+3]){var s=e.indexOf("--\x3e",r+4);0,r=s+3;continue}E.lastIndex=r;var u=E.exec(e);0;for(var d=u[0],v=u[1],p=u[2],f=u[3],c={},l=void 0;null!==(l=O.exec(p));){var h=l[0],y=l[1],m=l[2],g=l[3];0===h.length?O.lastIndex+=1:c[y]=void 0===g?m:g}t.push({type:"tagOpen",value:v,attributes:c,closed:"/"===f}),r+=d.length}else if("{"===n){var w="";for(r+=1;r<e.length;r++){var x=e[r];if("}"===x)break;w+=x}t.push({type:"tagOpen",value:"text",attributes:{"":w},closed:!0}),r+=1}else{for(var b="";r<e.length;r++){var C=e[r];if("<"===C||"{"===C)break;b+=C}t.push({type:"tagOpen",value:"text",attributes:{"":'"'+b+'"'},closed:!0})}}return t}function v(e,t,r,n){this.message=e,this.start=t,this.end=r,this.next=n}function p(e,t,r){var n=r[e],a=r[t-1],o=t-e;if(0==o)return new v("",e,t);if(1==o)return"tagOpen"===n.type&&!0===n.closed?{type:n.value,attributes:n.attributes,children:[]}:new v("",e,t);if("tagOpen"!==n.type||"tagClose"!==a.type||n.value!==a.value)return new v("",e,t);var i=function e(t,r,n){var a;if(0==r-t)return[];for(var o=t+1;o<=r;o++){var i=p(t,o,n);if(i instanceof v)a=i;else{var s=e(o,r,n);if(!(s instanceof v)){for(var u=[i],d=0;d<s.length;d++)u.push(s[d]);return u}}}return new v("",t,r,a)}(e+1,t-1,r);return i instanceof v?new v("",e,t,i):{type:n.value,attributes:n.attributes,children:i}}function r(e){var t=p(0,e.length,e);return t}var g={createElement:48,updateElement:33,createText:34,updateText:35,destroyElement:20,appendElement:37,createComponent:54,updateComponent:39,destroyComponent:24,loop:25,return:26};function w(e,t){for(var r=String.fromCharCode(e),n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return r}function n(e){var t={},r=function e(t,r,n){var a=t.type;if("text"===a){var o=n++,i=t.attributes[""],s=r[i];return void 0===s&&(s=r[i]=n++),{create:w(g.createText,[o,s]),createVar:o,update:w(g.updateText,[s]),destroy:w(g.destroyElement,[o]),total:n}}if(a[0]===a[0].toLowerCase()){var u='"'+a+'"',d=function(e){var t="{";for(var r in e)t+='"'+r+'":'+e[r]+",";return t+"}"}(t.attributes),v=n++,p=r[u],f=r[d];void 0===p&&(p=r[u]=n++),void 0===f&&(f=r[d]=n++);for(var c="",l="",h="",y=0;y<t.children.length;y++){var m=e(t.children[y],r,n);c+=m.create,c+=w(g.appendElement,[m.createVar,v]),l+=m.update,h+=m.destroy,n+=m.total}return{create:w(g.createElement,[v,p,f])+c,createVar:v,update:w(g.updateElement,[v])+l,destroy:w(g.destroyElement,[v])+h,total:n}}}(e,t,0),n=r.create,a=r.createVar,o=r.update,i=r.destroy,s="";for(var u in t)s+="this.m"+t[u]+"="+u+";";return{data:s,create:n+=w(g.returnVar,[a]),update:o,destroy:i}}function d(e){return n(r(t(e)))}function e(){}var f={};function c(e){this.view.create}function l(e,t){for(var r in e)this[r]=e[r];this.view.update}function h(e){this.view.destroy}function y(e,t){var r=this.events[e];void 0===r?this.events[e]=[t.bind(this)]:r.push(t.bind(this))}function m(e,t){if(void 0===e)this.events={};else if(void 0===t)this.events[e]=[];else{var r=this.events[e];r.splice(r.indexOf(t),1)}}function x(e,t){for(var r=this.events[e],n=0;n<r.length;n++)r[n](t)}function a(e){e.name=void 0===e.name?"Root":e.name;var t=e.view;"string"==typeof t&&(e.view=d(t));var r=e.onCreate,n=e.onUpdate,a=e.onDestroy;function o(e){for(var t in this.view.data=this.view.data.bind(this),e)this[t]=e[t]}delete e.onCreate,delete e.onUpdate,delete e.onDestroy,e.events={create:[],update:[],destroy:[]},void 0!==r&&e.events.create.push(r),void 0!==n&&e.events.update.push(n),void 0!==a&&e.events.destroy.push(a),(o.prototype=e).m=[],o.prototype.create=c,o.prototype.update=l,o.prototype.destroy=h,o.prototype.on=y,o.prototype.off=m,o.prototype.emit=x;var i=e.root;if(delete e.root,"string"==typeof i&&(i=document.querySelector(i)),void 0===i)return f[name]=o;var s=new o,u=s.create();return i.appendChild(u),s}return a.lex=t,a.parse=r,a.generate=n,a.compile=d,a.execute=e,a.components=f,a});