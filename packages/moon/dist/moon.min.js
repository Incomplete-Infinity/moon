/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var v={element:0,text:1,component:2};var N=/<([\w\d-_]+)([^>]*?)(\/?)>/g,k=/\s*([\w\d-_:@]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g;function t(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var a=e[n+1];if("/"===a){var o=e.indexOf(">",n+2),d=e.slice(n+2,o);0,t.push({type:"tagClose",value:d}),n=o+1;continue}if("!"===a&&"-"===e[n+2]&&"-"===e[n+3]){var i=e.indexOf("--\x3e",n+4);0,n=i+3;continue}N.lastIndex=n;var l=N.exec(e);0;for(var u=l[0],p=l[1],s=l[2],f=l[3],c={},v=void 0;null!==(v=k.exec(s));){var h=v[0],m=v[1],g=v[2],y=v[3];0===h.length?k.lastIndex+=1:c[m]=void 0===y?g:y}t.push({type:"tagOpen",value:p,attributes:c,closed:"/"===f}),n+=u.length}else if("{"===r){var w="";for(n+=1;n<e.length;n++){var b=e[n];if("}"===b)break;w+=b}t.push({type:"tagOpen",value:"text",attributes:{"":w},closed:!0}),n+=1}else{for(var x="";n<e.length;n++){var O=e[n];if("<"===O||"{"===O)break;x+=O}t.push({type:"tagOpen",value:"text",attributes:{"":'"'+x+'"'},closed:!0})}}return t}function p(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function s(e,t,n){var r=n[e],a=n[t-1],o=t-e;if(0==o)return new p("",e,t);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new p("",e,t);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new p("",e,t);var d=function e(t,n,r){var a;if(0==n-t)return[];for(var o=t+1;o<=n;o++){var d=s(t,o,r);if(d instanceof p)a=d;else{var i=e(o,n,r);if(!(i instanceof p)){for(var l=[d],u=0;u<i.length;u++)l.push(i[u]);return l}}}return new p("",t,n,a)}(e+1,t-1,n);return d instanceof p?new p("",e,t,d):{type:r.value,attributes:r.attributes,children:d}}function n(e){var t=s(0,e.length,e);return t}function i(e){var t,n=e.type;t="text"===n?v.text:n[0]===n[0].toLowerCase()?v.element:v.component;var r="{";for(var a in e.attributes)r+='"'+a+'":'+e.attributes[a]+",";r+="children:[";for(var o="",d=0;d<e.children.length;d++)r+=o+i(e.children[d]),o=",";return"{type:"+t+',name:"'+n+'",data:'+r+"]}}"}function a(e){return i(n(t(e)))}var u,f,o,h,r={},c={};function m(e){f=e}var y=[],w={updateText:0,setAttributes:1,appendElement:2,removeElement:3,replaceElement:4};function b(e){var t,n=e.type,r=e.name,a={},o=[];if(n===v.element){t=document.createElement(e.name);var d=e.data;for(var i in d){var l=d[i];"children"!==i&&(a[i]=l,t.setAttribute(i,l))}for(var u=d.children,p=0;p<u.length;p++){var s=b(u[p]);o.push(s),t.appendChild(s.node)}}else{var f=e.data[""];t=document.createTextNode(f),a[""]=f}return a.children=o,{type:n,name:r,data:a,node:t}}function g(e,t,n){for(;;){var r=e.pop(),a=t.pop();if(r!==a){if(r.name!==a.name)n.push({type:w.replaceElement,nodeOld:r,nodeNew:a,nodeParent:null});else if(r.type===v.text)n.push({type:w.updateText,nodeOld:r,nodeNew:a,parent:null});else{n.push({type:w.setAttributes,nodeOld:r,nodeNew:a,nodeParent:null});var o=r.data.children,d=a.data.children,i=o.length,l=d.length;if(i===l)for(var u=0;u<i;u++)e.push(o[u]),t.push(d[u]);else if(l<i){for(var p=0;p<l;p++)e.push(o[p]),t.push(d[p]);for(var s=l;s<i;s++)n.push({type:w.removeElement,nodeOld:o[s],nodeNew:null,nodeParent:r})}else{for(var f=0;f<i;f++)e.push(o[f]),t.push(d[f]);for(var c=i;c<l;c++)n.push({type:w.appendElement,nodeOld:null,nodeNew:d[c],nodeParent:r})}}if(0===e.length){x(n);break}if(12<=performance.now()-h){requestAnimationFrame(function(){h=performance.now(),g(e,t,n)});break}}}}function x(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.type){case w.updateText:var r=n.nodeOld,a=n.nodeNew.data[""];r.data[""]=a,r.node.textContent=a;break;case w.setAttributes:var o=n.nodeOld,d=o.data,i=o.node,l=n.nodeNew.data;for(var u in l){var p=l[u];"children"!==u&&(d[u]=p,i.setAttribute(u,p))}break;case w.appendElement:var s=n.nodeNew,f=n.nodeParent,c=b(s);f.data.children.push(c),f.node.appendChild(c.node);break;case w.removeElement:var v=n.nodeParent;v.data.children.pop(),v.node.removeChild(n.nodeOld.node);break;case w.replaceElement:var h=n.nodeOld,m=b(n.nodeNew),g=h.node;h.type=m.type,h.name=m.name,h.data=m.data,h.node=m.node,g.parentNode.replaceChild(h.node,g)}}y.shift(),0!==y.length&&O()}function O(){var e=y[0];for(var t in h=performance.now(),e)r[t]=e[t];!function e(t,n,r){for(;;){var a=t.pop(),o=n.pop(),d=r.pop();a.type===v.component?(a=c[a.name](a.data),null===o?m(a):o.data.children[d]=a):null===o&&m(a);for(var i=a.data.children,l=0;l<i.length;l++)t.push(i[l]),n.push(a),r.push(l);if(0===t.length){g([u],[f],[]);break}if(12<=performance.now()-h){requestAnimationFrame(function(){h=performance.now(),e(t,n,r)});break}}}([o(r)],[null],[0])}function d(e){y.push(e),1===y.length&&O()}function e(t){var e=function(e,t){return void 0===e?t:e}(t.name,"Root");delete t.name;var n=t.view;delete t.view,"string"==typeof n&&(n=new Function("data","return "+a(n)));var r="string"==typeof t.root?document.querySelector(t.root):t.root;delete t.root,void 0===r?c[e]=function(e){return n(function(e,t){var n={};for(var r in t)n[r]=t[r];for(var a in e)n[a]=e[a];return n}(e,t))}:(function(e){u=e}({type:v.element,name:r.tagName.toLowerCase(),data:{children:[]},node:r}),function(e){o=e}(n),d(t))}return e.lex=t,e.parse=n,e.generate=i,e.compile=a,e.components=c,e.set=d,e});