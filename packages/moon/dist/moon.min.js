/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var $={element:0,text:1,component:2};function v(e,t,n){this.node=e,this.element=t,this.children=n}function u(e,t,n,a){this.type=e,this.name=t,this.data=n,this.children=a}function n(e,t,n,a){return new u(e,t,n,a)}var O=/^\s+$/,k=/&amp;|&gt;|&lt;|&nbsp;|&quot;|\\|"|\n|\r/g,M={class:"className",for:"htmlFor"},N={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r"};function t(e){e=e.trim();for(var t=[],n=0;n<e.length;){var a=e[n];if("<"===a){var r=e[n+1];if("/"===r){var i=e.indexOf(">",n+2),l=e.slice(n+2,i);0,t.push({type:"tagClose",value:l}),n=i+1;continue}if("!"===r&&"-"===e[n+2]&&"-"===e[n+3]){var o=e.indexOf("--\x3e",n+4);0,n=o+3;continue}var s="",u="",v=!1,f={},c=!0,d=0;for(n++;n<e.length;n++){var m=e[n];if("{"===m?d+=1:"}"===m&&(d-=1),0===d&&(">"===m||"/"===m&&">"===e[n+1]&&(v=!0)&&(n+=1))){n+=1;break}c?" "===m?c=!1:"="===m?(c=!1,u+=m):s+=m:u+=m}for(var h=0;h<u.length;h++){var p=u[h];if(!O.test(p)){for(var b="",g="true";h<u.length&&(p=u[h],!O.test(p));h++){if("="===p){g="";break}b+=p}if(b in M&&(b=M[b]),0===g.length){var x=u[++h];"{"===x?x="}":g+=x,h+=1;for(var y=0;h<u.length;h++)if("{"===(p=u[h]))y+=1,g+=p;else if(p===x){if("}"!==x){g+=p,f[b]={value:g,isExpression:!1};break}if(0===y){f[b]={value:g,isExpression:!0};break}y-=1,g+=p}else g+=p}else f[b]={value:g,isExpression:!0}}}t.push({type:"tagOpen",value:s,attributes:f,closed:v})}else if("{"===a){var w="",E=0;for(n+=1;n<e.length;n++){var S=e[n];if("{"===S)E+=1,w+=S;else if("}"===S){if(0===E)break;E-=1,w+=S}else w+=S}t.push({type:"tagOpen",value:"text",attributes:{"":{value:w,isExpression:!0}},closed:!0}),n+=1}else{for(var C="";n<e.length;n++){var A=e[n];if("<"===A||"{"===A)break;C+=A}O.test(C)||t.push({type:"tagOpen",value:"text",attributes:{"":{value:'"'+C.replace(k,function(e){return N[e]})+'"',isExpression:!1}},closed:!0})}}return t}function f(e,t,n,a){this.message=e,this.start=t,this.end=n,this.next=a}function c(e,t,n){var a=n[e],r=n[t-1],i=t-e;if(0==i)return new f("",e,t);if(1==i)return"tagOpen"===a.type&&!0===a.closed?{name:a.value,attributes:a.attributes,children:[]}:new f("",e,t);if("tagOpen"!==a.type||"tagClose"!==r.type||a.value!==r.value)return new f("",e,t);var l=function e(t,n,a){var r;if(0==n-t)return[];for(var i=t+1;i<=n;i++){var l=c(t,i,a);if(l instanceof f)r=l;else{var o=e(i,n,a);if(!(o instanceof f)){for(var s=[l],u=0;u<o.length;u++)s.push(o[u]);return s}}}return new f("",t,n,r)}(e+1,t-1,n);return l instanceof f?new f("",e,t,l):{name:a.value,attributes:a.attributes,children:l}}function a(e){var t=c(0,e.length,e);return t}var C=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,A=["Infinity","NaN","break","case","catch","class","const","continue","default","delete","do","else","extends","false","finally","for","function","if","in","instanceof","let","new","null","return","super","switch","this","throw","true","try","typeof","undefined","var","void","while","window"];function L(e,t,n){var a=t.value,r=!0;return t.isExpression&&(a=a.replace(C,function(e,t){return void 0===t||-1!==A.indexOf(t)?e:(r=!1,-1!==n.indexOf(t)?t:"data"===t?"md":"children"===t?"mc":"md."+t)})),64===e.charCodeAt(0)&&(a="["+a+",md,mc]"),{value:a,isStatic:r}}function R(e,t,n,a){var r=e+t;if(r in a)return a[r];var i=a[r]="ms["+n.length+"]";return n.push(e+i+"="+t+";"),i}function q(e,t,n,a,r,i){var l=z(t.children[0],t,0,n,a,r,i);return{clause:l.isStatic?e+"="+R(l.prelude,l.node,r,i)+";":""+l.prelude+e+"="+l.node+";",variable:l.variable}}function z(e,t,n,a,r,i,l){var o,s=e.name,u=!0,v=!0;if("element"===s)return function(e,t,n,a,r){var i=e.attributes,l=L("name",i.name,n),o=L("data",i.data,n),s=L("children",i.children,n),u=o.isStatic,v=s.isStatic,f=l.isStatic&&u&&v,c=o.value,d=s.value;return f||(u&&(c=R("",c,a,r)),v&&(d=R("",d,a,r))),{prelude:"",node:"m("+$.element+","+l.value+","+c+","+d+")",isStatic:f,variable:t}}(e,a,r,i,l);if("if"===s)return function(e,t,n,a,r,i,l){var o="m"+a,s="",u=!0,v=q(o,e,a+1,r,i,l);if(s+="var "+o+";if("+L("",e.attributes[""],r).value+"){"+v.clause+"}",a=v.variable,null!==t)for(var f=t.children,c=n+1;c<f.length;){var d=f[c];if("else-if"===d.name){var m=q(o,d,a,r,i,l);s+="else if("+L("",d.attributes[""],r).value+"){"+m.clause+"}",a=m.variable,f.splice(c,1)}else{if("else"!==d.name)break;var h=q(o,d,a,r,i,l);s+="else{"+h.clause+"}",a=h.variable,u=!1,f.splice(c,1)}}return u&&(s+="else{"+o+"="+R("","m("+$.text+',"text",{"":""},[])',i,l)+";}"),{prelude:s,node:o,isStatic:!1,variable:a}}(e,t,n,a,r,i,l);if("for"===s)return function(e,t,n,a,r){for(var i,l="m"+t,o="m"+(t+1),s="m"+(t+2),u=e.attributes,v=u[""].value,f=("name"in u?u.name.value:'"span"'),c=("data"in u?L("data",u.data,n):{value:"{}",isStatic:!0});null!==(i=C.exec(v));)void 0!==(i=i[1])&&-1===A.indexOf(i)&&-1===n.indexOf(i)&&(n=n.concat([i]));var d,m,h,p,b=z(e.children[0],e,0,t+3,n,a,r);return t=b.variable,d="var "+o+"=function("+v+"){"+(d=b.isStatic?"return "+R(b.prelude,b.node,a,r)+";":b.prelude+"return "+b.node+";")+"};",p="in"in u?(h="for(var "+s+" in "+(m=L("in",u.in,n).value)+"){",s+","+m+"["+s+"]"):(h="for(var "+s+"=0;"+s+"<"+(m=L("of",u.of,n).value)+".length;"+s+"++){",m+"["+s+"],"+s),c=c.isStatic?R("",c.value,a,r):c.value,{prelude:"var "+l+"=[];"+d+h+l+".push("+o+"("+p+"));}",node:"m("+$.element+","+f+","+c+","+l+")",isStatic:!1,variable:t}}(e,a,r,i,l);o="text"===s?$.text:s[0]===s[0].toLowerCase()?$.element:$.component;var f=e.attributes,c="",d="{",m="",h="";for(var p in f){var b=L(p,f[p],r);"children"===p?(b.isStatic||(v=!1),m=b.value):(b.isStatic||(u=!1),d+=h+'"'+p+'":'+b.value,h=",")}if(d+="}",!("children"in f)){var g=e.children,x=[];m+="[",h="";for(var y=0;y<g.length;y++){var w=z(g[y],e,y,a,r,i,l);w.isStatic||(v=!1),a=w.variable,x.push(w)}for(var E=0;E<x.length;E++){var S=x[E];v||!S.isStatic?(c+=S.prelude,m+=h+S.node):m+=h+R(S.prelude,S.node,i,l),h=","}m+="]"}return u&&!v?d=R("",d,i,l):!u&&v&&(m=R("",m,i,l)),{prelude:c,node:"m("+o+',"'+s+'",'+d+","+m+")",isStatic:u&&v,variable:a}}function r(e){var t=[],n=z(e,null,0,0,[],t,{}),a=n.prelude,r=n.node;return n.isStatic?"if(!(0 in ms)){"+a+"ms[0]="+r+";}return ms[0];":"if(!(0 in ms)){"+t.join("")+"}"+a+"return "+r+";"}function d(e){return r(a(t(e)))}var m,Z={};function _(e,t,n){if("ariaset"===t)for(var a in n)e.setAttribute("aria-"+a,n[a]);else{var r=e[t];for(var i in n)r[i]=n[i]}}function F(e,t,n,a){for(var r in n)if(!(r in a))switch(t){case"ariaset":e.removeAttribute("aria-"+r);break;case"dataset":delete e.dataset[r];break;default:e.style[r]=""}}var h={},i={},l=[],p={};var o=!1;function j(){}function I(e){for(;e.type===$.component;){var t=e.name;e=h[t](n,e.data,e.children,p[t])}return e}function T(e){var t,n=[];if(e.type===$.text)t=document.createTextNode(e.data[""]);else{t=document.createElement(e.name);for(var a=e.children,r=0;r<a.length;r++){var i=T(I(a[r]));n.push(i),t.appendChild(i.element)}var l=e.data;for(var o in l){var s=l[o];if(64===o.charCodeAt(0)){var u=t.MoonEvent;null===u&&(u=t.MoonEvent=new j),u[o]=s,t.addEventListener(o.slice(1),u)}else"ariaset"===o||"dataset"===o||"style"===o?_(t,o,s):t[o]=s}}return new v(e,t,n)}function b(e){for(var t in e)i[t]=e[t];o||(o=!0,requestAnimationFrame(function(){!function e(t,n){var a,r,i=t.node;if(i!==(n=I(n))){var l=i.type,o=i.name;if(l!==(t.node=n).type||o!==n.name){var s=t.element,u=T(n),v=u.element;t.element=v,t.children=u.children,s.parentNode.replaceChild(v,s)}else if(l===$.text){var f=n.data[""];i.data[""]!==f&&(t.element.data=f)}else{var c=i.data,d=n.data;if(c!==d){var m=t.element;for(var h in d){var p=c[h],b=d[h];if(p!==b)if(64===h.charCodeAt(0)){var g=m.MoonEvent;null===g&&(g=m.MoonEvent=new j),h in g?g[h]=b:(g[h]=b,m.addEventListener(h.slice(1),g))}else"ariaset"===h||"dataset"===h||"style"===h?(_(m,h,b),void 0!==p&&F(m,h,p,b)):m[h]=b}for(var x in c)if(!(x in d))if(64===x.charCodeAt(0)){var y=m.MoonEvent;delete y[x],m.removeEventListener(x.slice(1),y)}else"ariaset"===x||"dataset"===x||"style"===x?F(m,x,c[x],{}):(a=o,m[r=x]=a in Z?Z[a][r]:(Z[a]=document.createElement(a))[r])}var w=n.children;if(i.children!==w){var E=t.children,S=E.length,C=w.length;if(S===C)for(var A=0;A<S;A++)e(E[A],w[A]);else{var O=t.element;if(C<S){for(var k=0;k<C;k++)e(E[k],w[k]);for(var M=C;M<S;M++)O.removeChild(E.pop().element)}else{for(var N=0;N<S;N++)e(E[N],w[N]);for(var L=S;L<C;L++){var R=T(I(w[L]));E.push(R),O.appendChild(R.element)}}}}}}}(m,h.Root(n,i,l,p.Root)),o=!1}))}function e(e){var t="name"in e?e.name:"Root",i=e.view;if("string"==typeof i&&(i=new Function("m","md","mc","ms",d(i))),p[t]=[],"Root"===t){var n=e.root;"string"==typeof n&&(n=document.querySelector(n)),h.Root=i;for(var a=n.attributes,r={},l=0;l<a.length;l++){var o=a[l];r[o.name]=o.value}!function(e){m=e}(new v(new u($.element,n.tagName.toLowerCase(),r,[]),n,[])),b("data"in e?e.data:{})}else if("data"in e){var s=e.data;h[t]=function(e,t,n,a){for(var r in s)r in t||(t[r]=s[r]);return i(e,t,n,a)}}else h[t]=i}return j.prototype.handleEvent=function(e){var t=this["@"+e.type];t[0](e,t[1],t[2])},Node.prototype.MoonEvent=null,e.lex=t,e.parse=a,e.generate=r,e.compile=d,e.components=h,e.get=i,e.set=b,e});