/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,n){"undefined"==typeof module?e.Moon=n():module.exports=n()}(this,function(){"use strict";var v={element:0,text:1,component:2};var c,N=/^\s+$/,A=/<([\w\d-_]+)([^>]*?)(\/?)>/g,k=/\s*([\w\d-_:@]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g,n=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,t=["NaN","event","false","in","null","this","true","typeof","undefined","window"];function E(e){return e.replace(n,function(e,n){return void 0===n||-1!==t.indexOf(n)?e:"data."+n})}function r(e){e=e.trim();for(var n=[],t=0;t<e.length;){var r=e[t];if("<"===r){var a=e[t+1];if("/"===a){var o=e.indexOf(">",t+2),i=e.slice(t+2,o);0,n.push({type:"tagClose",value:i}),t=o+1;continue}if("!"===a&&"-"===e[t+2]&&"-"===e[t+3]){var d=e.indexOf("--\x3e",t+4);0,t=d+3;continue}A.lastIndex=t;var l=A.exec(e);0;for(var u=l[0],p=l[1],f=l[2],s=l[3],c={},v=void 0;null!==(v=k.exec(f));){var h=v[0],m=v[1],w=v[2],g=v[3];0===h.length?k.lastIndex+=1:(c[m]=void 0===g?w:E(g),"@"===m[0]&&(c[m]="function(event){"+c[m]+"}"))}n.push({type:"tagOpen",value:p,attributes:c,closed:"/"===s}),t+=u.length}else if("{"===r){var y="";for(t+=1;t<e.length;t++){var b=e[t];if("}"===b)break;y+=b}n.push({type:"tagOpen",value:"text",attributes:{"":E(y)},closed:!0}),t+=1}else{for(var x="";t<e.length;t++){var O=e[t];if("<"===O||"{"===O)break;x+=O}N.test(x)||n.push({type:"tagOpen",value:"text",attributes:{"":'"'+x+'"'},closed:!0})}}return n}function p(e,n,t,r){this.message=e,this.start=n,this.end=t,this.next=r}function f(e,n,t){var r=t[e],a=t[n-1],o=n-e;if(0==o)return new p("",e,n);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new p("",e,n);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new p("",e,n);var i=function e(n,t,r){var a;if(0==t-n)return[];for(var o=n+1;o<=t;o++){var i=f(n,o,r);if(i instanceof p)a=i;else{var d=e(o,t,r);if(!(d instanceof p)){for(var l=[i],u=0;u<d.length;u++)l.push(d[u]);return l}}}return new p("",n,t,a)}(e+1,n-1,t);return i instanceof p?new p("",e,n,i):{type:r.value,attributes:r.attributes,children:i}}function a(e){var n=f(0,e.length,e);return n}function h(e){c=e}function m(e,n,t){var r,a=e.type;if("if"===a)return function(e,n,t){var r="m"+c,a="",o=!0;h(c+1);var i=m(e.children[0],e,0);if(a+="var "+r+";if("+e.attributes[""]+"){"+i.prelude+r+"="+i.node+";}",null!==n)for(var d=n.children,l=t+1;l<d.length;l++){var u=d[l];if("else-if"===u.type){var p=m(u.children[0],u,0);a+="else if("+u.attributes[""]+"){"+p.prelude+r+"="+p.node+";}",d.splice(l,1)}else{if("else"!==u.type)break;var f=m(u.children[0],u,0);a+="else{"+f.prelude+r+"="+f.node+";}",o=!1,d.splice(l,1)}}return o&&(a+="else{"+r+"={type:"+v.text+',name:"text",data:{children:[]}};}'),{prelude:a,node:r}}(e,n,t);r="text"===a?v.text:a[0]===a[0].toLowerCase()?v.element:v.component;var o=e.attributes,i="",d="{",l="";for(var u in o)d+=l+'"'+u+'":'+o[u],l=",";if(void 0===o.children){var p=e.children;d+=l+"children:[",l="";for(var f=0;f<p.length;f++){var s=m(p[f],e,f);i+=s.prelude,d+=l+s.node,l=","}d+="]"}return{prelude:i,node:"{type:"+r+',name:"'+a+'",data:'+d+"}}"}}function o(e){h(0);var n=m(e,null,0);return n.prelude+"return "+n.node+";"}function i(e){return o(a(r(e)))}var u,s,d,g,l={},w={};function y(e){s=e}var b=[],x={updateText:0,setAttributes:1,appendElement:2,removeElement:3,replaceElement:4};function O(e){var n,t=e.type,r=e.name,a={},o=[];if(t===v.text){var i=e.data[""];n=document.createTextNode(i),a[""]=i}else{var d=e.data;for(var l in n=document.createElement(e.name),d){var u=d[l];"@"===l[0]?(a[l]=u,n.addEventListener(l.slice(1),u)):"children"!==l&&(a[l]=u,n.setAttribute(l,u))}for(var p=d.children,f=0;f<p.length;f++){var s=O(p[f]);o.push(s),n.appendChild(s.node)}}return a.children=o,{type:t,name:r,data:a,node:n}}function C(e,n,t){for(;;){var r=e.pop(),a=n.pop();if(r!==a){if(r.name!==a.name)t.push({type:x.replaceElement,nodeOld:r,nodeNew:a,nodeParent:null});else if(r.type===v.text)t.push({type:x.updateText,nodeOld:r,nodeNew:a,parent:null});else{t.push({type:x.setAttributes,nodeOld:r,nodeNew:a,nodeParent:null});var o=r.data.children,i=a.data.children,d=o.length,l=i.length;if(d===l)for(var u=0;u<d;u++)e.push(o[u]),n.push(i[u]);else if(l<d){for(var p=0;p<l;p++)e.push(o[p]),n.push(i[p]);for(var f=l;f<d;f++)t.push({type:x.removeElement,nodeOld:o[f],nodeNew:null,nodeParent:r})}else{for(var s=0;s<d;s++)e.push(o[s]),n.push(i[s]);for(var c=d;c<l;c++)t.push({type:x.appendElement,nodeOld:null,nodeNew:i[c],nodeParent:r})}}if(0===e.length){P(t);break}if(16<=performance.now()-g){requestAnimationFrame(function(){g=performance.now(),C(e,n,t)});break}}}}function P(e){for(var n=0;n<e.length;n++){var t=e[n];switch(t.type){case x.updateText:var r=t.nodeOld,a=t.nodeNew.data[""];r.data[""]=a,r.node.textContent=a;break;case x.setAttributes:var o=t.nodeOld,i=o.data,d=o.node,l=t.nodeNew.data;for(var u in l){var p=l[u];"@"!==u[0]&&"children"!==u&&(i[u]=p,d.setAttribute(u,p))}break;case x.appendElement:var f=t.nodeNew,s=t.nodeParent,c=O(f);s.data.children.push(c),s.node.appendChild(c.node);break;case x.removeElement:var v=t.nodeParent;v.data.children.pop(),v.node.removeChild(t.nodeOld.node);break;case x.replaceElement:var h=t.nodeOld,m=O(t.nodeNew),w=h.node;h.type=m.type,h.name=m.name,h.data=m.data,h.node=m.node,w.parentNode.replaceChild(h.node,w)}}b.shift(),0!==b.length&&(16<=performance.now()-g?requestAnimationFrame(function(){g=performance.now(),_()}):_())}function _(){var e=b[0];for(var n in e)l[n]=e[n];!function e(n,t,r){for(;;){var a=n.pop(),o=t.pop(),i=r.pop();a.type===v.component?(a=w[a.name](a.data),null===o?y(a):o.data.children[i]=a):null===o&&y(a);for(var d=a.data.children,l=0;l<d.length;l++)n.push(d[l]),t.push(a),r.push(l);if(0===n.length){C([u],[s],[]);break}if(16<=performance.now()-g){requestAnimationFrame(function(){g=performance.now(),e(n,t,r)});break}}}([d(l)],[null],[0])}function q(e){b.push(e),1===b.length&&requestAnimationFrame(function(){g=performance.now(),_()})}function e(n){var e=function(e,n){return void 0===e?n:e}(n.name,"Root");delete n.name;var t=n.view;delete n.view,"string"==typeof t&&(t=new Function("data",i(t)));var r="string"==typeof n.root?document.querySelector(n.root):n.root;delete n.root,void 0===r?w[e]=function(e){return t(function(e,n){var t={};for(var r in n)t[r]=n[r];for(var a in e)t[a]=e[a];return t}(e,n))}:(function(e){u=e}({type:v.element,name:r.tagName.toLowerCase(),data:{children:[]},node:r}),function(e){d=e}(t),q(n))}return e.lex=r,e.parse=a,e.generate=o,e.compile=i,e.components=w,e.set=q,e});