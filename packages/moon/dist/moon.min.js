/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var k=/<([\w\d-_]+)([^>]*?)(\/?)>/g,O=/\s*([\w\d-_]*)(?:=(?:("[\w\d-_]*"|'[\w\d-_]*')|{([\w\d-_]*)}))?/g;function t(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var o=e[n+1];if("/"===o){var i=e.indexOf(">",n+2),a=e.slice(n+2,i);0,t.push({type:"tagClose",value:a}),n=i+1;continue}if("!"===o&&"-"===e[n+2]&&"-"===e[n+3]){var s=e.indexOf("--\x3e",n+4);0,n=s+3;continue}k.lastIndex=n;var u=k.exec(e);0;for(var l=u[0],f=u[1],c=u[2],v=u[3],m={},d=void 0;null!==(d=O.exec(c));){var p=d[0],h=d[1],y=d[2],x=d[3];0===p.length?O.lastIndex+=1:m[h]=void 0===x?y:x}t.push({type:"tagOpen",value:f,attributes:m,closed:"/"===v}),n+=l.length}else if("{"===r){var g="";for(n+=1;n<e.length;n++){var w=e[n];if("}"===w)break;g+=w}t.push({type:"tagOpen",value:"Text",attributes:{"":g},closed:!0}),n+=1}else{for(var b="";n<e.length;n++){var E=e[n];if("<"===E||"{"===E)break;b+=E}t.push({type:"tagOpen",value:"Text",attributes:{"":'"'+b+'"'},closed:!0})}}return t}function f(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function c(e,t,n){var r=n[e],o=n[t-1],i=t-e;if(0==i)return new f("",e,t);if(1==i)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new f("",e,t);if("tagOpen"!==r.type||"tagClose"!==o.type||r.value!==o.value)return new f("",e,t);var a=function e(t,n,r){var o;if(0==n-t)return[];for(var i=t+1;i<=n;i++){var a=c(t,i,r);if(a instanceof f)o=a;else{var s=e(i,n,r);if(!(s instanceof f)){for(var u=[a],l=0;l<s.length;l++)u.push(s[l]);return u}}}return new f("",t,n,o)}(e+1,t-1,n);return a instanceof f?new f("",e,t,a):{type:r.value,attributes:r.attributes,children:a}}function n(e){var t=c(0,e.length,e);return t}var r,ee=function(e){return"m"+e},te=function(e,t){return ee(e)+"="+t},ne=function(e){return e.expression?e.value:'"'+e.value+'"'},re=function(e,t){return"m.rc("+ee(e)+","+ee(t)+");"},oe=function(e,t,n,r,o,i){return"m.df("+e+","+ee(t)+","+n+","+ee(r)+","+ee(o)+","+ee(i)+");"},ie=function(e,t,n){return null===n?function(e,t){return"m.ac("+ee(e)+","+ee(t)+");"}(e,t):function(e,t,n){return"m.ib("+ee(e)+","+ee(t)+","+ee(n)+");"}(e,n,t)},v=function e(t,n,r,o){switch(t.type){case"If":for(var i=r.nextElement++,a=r.nextElement++,s=r.nextElement++,u=r.nextElement++,l="[",f="[",c="",v=n.children,m=v.indexOf(t);m<v.length;m++){var d=v[m];if("If"!==d.type&&"ElseIf"!==d.type&&"Else"!==d.type)break;l+=c+("Else"===d.type?"true":ne(d.attributes[0])),f+=c+"function(locals){"+ae({element:r.nextElement,nextElement:r.nextElement+1,type:"Root",attributes:[],children:d.children},a)+"}({})",c=","}return[te(a,"m.cc();")+ie(a,n.element,o)+te(u,f+"];"),te(s,l+"];")+te(i,function(e,t,n,r){return"m.di("+ee(e)+","+ee(t)+","+ee(n)+","+ee(r)+");"}(i,s,u,n.element)),ee(i)+"[2]();"];case"ElseIf":case"Else":return["","",""];case"For":for(var p=ne(t.attributes[0]),h="[",y="",x=r.nextElement++,g=r.nextElement++,w=r.nextElement++,b=r.nextElement++,E="",k="",O=0;O<p.length;O++){var $=p[O];","===$||" "===$&&"i"===p[O+1]&&"n"===p[O+2]&&" "===p[O+3]&&(O+=3)?(h+=k+'"'+E.substring(7)+'"',E="",k=","):E+=$}return h+="]",y+=E,[te(x,"m.cc();")+ie(x,n.element,o)+te(g,"function(locals){"+ae({element:r.nextElement,nextElement:r.nextElement+1,type:"Root",attributes:[],children:t.children},x)+"};")+te(w,"[];")+te(b,"[];"),oe(h,b,y,g,w,n.element),oe(h,b,"[]",g,w,n.element)];case"Text":var _=t.attributes[0],C=r.nextElement++,I=function(e,t){return"m.stc("+ee(e)+","+t+");"}(C,ne(_)),T=te(C,function(e){return"m.ctn("+e+");"}('""')),q="";return _.dynamic?q+=I:T+=I,[T+ie(C,n.element,o),q,re(C,n.element)];default:var F=t.attributes,R=t.children;if(function(e){return e[0]===e[0].toUpperCase()&&e[0]!==e[0].toLowerCase()}(t.type)){t.component=r.nextElement++;for(var U=te(t.component,"new m.c."+t.type+"();"),A="",D=!1,L=0;L<F.length;L++){var M=F[L];if("@"===M.key[0])U+=ee(t.component)+'.on("'+M.key.substring(1)+'",function($event){locals.$event=$event;'+ne(M)+";});";else{var S=ee(t.component)+"."+M.key+"="+ne(M)+";";M.dynamic?(D=!0,A+=S):U+=S}}return U+=ee(t.component)+".create("+ee(n.element)+");",D?A+=ee(t.component)+".update();":U+=ee(t.component)+".update();",[U,A,ee(t.component)+".destroy();"]}t.element=r.nextElement++;for(var j=te(t.element,function(e){return'm.ce("'+e+'");'}(t.type)),z="",B=0;B<F.length;B++){var G=F[B],H=void 0;if("@"===G.key[0]){var J=void 0,K=void 0;if("@bind"===G.key){var N=ne(G);H=ee(t.element)+".value="+N+";",J="input",K=N+"=$event.target.value;instance.update();"}else H="",J=G.key.substring(1),K="locals.$event=$event;"+ne(G)+";";j+=(X=t.element,Y=J,Z="function($event){"+K+"}","m.ael("+ee(X)+',"'+Y+'",'+Z+");")}else V=t.element,W=G,H="m.sa("+ee(V)+',"'+W.key+'",'+ne(W)+");";G.dynamic?z+=H:j+=H}for(var P=0;P<R.length;P++){var Q=e(R[P],t,r,null);j+=Q[0],z+=Q[1]}return[j+ie(t.element,n.element,o),z,re(t.element,n.element)]}var V,W,X,Y,Z},ae=function(e,t){for(var n=e.children,r="",o="",i="",a=0;a<n.length;a++){var s=v(n[a],e,e,t);r+=s[0],o+=s[1],i+=s[2]}for(var u="var "+ee(e.element),l=e.element+1;l<e.nextElement;l++)u+=","+ee(l);return u+";return [function(_0){"+te(e.element,"_0;")+r+"},function(){"+o+"},function(){"+i+"}];"};function l(e){return n(t(e))}function o(){var e=performance.now(),t=r;do{if(8<=performance.now()-e)break;t()}while(void 0!==(t=t.next));void 0!==(r=t)&&requestAnimationFrame(o)}function m(e){var t=this;this.view.transforms.next=function(){t.emit("transform"),e()},void 0===r?(r=this.view.transforms,requestAnimationFrame(o)):r.next=this.view.transforms}function d(e){var t=this;this.transform(function(){t.view.create(e),t.emit("create")})}function p(e){var t=this;for(var n in e)this[n]=e[n];this.transform(function(){t.view.update(),t.emit("update")})}function h(){this.view.destroy(),this.emit("destroy")}function y(e,t){var n=this.events[e];void 0===n?this.events[e]=[t.bind(this)]:n.push(t.bind(this))}function x(e,t){if(void 0===e)this.events={};else if(void 0===t)this.events[e]=[];else{var n=this.events[e];n.splice(n.indexOf(t),1)}}function g(e,t){for(var n=this.events[e],r=0;r<n.length;r++)n[r](t)}function e(e){e.name=void 0===e.name?"Root":e.name;var t=e.view;delete e.view,"string"==typeof t&&(t=l(t));var n=e.onTransform,r=e.onCreate,o=e.onUpdate,i=e.onDestroy;function a(){this.view=t()}delete e.onTransform,delete e.onCreate,delete e.onUpdate,delete e.onDestroy,e.events={transform:[],create:[],update:[],destroy:[]},void 0!==n&&e.events.transform.push(n),void 0!==r&&e.events.create.push(r),void 0!==o&&e.events.update.push(o),void 0!==i&&e.events.destroy.push(i),(a.prototype=e).transform=m,a.prototype.create=d,a.prototype.update=p,a.prototype.destroy=h,a.prototype.on=y,a.prototype.off=x,a.prototype.emit=g;var s=e.root;if(delete e.root,"string"==typeof s&&(s=document.querySelector(s)),void 0===s)return a;var u=new a;return u.create(s),u}return e.lex=t,e.parse=n,e.generate=ae,e.compile=l,e});