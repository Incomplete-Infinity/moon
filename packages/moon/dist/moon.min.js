/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var b={element:0,text:1,component:2};var y,P=/^\s+$/,F=/<([\w\d-_]+)([^>]*?)(\/?)>/g,$=/([\w\d-_:@*]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g,t=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,_=/&amp;|&gt;|&lt;|&nbsp;|&quot;|\\|"|\n|\r/g,z=/checkbox|radio/,r=["NaN","false","in","null","this","true","typeof","undefined","window"],E={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r"};function M(e){switch(e){case"class":return"className";case"for":return"htmlFor";default:return e}}function T(e){var n=!0;return{value:e.replace(t,function(e,t){return void 0===t||-1!==r.indexOf(t)?e:(n=!1,"$"===t[0]?t:"data."+t)}),isStatic:n}}function n(e){e=e.trim();for(var t,n=[],r=0;r<e.length;){var a=e[r];if("<"===a){var o=e[r+1];if("/"===o){var i=e.indexOf(">",r+2),u=e.slice(r+2,i);0,n.push({type:"tagClose",value:u}),r=i+1;continue}if("!"===o&&"-"===e[r+2]&&"-"===e[r+3]){var l=e.indexOf("--\x3e",r+4);0,r=l+3;continue}F.lastIndex=r;var d=F.exec(e);0;for(var c=d[0],s=d[1],v=d[2],f=d[3],p={},h=void 0,m=void 0;null!==(h=$.exec(v));){var g=h[0],w=M(h[1]),b=h[2],y=h[3];if(0===g.length)$.lastIndex+=1;else{var x=w.charCodeAt(0);42===x?m=w.slice(1):(p[w]=void 0===y?{value:void 0===b?'""':b,isStatic:!0}:T(y),64===x&&(p[w].value="["+p[w].value+",data]"))}}if(void 0!==m){var N=p.type,O=void 0,S=void 0;S=N&&z.test(N.value)?(O="checked","@change"):"select"===s?(O="value","@change"):(O="value","@input"),p[O]={value:"data."+m,isStatic:!1},p[S]={value:'[function(me){Moon.set({"'+m+'":me.target.'+O+"});},data]",isStatic:!0}}n.push({type:"tagOpen",value:s,attributes:p,closed:"/"===f}),r+=c.length}else if("{"===a){var A="";for(r+=1;r<e.length;r++){var k=e[r];if("}"===k)break;A+=k}n.push({type:"tagOpen",value:"text",attributes:{"":T(A)},closed:!0}),r+=1}else{for(var C="";r<e.length;r++){var q=e[r];if("<"===q||"{"===q)break;C+=q}P.test(C)||n.push({type:"tagOpen",value:"text",attributes:{"":{value:'"'+(t=C,t.replace(_,function(e){return E[e]}))+'"',isStatic:!0}},closed:!0})}}return n}function c(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function s(e,t,n){var r=n[e],a=n[t-1],o=t-e;if(0==o)return new c("",e,t);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{name:r.value,attributes:r.attributes,children:[]}:new c("",e,t);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new c("",e,t);var i=function e(t,n,r){var a;if(0==n-t)return[];for(var o=t+1;o<=n;o++){var i=s(t,o,r);if(i instanceof c)a=i;else{var u=e(o,n,r);if(!(u instanceof c)){for(var l=[i],d=0;d<u.length;d++)l.push(u[d]);return l}}}return new c("",t,n,a)}(e+1,t-1,n);return i instanceof c?new c("",e,t,i):{name:r.value,attributes:r.attributes,children:i}}function a(e){var t=s(0,e.length,e);return t}function x(e){y=e}function N(e,t,n){var r,a=O(t.children[0],t,0,n);return a.isStatic?(r=e+"=m["+n.length+"];",n.push(a)):r=""+a.prelude+e+"="+a.node+";",r}function O(e,t,n,r){var a,o=e.name,i=!0;if("if"===o)return function(e,t,n,r){var a="m"+y,o="",i=!0;if(x(y+1),o+="var "+a+";if("+e.attributes[""].value+"){"+N(a,e,r)+"}",null!==t)for(var u=t.children,l=n+1;l<u.length;){var d=u[l];if("else-if"===d.name)o+="else if("+d.attributes[""].value+"){"+N(a,d,r)+"}",u.splice(l,1);else{if("else"!==d.name)break;o+="else{"+N(a,d,r)+"}",i=!1,u.splice(l,1)}}return i&&(o+="else{"+a+"=m["+r.length+"];}",r.push({prelude:"",node:"{type:"+b.text+',name:"text",data:{"":"",children:[]}}',isStatic:!0})),{prelude:o,node:a,isStatic:!1}}(e,t,n,r);if("for"===o)return function(e,t){var n,r,a="m"+y,o=e.attributes,i=o[""].value.split(","),u=o.of,l=o.in;x(y+1);var d,c=O(e.children[0],e,0,t);return c.isStatic?(d=a+".push(m["+t.length+"]);",t.push(c)):d=c.prelude+a+".push("+c.node+");",r=void 0===u?(l=l.value,"for(var "+(n=i[0])+" in "+l+"){"+(2===i.length?"var "+i[1]+"="+l+"["+n+"];":"")+d+"}"):(u=u.value,"for(var "+(n=2===i.length?i[1]:"mi")+"=0;"+n+"<"+u+".length;"+n+"++){var "+i[0]+"="+u+"["+n+"];"+d+"}"),{prelude:"var "+a+"=[];"+r,node:"{type:"+b.element+',name:"span",data:{children:'+a+"}}",isStatic:!1}}(e,r);a="text"===o?b.text:o[0]===o[0].toLowerCase()?b.element:b.component;var u=e.attributes,l="",d="{",c="";for(var s in u){var v=u[s];"@"!==s[0]&&v.isStatic||(i=!1),d+=c+'"'+s+'":'+v.value,c=","}if(void 0===u.children){var f=e.children,p=[];d+=c+"children:[",c="";for(var h=0;h<f.length;h++){var m=O(f[h],e,h,r);m.isStatic||(i=!1),p.push(m)}for(var g=0;g<p.length;g++){var w=p[g];i||!w.isStatic?(l+=w.prelude,d+=c+w.node):(d+=c+"m["+r.length+"]",r.push(w)),c=","}d+="]"}return{prelude:l,node:"{type:"+a+',name:"'+o+'",data:'+d+"}}",isStatic:i}}function o(e){var t=[];x(0);var n=O(e,null,0,t),r=n.prelude,a=n.node;if(n.isStatic)return"if(m[0]===undefined){"+r+"m[0]="+a+";}return m[0];";if(0===t.length)return r+"return "+a+";";for(var o="if(m[0]===undefined){",i=0;i<t.length;i++){var u=t[i];o+=u.prelude+"m["+i+"]="+u.node+";"}return""+(o+="}")+r+"return "+a+";"}function d(e){return o(a(n(e)))}var v,f,p,S,i={},h={},m={};function g(e){f=e}var A=[],k={updateText:0,updateData:1,appendNode:2,removeNode:3,replaceNode:4};function C(u){var l,d=[];return u.type===b.text?l=document.createTextNode(u.data[""]):function(){var t=u.data;l=document.createElement(u.name);for(var e=t.children,n=0;n<e.length;n++){var r=C(e[n]);l.appendChild(r.element),d.push(r)}function a(n){var e=t[n];64===n.charCodeAt(0)?(o[n]=e,l.addEventListener(n.slice(1),function(e){var t=o[n];t[0](e,t[1])})):"children"!==n&&(n in l?l[n]=e:!1!==e&&l.setAttribute(n,e))}var o=l.MoonEvents={};for(var i in t)a(i)}(),{element:l,node:u,children:d}}function w(e,t,n){for(;;){var r=e.pop(),a=r.node,o=t.pop();if(a!==o)if(a.name!==o.name)n.push({type:k.replaceNode,nodeOld:r,nodeNew:o,nodeParent:null});else if(a.type===b.text)a.data[""]!==o.data[""]&&n.push({type:k.updateText,nodeOld:r,nodeNew:o,nodeParent:null});else{n.push({type:k.updateData,nodeOld:r,nodeNew:o,nodeParent:null});var i=r.children,u=o.data.children,l=i.length,d=u.length;if(l===d)for(var c=0;c<l;c++)e.push(i[c]),t.push(u[c]);else if(d<l){for(var s=0;s<d;s++)e.push(i[s]),t.push(u[s]);for(var v=d;v<l;v++)n.push({type:k.removeNode,nodeOld:i[v],nodeNew:null,nodeParent:r})}else{for(var f=0;f<l;f++)e.push(i[f]),t.push(u[f]);for(var p=l;p<d;p++)n.push({type:k.appendNode,nodeOld:null,nodeNew:u[p],nodeParent:r})}}if(0===e.length){q(n);break}if(16<=performance.now()-S){requestAnimationFrame(function(){S=performance.now(),w(e,t,n)});break}}}function q(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.type){case k.updateText:var r=n.nodeOld,a=n.nodeNew;r.element.data=a.data[""],r.node=a;break;case k.updateData:var o=n.nodeOld,i=o.node.data,u=o.element,l=n.nodeNew,d=l.data;for(var c in d){var s=d[c];64===c.charCodeAt(0)?u.MoonEvents[c]=s:"children"!==c&&(c in u?u[c]=s:!1===s?u.removeAttribute(c):u.setAttribute(c,s))}for(var v in i)v in d||u.removeAttribute(v);o.node=l;break;case k.appendNode:var f=n.nodeParent,p=C(n.nodeNew);f.element.appendChild(p.element),f.children.push(p);break;case k.removeNode:var h=n.nodeParent;h.element.removeChild(h.children.pop().element);break;case k.replaceNode:var m=n.nodeOld,g=m.element,w=C(n.nodeNew),b=w.element;g.parentNode.replaceChild(b,g),m.element=b,m.node=w.node,m.children=w.children}}A.shift(),0!==A.length&&(16<=performance.now()-S?requestAnimationFrame(function(){S=performance.now(),Z()}):Z())}function Z(){var e=A[0];for(var t in e)i[t]=e[t];var n=p(i);g(n),function e(t,n,r){for(;;){var a=t.pop(),o=n.pop(),i=r.pop();a.type===b.component&&(a=h[a.name](a.data),null===o?g(a):o.data.children[i]=a);for(var u=a.data.children,l=0;l<u.length;l++)t.push(u[l]),n.push(a),r.push(l);if(0===t.length){w([v],[f],[]);break}if(16<=performance.now()-S){requestAnimationFrame(function(){S=performance.now(),e(t,n,r)});break}}}([n],[null],[0])}function D(e){A.push(e),1===A.length&&requestAnimationFrame(function(){S=performance.now(),Z()})}function e(t){var n=function(e,t){return void 0===e?t:e}(t.name,"Root");delete t.name;var r=t.view;delete t.view,"string"==typeof r&&(r=new Function("m","data",d(r))),m[n]=[];function e(e){return r(m[n],function(e,t){var n={};for(var r in e)n[r]=e[r];for(var a in t)a in e||(n[a]=t[a]);return n}(e,t))}if("Root"===n){var a="string"==typeof t.root?document.querySelector(t.root):t.root;delete t.root;for(var o=a.attributes,i={children:[]},u=0;u<o.length;u++){var l=o[u];i[l.name]=l.value}!function(e){v=e}({element:a,node:{type:b.element,name:a.tagName.toLowerCase(),data:i},children:[]}),function(e){p=e}(e),D(t)}else h[n]=e}return e.lex=n,e.parse=a,e.generate=o,e.compile=d,e.components=h,e.get=i,e.set=D,e});