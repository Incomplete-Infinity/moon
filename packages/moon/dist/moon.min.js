/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var m={element:0,text:1,component:2};var a,p,f,i,N=/<([\w\d-_]+)([^>]*?)(\/?)>/g,k=/\s*([\w\d-_:@]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g;function t(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var a=e[n+1];if("/"===a){var o=e.indexOf(">",n+2),i=e.slice(n+2,o);0,t.push({type:"tagClose",value:i}),n=o+1;continue}if("!"===a&&"-"===e[n+2]&&"-"===e[n+3]){var l=e.indexOf("--\x3e",n+4);0,n=l+3;continue}N.lastIndex=n;var u=N.exec(e);0;for(var d=u[0],p=u[1],f=u[2],c=u[3],s={},v=void 0;null!==(v=k.exec(f));){var h=v[0],m=v[1],y=v[2],b=v[3];0===h.length?k.lastIndex+=1:s[m]=void 0===b?y:b}t.push({type:"tagOpen",value:p,attributes:s,closed:"/"===c}),n+=d.length}else if("{"===r){var g="";for(n+=1;n<e.length;n++){var w=e[n];if("}"===w)break;g+=w}t.push({type:"tagOpen",value:"text",attributes:{"":g},closed:!0}),n+=1}else{for(var x="";n<e.length;n++){var O=e[n];if("<"===O||"{"===O)break;x+=O}t.push({type:"tagOpen",value:"text",attributes:{"":'"'+x+'"'},closed:!0})}}return t}function c(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function s(e,t,n){var r=n[e],a=n[t-1],o=t-e;if(0==o)return new c("",e,t);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new c("",e,t);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new c("",e,t);var i=function e(t,n,r){var a;if(0==n-t)return[];for(var o=t+1;o<=n;o++){var i=s(t,o,r);if(i instanceof c)a=i;else{var l=e(o,n,r);if(!(l instanceof c)){for(var u=[i],d=0;d<l.length;d++)u.push(l[d]);return u}}}return new c("",t,n,a)}(e+1,t-1,n);return i instanceof c?new c("",e,t,i):{type:r.value,attributes:r.attributes,children:i}}function n(e){var t=s(0,e.length,e);return t}function l(e){var t,n=e.type;t="text"===n?m.text:n[0]===n[0].toLowerCase()?m.element:m.component;var r="{";for(var a in e.attributes)r+='"'+a+'":'+e.attributes[a]+",";r+="children:[";for(var o="",i=0;i<e.children.length;i++)r+=o+l(e.children[i]),o=",";return"{type:"+t+',name:"'+n+'",data:'+r+"]}}"}function u(e){return l(n(t(e)))}var y,v={};function h(e){f=e}var b={updateText:0,setAttributes:1,appendElement:2,removeElement:3,replaceElement:4};function g(e){var t,n=e.type,r=e.name,a={},o=[];if(n===m.element){t=document.createElement(e.name);var i=e.data;for(var l in i){var u=i[l];"children"!==l&&(a[l]=u,t.setAttribute(l,u))}for(var d=i.children,p=0;p<d.length;p++){var f=g(d[p]);o.push(f),t.appendChild(f.node)}}else{var c=e.data[""];t=document.createTextNode(c),a[""]=c}return a.children=o,{type:n,name:r,data:a,node:t}}function w(e,t,n){for(var r=[e],a=[t];;){var o=r.pop(),i=a.pop();if(o!==i){if(o.name!==i.name)n.push({type:b.replaceElement,nodeOld:o,nodeNew:i,nodeParent:null});else if(o.type===m.text)n.push({type:b.updateText,nodeOld:o,nodeNew:i,parent:null});else{n.push({type:b.setAttributes,nodeOld:o,nodeNew:i,nodeParent:null});var l=o.data.children,u=i.data.children,d=l.length,p=u.length;if(d===p)for(var f=0;f<d;f++)r.push(l[f]),a.push(u[f]);else if(p<d){for(var c=0;c<p;c++)r.push(l[c]),a.push(u[c]);for(var s=p;s<d;s++)n.push({type:b.removeElement,nodeOld:l[s],nodeNew:null,nodeParent:o})}else{for(var v=0;v<d;v++)r.push(l[v]),a.push(u[v]);for(var h=d;h<p;h++)n.push({type:b.appendElement,nodeOld:null,nodeNew:u[h],nodeParent:o})}}if(0===r.length){x(n);break}if(8<=performance.now()-y){requestAnimationFrame(function(){y=performance.now(),w(r,a,n)});break}}}}function x(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.type){case b.updateText:var r=n.nodeOld,a=n.nodeNew.data[""];r.data[""]=a,r.node.textContent=a;break;case b.setAttributes:var o=n.nodeOld,i=o.data,l=o.node,u=n.nodeNew.data;for(var d in u){var p=u[d];"children"!==d&&(i[d]=p,l.setAttribute(d,p))}break;case b.appendElement:var f=n.nodeNew,c=n.nodeParent,s=g(f);c.data.children.push(s),c.node.appendChild(s.node);break;case b.removeElement:var v=n.nodeParent;v.data.children.pop(),v.node.removeChild(n.nodeOld);break;case b.replaceElement:var h=n.nodeOld,m=g(n.nodeNew),y=h.node;h.type=m.type,h.name=m.name,h.data=m.data,h.node=m.node,y.parentNode.replaceChild(h.node,y)}}}function d(){y=performance.now(),function e(t,n,r){for(;;){var a=t.pop(),o=n.pop(),i=r.pop();if(a.type===m.component){var l=v[a.name](a.data);null===o?h(l):a=o.data.children[i]=l}else null===o&&h(a);for(var u=a.data.children,d=0;d<u.length;d++)t.push(u[d]),n.push(a),r.push(d);if(0===t.length){w(p,f,[]);break}if(8<=performance.now()-y){requestAnimationFrame(function(){y=performance.now(),e(t,n,r)});break}}}([i(a)],[null],[0])}function e(t){var e=function(e,t){return void 0===e?t:e}(t.name,"Root");delete t.name;var n=t.view;delete t.view,"string"==typeof n&&(n=new Function("data","return "+u(n)));var r="string"==typeof t.root?document.querySelector(t.root):t.root;delete t.root,void 0===r?v[e]=function(e){return n(function(e,t){var n={};for(var r in t)n[r]=t[r];for(var a in e)n[a]=e[a];return n}(e,t))}:(function(e){p=e}({type:m.element,name:r.tagName.toLowerCase(),data:{children:[]},node:r}),function(e){i=e}(n),function(e){a=e}(t),d())}return e.lex=t,e.parse=n,e.generate=l,e.compile=u,e.components=v,e.set=function(e){!function e(t,n){for(var r in n){var a=n[r];"object"===o(a)?e(t[r],a):t[r]=a}}(a,e),d()},e});