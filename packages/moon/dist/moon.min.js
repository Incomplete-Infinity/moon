/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var O={element:0,text:1,component:2};function f(e,t,a){this.node=e,this.element=t,this.children=a}function u(e,t,a,n){this.type=e,this.name=t,this.data=a,this.children=n}function L(e,t){return void 0===e?t:e}function o(e,t,a,n){return new u(e,t,a,n)}var v,c,M=/^\s+$/,q=/<([\w\d-_]+)([^>]*?)(\/?)>/g,t=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,E=/&amp;|&gt;|&lt;|&nbsp;|&quot;|\\|"|\n|\r/g,n=["NaN","false","in","null","this","true","typeof","undefined","window"],N={class:"className",for:"htmlFor"},$={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r"};function D(e){var a=!0;return{value:e.replace(t,function(e,t){return void 0===t||-1!==n.indexOf(t)?e:(a=!1,"$"===t[0]?t:"md."+t)}),isStatic:a}}function a(e){e=e.trim();for(var t=[],a=0;a<e.length;){var n=e[a];if("<"===n){var r=e[a+1];if("/"===r){var i=e.indexOf(">",a+2),s=e.slice(a+2,i);0,t.push({type:"tagClose",value:s}),a=i+1;continue}if("!"===r&&"-"===e[a+2]&&"-"===e[a+3]){var l=e.indexOf("--\x3e",a+4);0,a=l+3;continue}q.lastIndex=a;var o=q.exec(e);0;for(var u=o[0],v=o[1],f=o[2],c=o[3],d={},h=0;h<f.length;h++){var m=f[h];if(!M.test(m)){for(var p="",g="true";h<f.length&&(m=f[h],!M.test(m));h++){if("="===m){g="";break}p+=m}var b=N[p];if(void 0!==b&&(p=b),0===g.length){var w=f[++h];"{"===w?w="}":g+=w,h+=1;for(var y=0;h<f.length;h++)if("{"===(m=f[h]))y+=1,g+=m;else if(m===w){if("}"!==w){g+=m,d[p]={value:g,isStatic:!0};break}if(0===y){64===p.charCodeAt(0)?d[p]={value:"["+D(g).value+",md,mc]",isStatic:!1}:d[p]=D(g);break}g+=m,y-=1}else g+=m;h+=1}else d[p]={value:g,isStatic:!0}}}t.push({type:"tagOpen",value:v,attributes:d,closed:"/"===c}),a+=u.length}else if("{"===n){var S="",x=0;for(a+=1;a<e.length;a++){var A=e[a];if("{"===A)x+=1,S+=A;else if("}"===A){if(0===x)break;x-=1,S+=A}else S+=A}t.push({type:"tagOpen",value:"text",attributes:{"":D(S)},closed:!0}),a+=1}else{for(var C="";a<e.length;a++){var k=e[a];if("<"===k||"{"===k)break;C+=k}M.test(C)||t.push({type:"tagOpen",value:"text",attributes:{"":{value:'"'+C.replace(E,function(e){return $[e]})+'"',isStatic:!0}},closed:!0})}}return t}function d(e,t,a,n){this.message=e,this.start=t,this.end=a,this.next=n}function h(e,t,a){var n=a[e],r=a[t-1],i=t-e;if(0==i)return new d("",e,t);if(1==i)return"tagOpen"===n.type&&!0===n.closed?{name:n.value,attributes:n.attributes,children:[]}:new d("",e,t);if("tagOpen"!==n.type||"tagClose"!==r.type||n.value!==r.value)return new d("",e,t);var s=function e(t,a,n){var r;if(0==a-t)return[];for(var i=t+1;i<=a;i++){var s=h(t,i,n);if(s instanceof d)r=s;else{var l=e(i,a,n);if(!(l instanceof d)){for(var o=[s],u=0;u<l.length;u++)o.push(l[u]);return o}}}return new d("",t,a,r)}(e+1,t-1,a);return s instanceof d?new d("",e,t,s):{name:n.value,attributes:n.attributes,children:s}}function r(e){var t=h(0,e.length,e);return t}function F(e,t,a,n){var r,i=_(t.children[0],t,0,a,n);if(i.isStatic){var s=n.length;n.push(i.prelude+"ms["+s+"]="+i.node+";"),r=e+"=ms["+s+"];"}else r=""+i.prelude+e+"="+i.node+";";return{clause:r,variable:i.variable}}function _(e,t,a,n,r){var i,s=e.name,l=!0,o=!0;if("element"===s)return function(e,t,a){var n=e.attributes,r=n.name,i=n.data,s=n.children,l=i.isStatic,o=r.isStatic&&l&&s.isStatic,u=i.value;if(!o&&l){var v=a.length;a.push("ms["+v+"]="+u+";"),u="ms["+v+"]"}return{prelude:"",node:"m("+O.element+","+r.value+","+u+","+s.value+")",isStatic:o,variable:t}}(e,n,r);if("if"===s)return function(e,t,a,n,r){var i="m"+n,s="",l=!0,o=F(i,e,n+1,r);if(s+="var "+i+";if("+e.attributes[""].value+"){"+o.clause+"}",n=o.variable,null!==t)for(var u=t.children,v=a+1;v<u.length;){var f=u[v];if("else-if"===f.name){var c=F(i,f,n,r);s+="else if("+f.attributes[""].value+"){"+c.clause+"}",n=c.variable,u.splice(v,1)}else{if("else"!==f.name)break;var d=F(i,f,n,r);s+="else{"+d.clause+"}",n=d.variable,l=!1,u.splice(v,1)}}if(l){var h=r.length;r.push("ms["+h+"]=m("+O.text+',"text",{"":""},[]);'),s+="else{"+i+"=ms["+h+"];}"}return{prelude:s,node:i,isStatic:!1,variable:n}}(e,t,a,n,r);if("for"===s)return function(e,t,a){var n,r,i,s="m"+t,l=e.attributes,o=l[""].value.split(","),u=L(l.name,{value:'"span"'}).value,v=L(l.data,{value:"{}",isStatic:!0}),f=l.of,c=l.in,d=_(e.children[0],e,0,t+1,a);if(t=d.variable,d.isStatic){var h=a.length;a.push(d.prelude+"ms["+h+"]="+d.node+";"),i=s+".push(ms["+h+"]);"}else i=d.prelude+s+".push("+d.node+");";if(r=void 0===f?(c=c.value,"for(var "+(n=o[0])+" in "+c+"){"+(2===o.length?"var "+o[1]+"="+c+"["+n+"];":"")+i+"}"):(f=f.value,"for(var "+(n=2===o.length?o[1]:"m"+t++)+"=0;"+n+"<"+f+".length;"+n+"++){var "+o[0]+"="+f+"["+n+"];"+i+"}"),v.isStatic){var m=a.length;a.push("ms["+m+"]="+v.value+";"),v="ms["+m+"]"}else v=v.value;return{prelude:"var "+s+"=[];"+r,node:"m("+O.element+","+u+","+v+","+s+")",isStatic:!1,variable:t}}(e,n,r);i="text"===s?O.text:s[0]===s[0].toLowerCase()?O.element:O.component;var u=e.attributes,v="",f="{",c="[",d="";for(var h in u){var m=u[h];m.isStatic||(l=!1),f+=d+'"'+h+'":'+m.value,d=","}f+="}";var p=e.children,g=[];d="";for(var b=0;b<p.length;b++){var w=_(p[b],e,b,n,r);w.isStatic||(o=!1),n=w.variable,g.push(w)}for(var y=l&&o,S=0;S<g.length;S++){var x=g[S];if(y||!x.isStatic)v+=x.prelude,c+=d+x.node;else{var A=r.length;r.push(x.prelude+"ms["+A+"]="+x.node+";"),c+=d+"ms["+A+"]"}d=","}if(c+="]",l&&!o){var C=r.length;r.push("ms["+C+"]="+f+";"),f="ms["+C+"]"}else if(!l&&o){var k=r.length;r.push("ms["+k+"]="+c+";"),c="ms["+k+"]"}return{prelude:v,node:"m("+i+',"'+s+'",'+f+","+c+")",isStatic:y,variable:n}}function i(e){var t=[],a=_(e,null,0,0,t),n=a.prelude,r=a.node;return a.isStatic?"if(ms[0]===undefined){"+n+"ms[0]="+r+";}return ms[0];":"if(ms[0]===undefined){"+t.join("")+"}"+n+"return "+r+";"}function m(e){return i(r(a(e)))}function z(e,t,a){if("ariaset"===e)for(var n in t)a.setAttribute("aria-"+n,t[n]);else{var r=a[e];for(var i in t)r[i]=t[i]}}function R(e,t,a,n){for(var r in t)if(!(r in a))switch(e){case"ariaset":n.removeAttribute("aria-"+r);break;case"dataset":delete n.dataset[e];break;default:n.style[e]=""}}function Z(a,e,n,t,r){n[a]=e,r.addEventListener(a.slice(1),t[a]=function(e){var t=n[a];t[0](e,t[1],t[2])})}var p,g={},s={},l=[],b={};var w=[];function j(e){var t,a=[];if(e.type===O.text)t=document.createTextNode(e.data[""]);else{t=document.createElement(e.name);for(var n=e.children,r=0;r<n.length;r++){var i=j(n[r]);t.appendChild(i.element),a.push(i)}var s=t.MoonEvents={},l=t.MoonListeners={},o=e.data;for(var u in o){var v=o[u];64===u.charCodeAt(0)?Z(u,v,s,l,t):"ariaset"===u||"dataset"===u||"style"===u?z(u,v,t):t[u]=v}}return new f(e,t,a)}function I(e,t){var a=e.node;if(a!==t)if(e.node=t,a.type!==t.type||a.name!==t.name){var n=e.element,r=j(t),i=r.element;e.element=i,e.children=r.children,n.parentNode.replaceChild(n,i)}else if(a.type===O.text){var s=t.data[""];a.data[""]!==s&&(e.element.data=s)}else{var l=e.element,o=a.data,u=t.data;if(o!==u){for(var v in u){var f=o[v],c=u[v];if(f!==c)if(64===v.charCodeAt(0)){var d=l.MoonEvents;void 0===d[v]?Z(v,c,d,l.MoonListeners,l):d[v]=c}else"ariaset"===v||"dataset"===v||"style"===v?(z(v,c,l),void 0!==f&&R(v,f,c,l)):l[v]=c}for(var h in o)if(!(h in u))if(64===h.charCodeAt(0)){var m=l.MoonListeners;l.removeEventListener(m[h]),m[h]=void 0,l.MoonEvents[h]=void 0}else"ariaset"===h||"dataset"===h||"style"===h?R(h,o[h],{},l):l.removeAttribute(h)}var p=e.children,g=t.children;if(p!==g){var b=p.length,w=g.length;if(b===w)for(var y=0;y<b;y++)I(p[y],g[y]);else if(w<b){for(var S=0;S<w;S++)I(p[S],g[S]);for(var x=w;x<b;x++)l.removeChild(p.pop().element)}else{for(var A=0;A<b;A++)I(p[A],g[A]);for(var C=b;C<w;C++){var k=j(g[C]);p.push(k),l.appendChild(k.element)}}}}}function y(){var e=w.shift();for(var t in e)s[t]=e[t];!function(e){c=e}(g.Root(o,s,l,b.Root)),function e(t){for(;;){for(var a=t.pop(),n=a.children;a.type===O.component;){var r=a.name,i=g[r](o,a.data,n,b[r]);a.type=i.type,a.name=i.name,a.data=i.data,n=a.children=i.children}var s=n.length;if(0!==s)for(var l=0;l<s;l++)t.push(n[l]);if(0===t.length){I(v,c),0!==w.length&&(16<=Date.now()-p?requestAnimationFrame(function(){p=Date.now(),y()}):y());break}if(16<=Date.now()-p){requestAnimationFrame(function(){p=Date.now(),e(t)});break}}}([c])}function S(e){w.push(e),1===w.length&&requestAnimationFrame(function(){p=Date.now(),y()})}function e(e){var t=L(e.name,"Root"),i=e.data,s=e.view;if("string"==typeof s&&(s=new Function("m","md","mc","ms",m(s))),b[t]=[],g[t]=void 0===i?s:function(e,t,a,n){for(var r in i)r in t||(t[r]=i[r]);return s(e,t,a,n)},"Root"===t){var a=e.root;"string"==typeof a&&(a=document.querySelector(a));for(var n=a.attributes,r={},l=0;l<n.length;l++){var o=n[l];r[o.name]=o.value}!function(e){v=e}(new f(new u(O.element,a.tagName.toLowerCase(),r,[]),a,[])),S(L(i,{}))}}return e.lex=a,e.parse=r,e.generate=i,e.compile=m,e.components=g,e.get=s,e.set=S,e});