/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var C={element:0,text:1,component:2};function v(e,t,n){this.node=e,this.element=t,this.children=n}function r(e,t,n){this.type=e,this.name=t,this.data=n}function w(e,t){return void 0===e?t:e}function f(e,t,n){return new r(e,t,n)}var y,O=/^\s+$/,L=/<([\w\d-_]+)([^>]*?)(\/?)>/g,t=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,M=/&amp;|&gt;|&lt;|&nbsp;|&quot;|\\|"|\n|\r/g,a=["NaN","false","in","null","this","true","typeof","undefined","window"],q={class:"className",for:"htmlFor"},E={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r"};function $(e){var n=!0;return{value:e.replace(t,function(e,t){return void 0===t||-1!==a.indexOf(t)?e:(n=!1,"$"===t[0]?t:"data."+t)}),isStatic:n}}function n(e){e=e.trim();for(var t=[],n=0;n<e.length;){var r=e[n];if("<"===r){var a=e[n+1];if("/"===a){var i=e.indexOf(">",n+2),o=e.slice(n+2,i);0,t.push({type:"tagClose",value:o}),n=i+1;continue}if("!"===a&&"-"===e[n+2]&&"-"===e[n+3]){var l=e.indexOf("--\x3e",n+4);0,n=l+3;continue}L.lastIndex=n;var s=L.exec(e);0;for(var u=s[0],f=s[1],v=s[2],d=s[3],c={},h=0;h<v.length;h++){var p=v[h];if(!O.test(p)){for(var m="",g="true";h<v.length&&(p=v[h],!O.test(p));h++){if("="===p){g="";break}m+=p}var b=q[m];if(void 0!==b&&(m=b),0===g.length){var w=v[++h];"{"===w?w="}":g+=w,h+=1;for(var y=0;h<v.length;h++)if("{"===(p=v[h]))y+=1,g+=p;else if(p===w){if("}"!==w){g+=p,c[m]={value:g,isStatic:!0};break}if(0===y){64===m.charCodeAt(0)?c[m]={value:"["+$(g).value+",data]",isStatic:!1}:c[m]=$(g);break}g+=p,y-=1}else g+=p;h+=1}else c[m]={value:g,isStatic:!0}}}t.push({type:"tagOpen",value:f,attributes:c,closed:"/"===d}),n+=u.length}else if("{"===r){var x="",S=0;for(n+=1;n<e.length;n++){var A=e[n];if("{"===A)S+=1,x+=A;else if("}"===A){if(0===S)break;S-=1,x+=A}else x+=A}t.push({type:"tagOpen",value:"text",attributes:{"":$(x)},closed:!0}),n+=1}else{for(var C="";n<e.length;n++){var k=e[n];if("<"===k||"{"===k)break;C+=k}O.test(C)||t.push({type:"tagOpen",value:"text",attributes:{"":{value:'"'+C.replace(M,function(e){return E[e]})+'"',isStatic:!0}},closed:!0})}}return t}function d(e,t,n,r){this.message=e,this.start=t,this.end=n,this.next=r}function c(e,t,n){var r=n[e],a=n[t-1],i=t-e;if(0==i)return new d("",e,t);if(1==i)return"tagOpen"===r.type&&!0===r.closed?{name:r.value,attributes:r.attributes,children:[]}:new d("",e,t);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new d("",e,t);var o=function e(t,n,r){var a;if(0==n-t)return[];for(var i=t+1;i<=n;i++){var o=c(t,i,r);if(o instanceof d)a=o;else{var l=e(i,n,r);if(!(l instanceof d)){for(var s=[o],u=0;u<l.length;u++)s.push(l[u]);return s}}}return new d("",t,n,a)}(e+1,t-1,n);return o instanceof d?new d("",e,t,o):{name:r.value,attributes:r.attributes,children:o}}function i(e){var t=c(0,e.length,e);return t}function x(e){y=e}function S(e,t,n){var r,a=A(t.children[0],t,0,n);return a.isStatic?(r=e+"=ms["+n.length+"];",n.push(a)):r=""+a.prelude+e+"="+a.node+";",r}function A(e,t,n,r){var a,i=e.name,o=!0;if("if"===i)return function(e,t,n,r){var a="m"+y,i="",o=!0;if(x(y+1),i+="var "+a+";if("+e.attributes[""].value+"){"+S(a,e,r)+"}",null!==t)for(var l=t.children,s=n+1;s<l.length;){var u=l[s];if("else-if"===u.name)i+="else if("+u.attributes[""].value+"){"+S(a,u,r)+"}",l.splice(s,1);else{if("else"!==u.name)break;i+="else{"+S(a,u,r)+"}",o=!1,l.splice(s,1)}}return o&&(i+="else{"+a+"=ms["+r.length+"];}",r.push({prelude:"",node:"m("+C.text+',"text",{"":"",children:[]})',isStatic:!0})),{prelude:i,node:a,isStatic:!1}}(e,t,n,r);if("for"===i)return function(e,t){var n,r,a="m"+y,i=e.attributes,o=i[""].value.split(","),l=w(i.name,{value:'"span"'}).value,s=w(i.data,{value:"{}"}).value,u=i.of,f=i.in;x(y+1);var v,d=A(e.children[0],e,0,t);return d.isStatic?(v=a+".children.push(ms["+t.length+"]);",t.push(d)):v=d.prelude+a+".children.push("+d.node+");",r=void 0===u?(f=f.value,"for(var "+(n=o[0])+" in "+f+"){"+(2===o.length?"var "+o[1]+"="+f+"["+n+"];":"")+v+"}"):(u=u.value,"for(var "+(n=2===o.length?o[1]:"mi")+"=0;"+n+"<"+u+".length;"+n+"++){var "+o[0]+"="+u+"["+n+"];"+v+"}"),{prelude:"var "+a+"="+s+";"+a+".children=[];"+r,node:"m("+C.element+","+l+","+a+")",isStatic:!1}}(e,r);a="text"===i?C.text:i[0]===i[0].toLowerCase()?C.element:C.component;var l=e.attributes,s="",u="{",f="";for(var v in l){var d=l[v];"@"!==v[0]&&d.isStatic||(o=!1),u+=f+'"'+v+'":'+d.value,f=","}if(void 0===l.children){var c=e.children,h=[];u+=f+"children:[",f="";for(var p=0;p<c.length;p++){var m=A(c[p],e,p,r);m.isStatic||(o=!1),h.push(m)}for(var g=0;g<h.length;g++){var b=h[g];o||!b.isStatic?(s+=b.prelude,u+=f+b.node):(u+=f+"ms["+r.length+"]",r.push(b)),f=","}u+="]"}return{prelude:s,node:"m("+a+',"'+i+'",'+u+"})",isStatic:o}}function o(e){var t=[];x(0);var n=A(e,null,0,t),r=n.prelude,a=n.node;if(n.isStatic)return"if(ms[0]===undefined){"+r+"ms[0]="+a+";}return ms[0];";if(0===t.length)return r+"return "+a+";";for(var i="if(ms[0]===undefined){",o=0;o<t.length;o++){var l=t[o];i+=l.prelude+"ms["+o+"]="+l.node+";"}return""+(i+="}")+r+"return "+a+";"}function h(e){return o(i(n(e)))}function k(e,t,n){if("ariaset"===e)for(var r in t)n.setAttribute("aria-"+r,t[r]);else{var a=n[e];for(var i in t)a[i]=t[i]}}function D(e,t,n,r){for(var a in t)if(!(a in n))switch(e){case"ariaset":r.removeAttribute("aria-"+a);break;case"dataset":delete r.dataset[e];break;default:r.style[e]=""}}function F(n,e,r,t,a){r[n]=e,a.addEventListener(n.slice(1),t[n]=function(e){var t=r[n];t[0](e,t[1])})}var p,m,l,s,u={},g={},b={};var N=[];function _(e){var t,n=[];if(e.type===C.text)t=document.createTextNode(e.data[""]);else{var r=e.data;t=document.createElement(e.name);for(var a=r.children,i=0;i<a.length;i++){var o=_(a[i]);t.appendChild(o.element),n.push(o)}var l=t.MoonEvents={},s=t.MoonListeners={};for(var u in r){var f=r[u];64===u.charCodeAt(0)?F(u,f,l,s,t):"ariaset"===u||"dataset"===u||"style"===u?k(u,f,t):"children"!==u&&(t[u]=f)}}return new v(e,t,n)}function z(e,t){var n=e.node;if(n!==t)if(e.node=t,n.type!==t.type||n.name!==t.name){var r=_(t);e.element=r.element,e.children=r.children}else if(n.type===C.text){var a=t.data[""];n.data[""]!==a&&(e.element.data=a)}else{var i=e.element,o=n.data,l=t.data;for(var s in l){var u=o[s],f=l[s];if("children"!==s&&u!==f)if(64===s.charCodeAt(0)){var v=i.MoonEvents;void 0===v[s]?F(s,f,v,i.MoonListeners,i):v[s]=f}else"ariaset"===s||"dataset"===s||"style"===s?(k(s,f,i),void 0!==u&&D(s,u,f,i)):i[s]=f}for(var d in o)if(!(d in l))if(64===d.charCodeAt(0)){var c=i.MoonListeners;i.removeEventListener(c[d]),c[d]=void 0,i.MoonEvents[d]=void 0}else"ariaset"===d||"dataset"===d||"style"===d?D(d,o[d],{},i):i.removeAttribute(d);var h=e.children,p=l.children,m=h.length,g=p.length;if(m===g)for(var b=0;b<m;b++)z(h[b],p[b]);else if(g<m){for(var w=0;w<g;w++)z(h[w],p[w]);for(var y=g;y<m;y++)i.removeChild(h.pop().element)}else{for(var x=0;x<m;x++)z(h[x],p[x]);for(var S=m;S<g;S++){var A=_(p[S]);h.push(A),i.appendChild(A.element)}}}}function Z(){var e=N[0];for(var t in e)u[t]=e[t];!function(e){l=e}(m(u)),function e(t){for(;;){for(var n=t.pop();n.type===C.component;){var r=g[n.name](n.data);n.type=r.type,n.name=r.name,n.data=r.data}for(var a=n.data.children,i=0;i<a.length;i++)t.push(a[i]);if(0===t.length){z(p,l),N.shift(),0!==N.length&&(16<=Date.now()-s?requestAnimationFrame(function(){s=Date.now(),Z()}):Z());break}if(16<=Date.now()-s){requestAnimationFrame(function(){s=Date.now(),e(t)});break}}}([l])}function R(e){N.push(e),1===N.length&&requestAnimationFrame(function(){s=Date.now(),Z()})}function e(e){var n=w(e.name,"Root"),r=w(e.data,{}),a=e.view;"string"==typeof a&&(a=new Function("m","ms","data",h(a))),b[n]=[];function t(e){for(var t in r)t in e||(e[t]=r[t]);return a(f,b[n],e)}if("Root"===n){var i=e.root;"string"==typeof i&&(i=document.querySelector(i));for(var o=i.attributes,l={children:[]},s=0;s<o.length;s++){var u=o[s];l[u.name]=u.value}!function(e){p=e}(new v({type:C.element,name:i.tagName.toLowerCase(),data:l},i,[])),function(e){m=e}(t),R(r)}else g[n]=t}return e.lex=n,e.parse=i,e.generate=o,e.compile=h,e.components=g,e.get=u,e.set=R,e});