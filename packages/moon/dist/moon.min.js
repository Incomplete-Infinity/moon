/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var A=/<([\w\d-_]+)([^>]*?)(\/?)>/g,E=/\s*([\w\d-_]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g;function t(e){e=e.trim();for(var t=[],r=0;r<e.length;){var n=e[r];if("<"===n){var a=e[r+1];if("/"===a){var o=e.indexOf(">",r+2),i=e.slice(r+2,o);0,t.push({type:"tagClose",value:i}),r=o+1;continue}if("!"===a&&"-"===e[r+2]&&"-"===e[r+3]){var d=e.indexOf("--\x3e",r+4);0,r=d+3;continue}A.lastIndex=r;var s=A.exec(e);0;for(var u=s[0],c=s[1],v=s[2],p=s[3],f={},h=void 0;null!==(h=E.exec(v));){var l=h[0],m=h[1],y=h[2],C=h[3];0===l.length?E.lastIndex+=1:f[m]=void 0===C?y:C}t.push({type:"tagOpen",value:c,attributes:f,closed:"/"===p}),r+=u.length}else if("{"===n){var g="";for(r+=1;r<e.length;r++){var w=e[r];if("}"===w)break;g+=w}t.push({type:"tagOpen",value:"text",attributes:{"":g},closed:!0}),r+=1}else{for(var b="";r<e.length;r++){var x=e[r];if("<"===x||"{"===x)break;b+=x}t.push({type:"tagOpen",value:"text",attributes:{"":'"'+b+'"'},closed:!0})}}return t}function c(e,t,r,n){this.message=e,this.start=t,this.end=r,this.next=n}function v(e,t,r){var n=r[e],a=r[t-1],o=t-e;if(0==o)return new c("",e,t);if(1==o)return"tagOpen"===n.type&&!0===n.closed?{type:n.value,attributes:n.attributes,children:[]}:new c("",e,t);if("tagOpen"!==n.type||"tagClose"!==a.type||n.value!==a.value)return new c("",e,t);var i=function e(t,r,n){var a;if(0==r-t)return[];for(var o=t+1;o<=r;o++){var i=v(t,o,n);if(i instanceof c)a=i;else{var d=e(o,r,n);if(!(d instanceof c)){for(var s=[i],u=0;u<d.length;u++)s.push(d[u]);return s}}}return new c("",t,r,a)}(e+1,t-1,r);return i instanceof c?new c("",e,t,i):{type:n.value,attributes:n.attributes,children:i}}function r(e){var t=v(0,e.length,e);return t}var y={createElement:48,updateElement:33,createText:34,updateText:35,destroyElement:20,appendElement:37,createComponent:54,updateComponent:39,destroyComponent:24,return:9,returnVar:26};function f(e,t){for(var r=String.fromCharCode(e),n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return r}function h(e,t,r){var n=e.type;return"text"===n?function(e,t,r){var n=r++,a=e.attributes[""],o=t[a];return void 0===o&&(o=t[a]=r++),{create:f(y.createText,[n,o]),createVar:n,update:f(y.updateText,[o]),destroy:f(y.destroyElement,[n]),total:r}}(e,t,r):n[0]===n[0].toLowerCase()?function(e,t,r){var n='"'+e.type+'"',a=function(e){var t="{";for(var r in e)t+='"'+r+'":'+e[r]+",";return t+"}"}(e.attributes),o=r++,i=t[n],d=t[a];void 0===i&&(i=t[n]=r++),void 0===d&&(d=t[a]=r++);for(var s="",u="",c="",v=0;v<e.children.length;v++){var p=h(e.children[v],t,r);s+=p.create,s+=f(y.appendElement,[p.createVar,o]),u+=p.update,c+=p.destroy,r=p.total}return{create:f(y.createElement,[o,i,d])+s,createVar:o,update:f(y.updateElement,[o])+u,destroy:f(y.destroyElement,[o])+c,total:r}}(e,t,r):void 0}function n(e){var t={},r=h(e,t,0),n=r.create,a=r.createVar,o=r.update,i=r.destroy,d="";for(var s in t)d+="this.m"+t[s]+"="+s+";";return n+=f(y.returnVar,[a]),{data:new Function(d),create:n,update:o,destroy:i}}function s(e){return n(r(t(e)))}function C(e,t){return t["m"+e]}function g(e,t,r){r["m"+e]=t}function w(e,t,r,n,a){for(var o=e;o<n.length;){switch(n.charCodeAt(o)){case y.createElement:var i=n.charCodeAt(++o),d=document.createElement(C(n.charCodeAt(++o),r)),s=C(n.charCodeAt(++o),r);for(var u in s)d.setAttribute(u,s[u]);g(i,d,r),o+=1;break;case y.updateElement:var c=C(n.charCodeAt(++o),r),v=C(n.charCodeAt(++o),r);for(var p in v)c.setAttribute(p,v[p]);o+=1;break;case y.createText:g(n.charCodeAt(++o),document.createTextNode(C(n.charCodeAt(++o),r)),r),o+=1;break;case y.updateText:var f=C(n.charCodeAt(++o),r),h=C(n.charCodeAt(++o),r);f.textContent=h,o+=1;break;case y.destroyElement:var l=C(n.charCodeAt(++o),r);l.parentNode.destroyChild(l),o+=1;break;case y.appendElement:var m=C(n.charCodeAt(++o),r);C(n.charCodeAt(++o),r).appendChild(m),o+=1;break;case y.returnVar:return void a(C(n.charCodeAt(++o),r))}if(8<=performance.now()-t){requestAnimationFrame(function(){w(o,performance.now(),r,n,a)});break}}}var u={};function p(t,e){var r=this;this.view.data(),w(0,void 0===e?performance.now():e,this,this.view.create,function(e){r.emit("create",e),void 0!==t&&t(e)})}function l(e,t,r){var n=this;for(var a in e)this[a]=e[a];w(0,void 0===r?performance.now():r,this,this.view.update,function(){n.emit("update"),void 0!==t&&t()})}function m(e,t){var r=this;w(0,void 0===t?performance.now():t,this,this.view.destroy,function(){r.emit("destroy"),void 0!==e&&e()})}function b(e,t){var r=this.events[e];void 0===r?this.events[e]=[t.bind(this)]:r.push(t.bind(this))}function x(e,t){if(void 0===e)this.events={};else if(void 0===t)this.events[e]=[];else{var r=this.events[e];r.splice(r.indexOf(t),1)}}function k(e,t){for(var r=this.events[e],n=0;n<r.length;n++)r[n](t)}function e(e){e.name=void 0===e.name?"Root":e.name;var t=e.view;"string"==typeof t&&(e.view=s(t));var r=e.onCreate,n=e.onUpdate,a=e.onDestroy;function o(e){for(var t in this.view.data=this.view.data.bind(this),e)this[t]=e[t]}delete e.onCreate,delete e.onUpdate,delete e.onDestroy,e.events={create:[],update:[],destroy:[]},void 0!==r&&e.events.create.push(r),void 0!==n&&e.events.update.push(n),void 0!==a&&e.events.destroy.push(a),(o.prototype=e).m=[],o.prototype.create=p,o.prototype.update=l,o.prototype.destroy=m,o.prototype.on=b,o.prototype.off=x,o.prototype.emit=k;var i=e.root;if(delete e.root,"string"==typeof i&&(i=document.querySelector(i)),void 0===i)return u[name]=o;var d=new o;return d.create(function(e){i.appendChild(e)}),d}return e.lex=t,e.parse=r,e.generate=n,e.compile=s,e.execute=w,e.components=u,e});