/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var A=/<([\w\d-_]+)([^>]*?)(\/?)>/g,E=/\s*([\w\d-_]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g;function t(e){e=e.trim();for(var t=[],r=0;r<e.length;){var n=e[r];if("<"===n){var a=e[r+1];if("/"===a){var o=e.indexOf(">",r+2),i=e.slice(r+2,o);0,t.push({type:"tagClose",value:i}),r=o+1;continue}if("!"===a&&"-"===e[r+2]&&"-"===e[r+3]){var s=e.indexOf("--\x3e",r+4);0,r=s+3;continue}A.lastIndex=r;var d=A.exec(e);0;for(var u=d[0],c=d[1],v=d[2],p=d[3],f={},h=void 0;null!==(h=E.exec(v));){var l=h[0],m=h[1],y=h[2],C=h[3];0===l.length?E.lastIndex+=1:f[m]=void 0===C?y:C}t.push({type:"tagOpen",value:c,attributes:f,closed:"/"===p}),r+=u.length}else if("{"===n){var g="";for(r+=1;r<e.length;r++){var x=e[r];if("}"===x)break;g+=x}t.push({type:"tagOpen",value:"text",attributes:{"":g},closed:!0}),r+=1}else{for(var b="";r<e.length;r++){var w=e[r];if("<"===w||"{"===w)break;b+=w}t.push({type:"tagOpen",value:"text",attributes:{"":'"'+b+'"'},closed:!0})}}return t}function c(e,t,r,n){this.message=e,this.start=t,this.end=r,this.next=n}function v(e,t,r){var n=r[e],a=r[t-1],o=t-e;if(0==o)return new c("",e,t);if(1==o)return"tagOpen"===n.type&&!0===n.closed?{type:n.value,attributes:n.attributes,children:[]}:new c("",e,t);if("tagOpen"!==n.type||"tagClose"!==a.type||n.value!==a.value)return new c("",e,t);var i=function e(t,r,n){var a;if(0==r-t)return[];for(var o=t+1;o<=r;o++){var i=v(t,o,n);if(i instanceof c)a=i;else{var s=e(o,r,n);if(!(s instanceof c)){for(var d=[i],u=0;u<s.length;u++)d.push(s[u]);return d}}}return new c("",t,r,a)}(e+1,t-1,r);return i instanceof c?new c("",e,t,i):{type:n.value,attributes:n.attributes,children:i}}function r(e){var t=v(0,e.length,e);return t}var C={createElement:0,updateElement:1,createText:2,updateText:3,destroyElement:4,appendElement:5,createComponent:6,updateComponent:7,destroyComponent:8,returnVar:9};function g(e,t){for(var r=String.fromCharCode(e),n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return r}function n(e){var t={},r=function e(t,r,n){var a=t.type;if("text"===a){var o=n++,i=t.attributes[""],s=r[i];return void 0===s&&(s=r[i]=n++),{create:g(C.createText,[o,s]),createVar:o,update:g(C.updateText,[s]),destroy:g(C.destroyElement,[o]),total:n}}if(a[0]===a[0].toLowerCase()){var d='"'+a+'"',u=function(e){var t="{";for(var r in e)t+='"'+r+'":'+e[r]+",";return t+"}"}(t.attributes),c=n++,v=r[d],p=r[u];void 0===v&&(v=r[d]=n++),void 0===p&&(p=r[u]=n++);for(var f="",h="",l="",m=0;m<t.children.length;m++){var y=e(t.children[m],r,n);f+=y.create,f+=g(C.appendElement,[y.createVar,c]),h+=y.update,l+=y.destroy,n+=y.total}return{create:g(C.createElement,[c,v,p])+f,createVar:c,update:g(C.updateElement,[c])+h,destroy:g(C.destroyElement,[c])+l,total:n}}}(e,t,0),n=r.create,a=r.createVar,o=r.update,i=r.destroy,s="";for(var d in t)s+="this.m"+t[d]+"="+d+";";return n+=g(C.returnVar,[a]),{data:new Function(s),create:n,update:o,destroy:i}}function d(e){return n(r(t(e)))}function m(e,t){return t["m"+e]}function y(e,t,r){r["m"+e]=t}function a(e,t,r,n){for(var a=e;a<r.length;)switch(r.charCodeAt(a)){case C.createElement:var o=r.charCodeAt(++a),i=document.createElement(m(r.charCodeAt(++a),t)),s=m(r.charCodeAt(++a),t);for(var d in s)i.setAttribute(d,s[d]);y(o,i,t),a+=1;break;case C.updateElement:var u=m(r.charCodeAt(++a),t),c=m(r.charCodeAt(++a),t);for(var v in c)u.setAttribute(v,c[v]);a+=1;break;case C.createText:y(r.charCodeAt(++a),document.createTextNode(m(r.charCodeAt(++a),t)),t),a+=1;break;case C.updateText:var p=m(r.charCodeAt(++a),t),f=m(r.charCodeAt(++a),t);p.textContent=f,a+=1;break;case C.destroyElement:var h=m(r.charCodeAt(++a),t);h.parentNode.destroyChild(h),a+=1;break;case C.appendElement:var l=m(r.charCodeAt(++a),t);m(r.charCodeAt(++a),t).appendChild(l),a+=1;break;case C.returnVar:n(m(r.charCodeAt(++a),t))}}var u={};function p(t){var r=this;this.view.data(),a(0,this,this.view.create,function(e){r.emit("create",e),void 0!==t&&t(e)})}function f(e,t){var r=this;for(var n in e)this[n]=e[n];a(this.view.update,function(){r.emit("update"),void 0!==t&&t()})}function h(e){var t=this;a(this.view.destroy,function(){t.emit("destroy"),void 0!==e&&e()})}function l(e,t){var r=this.events[e];void 0===r?this.events[e]=[t.bind(this)]:r.push(t.bind(this))}function x(e,t){if(void 0===e)this.events={};else if(void 0===t)this.events[e]=[];else{var r=this.events[e];r.splice(r.indexOf(t),1)}}function b(e,t){for(var r=this.events[e],n=0;n<r.length;n++)r[n](t)}function e(e){e.name=void 0===e.name?"Root":e.name;var t=e.view;"string"==typeof t&&(e.view=d(t));var r=e.onCreate,n=e.onUpdate,a=e.onDestroy;function o(e){for(var t in this.view.data=this.view.data.bind(this),e)this[t]=e[t]}delete e.onCreate,delete e.onUpdate,delete e.onDestroy,e.events={create:[],update:[],destroy:[]},void 0!==r&&e.events.create.push(r),void 0!==n&&e.events.update.push(n),void 0!==a&&e.events.destroy.push(a),(o.prototype=e).m=[],o.prototype.create=p,o.prototype.update=f,o.prototype.destroy=h,o.prototype.on=l,o.prototype.off=x,o.prototype.emit=b;var i=e.root;if(delete e.root,"string"==typeof i&&(i=document.querySelector(i)),void 0===i)return u[name]=o;var s=new o;return s.create(function(e){i.appendChild(e)}),s}return e.lex=t,e.parse=r,e.generate=n,e.compile=d,e.execute=a,e.components=u,e});