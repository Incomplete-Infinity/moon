/**
 * Moon v1.0.0-beta.2
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,n){"undefined"==typeof module?e.Moon=n():module.exports=n()}(this,function(){"use strict";var v={element:0,text:1,component:2};var a,u,p,o,N=/<([\w\d-_]+)([^>]*?)(\/?)>/g,k=/\s*([\w\d-_:@]*)(?:=(?:("[^"]*"|'[^']*')|{([^{}]*)}))?/g;function n(e){e=e.trim();for(var n=[],t=0;t<e.length;){var r=e[t];if("<"===r){var a=e[t+1];if("/"===a){var o=e.indexOf(">",t+2),i=e.slice(t+2,o);0,n.push({type:"tagClose",value:i}),t=o+1;continue}if("!"===a&&"-"===e[t+2]&&"-"===e[t+3]){var l=e.indexOf("--\x3e",t+4);0,t=l+3;continue}N.lastIndex=t;var d=N.exec(e);0;for(var u=d[0],p=d[1],f=d[2],c=d[3],s={},v=void 0;null!==(v=k.exec(f));){var h=v[0],m=v[1],g=v[2],y=v[3];0===h.length?k.lastIndex+=1:s[m]=void 0===y?g:y}n.push({type:"tagOpen",value:p,attributes:s,closed:"/"===c}),t+=u.length}else if("{"===r){var w="";for(t+=1;t<e.length;t++){var b=e[t];if("}"===b)break;w+=b}n.push({type:"tagOpen",value:"text",attributes:{"":w},closed:!0}),t+=1}else{for(var x="";t<e.length;t++){var O=e[t];if("<"===O||"{"===O)break;x+=O}n.push({type:"tagOpen",value:"text",attributes:{"":'"'+x+'"'},closed:!0})}}return n}function f(e,n,t,r){this.message=e,this.start=n,this.end=t,this.next=r}function c(e,n,t){var r=t[e],a=t[n-1],o=n-e;if(0==o)return new f("",e,n);if(1==o)return"tagOpen"===r.type&&!0===r.closed?{type:r.value,attributes:r.attributes,children:[]}:new f("",e,n);if("tagOpen"!==r.type||"tagClose"!==a.type||r.value!==a.value)return new f("",e,n);var i=function e(n,t,r){var a;if(0==t-n)return[];for(var o=n+1;o<=t;o++){var i=c(n,o,r);if(i instanceof f)a=i;else{var l=e(o,t,r);if(!(l instanceof f)){for(var d=[i],u=0;u<l.length;u++)d.push(l[u]);return d}}}return new f("",n,t,a)}(e+1,n-1,t);return i instanceof f?new f("",e,n,i):{type:r.value,attributes:r.attributes,children:i}}function t(e){var n=c(0,e.length,e);return n}function l(e){var n,t=e.type;n="text"===t?v.text:t[0]===t[0].toLowerCase()?v.element:v.component;var r="{";for(var a in e.attributes)r+='"'+a+'":'+e.attributes[a]+",";r+="children:[";for(var o="",i=0;i<e.children.length;i++)r+=o+l(e.children[i]),o=",";return"{type:"+n+',name:"'+t+'",data:'+r+"]}}"}function i(e){return l(t(n(e)))}var h,s={};function m(e){p=e}var r=null,y={updateText:0,setAttributes:1,appendElement:2,removeElement:3,replaceElement:4};function g(e){r=requestAnimationFrame(e)}function w(e){var n,t=e.type,r=e.name,a={},o=[];if(t===v.element){n=document.createElement(e.name);var i=e.data;for(var l in i){var d=i[l];"children"!==l&&(a[l]=d,n.setAttribute(l,d))}for(var u=i.children,p=0;p<u.length;p++){var f=w(u[p]);o.push(f),n.appendChild(f.node)}}else{var c=e.data[""];n=document.createTextNode(c),a[""]=c}return a.children=o,{type:t,name:r,data:a,node:n}}function b(e,n,t){for(;;){var r=e.pop(),a=n.pop();if(r!==a){if(r.name!==a.name)t.push({type:y.replaceElement,nodeOld:r,nodeNew:a,nodeParent:null});else if(r.type===v.text)t.push({type:y.updateText,nodeOld:r,nodeNew:a,parent:null});else{t.push({type:y.setAttributes,nodeOld:r,nodeNew:a,nodeParent:null});var o=r.data.children,i=a.data.children,l=o.length,d=i.length;if(l===d)for(var u=0;u<l;u++)e.push(o[u]),n.push(i[u]);else if(d<l){for(var p=0;p<d;p++)e.push(o[p]),n.push(i[p]);for(var f=d;f<l;f++)t.push({type:y.removeElement,nodeOld:o[f],nodeNew:null,nodeParent:r})}else{for(var c=0;c<l;c++)e.push(o[c]),n.push(i[c]);for(var s=l;s<d;s++)t.push({type:y.appendElement,nodeOld:null,nodeNew:i[s],nodeParent:r})}}if(0===e.length){x(t);break}if(8<=performance.now()-h){g(function(){h=performance.now(),b(e,n,t)});break}}}}function x(e){for(var n=0;n<e.length;n++){var t=e[n];switch(t.type){case y.updateText:var r=t.nodeOld,a=t.nodeNew.data[""];r.data[""]=a,r.node.textContent=a;break;case y.setAttributes:var o=t.nodeOld,i=o.data,l=o.node,d=t.nodeNew.data;for(var u in d){var p=d[u];"children"!==u&&(i[u]=p,l.setAttribute(u,p))}break;case y.appendElement:var f=t.nodeNew,c=t.nodeParent,s=w(f);c.data.children.push(s),c.node.appendChild(s.node);break;case y.removeElement:var v=t.nodeParent;v.data.children.pop(),v.node.removeChild(t.nodeOld);break;case y.replaceElement:var h=t.nodeOld,m=w(t.nodeNew),g=h.node;h.type=m.type,h.name=m.name,h.data=m.data,h.node=m.node,g.parentNode.replaceChild(h.node,g)}}}function d(){null!==r&&(cancelAnimationFrame(r),r=null),h=performance.now(),function e(n,t,r){for(;;){var a=n.pop(),o=t.pop(),i=r.pop();a.type===v.component?(a=s[a.name](a.data),null===o?m(a):o.data.children[i]=a):null===o&&m(a);for(var l=a.data.children,d=0;d<l.length;d++)n.push(l[d]),t.push(a),r.push(d);if(0===n.length){b([u],[p],[]);break}if(8<=performance.now()-h){g(function(){h=performance.now(),e(n,t,r)});break}}}([o(a)],[null],[0])}var O=!1;function e(n){var e=function(e,n){return void 0===e?n:e}(n.name,"Root");delete n.name;var t=n.view;delete n.view,"string"==typeof t&&(t=new Function("data","return "+i(t)));var r="string"==typeof n.root?document.querySelector(n.root):n.root;delete n.root,void 0===r?s[e]=function(e){return t(function(e,n){var t={};for(var r in n)t[r]=n[r];for(var a in e)t[a]=e[a];return t}(e,n))}:(function(e){u=e}({type:v.element,name:r.tagName.toLowerCase(),data:{children:[]},node:r}),function(e){o=e}(t),function(e){a=e}(n),d())}return e.lex=n,e.parse=t,e.generate=l,e.compile=i,e.components=s,e.set=function(e){for(var n in e)a[n]=e[n];!1===O&&(O=!0,setTimeout(function(){d(),O=!1},0))},e});