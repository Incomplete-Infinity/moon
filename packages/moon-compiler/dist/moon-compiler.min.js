/**
 * Moon Compiler v1.0.0-beta.4
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(n,e){"undefined"==typeof module?n.MoonCompiler=e():module.exports=e()}(this,function(){"use strict";function o(n,e){this.expected=n,this.index=e}var t={type:function(r,a){return function(n,e){var t=a(n,e);return t instanceof o?t:[{type:r,value:t[0]},t[1]]}},EOF:function(n,e){return e===n.length?["EOF",e]:new o("EOF",e)},empty:function(n,e){return["",e]},any:function(n,e){return e<n.length?[n[e],e+1]:new o("any",e)},character:function(r){return function(n,e){var t=n[e];return t===r?[t,e+1]:new o('"'+r+'"',e)}},regex:function(r){return function(n,e){var t=n[e];return void 0!==t&&r.test(t)?[t,e+1]:new o(r.toString(),e)}},string:function(r){return function(n,e){var t=e+r.length;return n.slice(e,t)===r?[r,t]:new o('"'+r+'"',e)}},not:function(a){return function(n,e){if(e<n.length){for(var t=0;t<a.length;t++){var r=a[t];if(n.slice(e,e+r.length)===r)return new o('not "'+r+'"',e)}return[n[e],e+1]}return new o("not "+a.map(JSON.stringify).join(", "),e)}},or:function(a,c){return function(n,e){var t=a(n,e);if(t instanceof o){var r=c(n,e);return r instanceof o&&t.index>r.index?t:r}return t}},and:function(a,c){return function(n,e){var t=a(n,e);if(t instanceof o)return t;var r=c(n,t[1]);return r instanceof o?r:[[t[0],r[0]],r[1]]}},sequence:function(c){return function(n,e){for(var t=[],r=0;r<c.length;r++){var a=c[r](n,e);if(a instanceof o)return a;t.push(a[0]),e=a[1]}return[t,e]}},alternates:function(c){return function(n,e){for(var t=new o("alternates",-1),r=0;r<c.length;r++){var a=c[r](n,e);if(!(a instanceof o))return a;a.index>t.index&&(t=a)}return t}},many:function(a){return function(n,e){for(var t,r=[];!((t=a(n,e))instanceof o);)r.push(t[0]),e=t[1];return[r,e]}},many1:function(a){return function(n,e){var t=[],r=a(n,e);if(r instanceof o)return r;for(t.push(r[0]),e=r[1];!((r=a(n,e))instanceof o);)t.push(r[0]),e=r[1];return[t,e]}}},r={whitespace:t.alternates([t.character(" "),t.character("\t"),t.character("\n")]),whitespaces:function(n,e){return t.many(r.whitespace)(n,e)},identifier:t.many1(t.regex(/[@$\w.?]/)),string:t.alternates([t.sequence([t.character('"'),t.many(t.or(t.and(t.character("\\"),t.any),t.not(['"']))),t.character('"')]),t.sequence([t.character("'"),t.many(t.or(t.and(t.character("\\"),t.any),t.not(["'"]))),t.character("'")]),t.sequence([t.character("`"),t.many(t.or(t.and(t.character("\\"),t.any),t.not(["`"]))),t.character("`")])]),block:function(n,e){return t.type("block",t.sequence([t.character("{"),r.expression,t.character("}")]))(n,e)},value:function(n,e){return t.alternates([r.string,r.block,r.identifier])(n,e)},text:t.type("text",t.many1(t.alternates([t.and(t.character("\\"),t.character("{")),t.and(t.character("\\"),t.character("<")),t.not(["{","<"])]))),attributes:function(n,e){return t.type("attributes",t.many(t.sequence([r.identifier,t.character("="),r.value,r.whitespaces])))(n,e)},node:function(n,e){return t.type("node",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,t.string("#>")]))(n,e)},nodeData:function(n,e){return t.type("nodeData",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,t.or(r.block,r.attributes),t.string("/>")]))(n,e)},nodeDataChildren:function(n,e){return t.type("nodeDataChildren",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,r.attributes,t.character(">"),t.many(t.alternates([r.node,r.nodeData,r.nodeDataChildren,r.block,r.text])),t.string("</"),t.many(t.not([">"])),t.character(">")]))(n,e)},expression:function(n,e){return t.many(t.alternates([t.sequence([t.string("//"),t.many(t.not(["\n"]))]),t.sequence([t.string("/*"),t.many(t.not(["*/"])),t.string("*/")]),t.sequence([t.character("/"),t.many1(t.or(t.and(t.character("\\"),t.not(["\n"])),t.not(["/","\n"]))),t.character("/")]),r.string,r.block,r.node,r.nodeData,r.nodeDataChildren,t.and(t.alternates([t.character("/"),t.character("<"),t.empty]),t.many1(t.not(["/","{","}","<",'"',"'","`"])))]))(n,e)},main:function(n,e){return t.and(r.expression,t.EOF)(n,e)}};function a(n){return r.main(n,0)}a.Error=o;var g=/^\s+$/;function m(n){return"block"===n.type?"("+w(n.value[1])+")":w(n)}function x(n){for(var e=n.value,t="",r="",a=0;a<e.length;a++){var c=e[a];t+=r+'"'+w(c[0])+'":'+m(c[2])+w(c[3]),r=","}return{output:t,separator:r}}function w(n){var e=n.type;if("string"==typeof n)return n;if(Array.isArray(n)){for(var t="",r=0;r<n.length;r++)t+=w(n[r]);return t}if("block"===e)return w(n.value);if("node"===e){var a=n.value;return w(a[1])+m(a[2])+w(a[3])}if("nodeData"===e){var c=n.value,o=c[4];return""+w(c[1])+m(c[2])+w(c[3])+"("+("attributes"===o.type?"{"+x(o).output+"}":w(o.value[1]))+")"}if("nodeDataChildren"===e){var i,u=n.value,s=x(u[4]),f=u[6],h=f.length;if(0===h)i="";else{var l="";i=s.separator+"children:[";for(var v=0;v<h;v++){var d=f[v],p=d.type;if("text"===p){var y=w(d.value);g.test(y)&&-1!==y.indexOf("\n")?i+=y:(i+=l+"Moon.view.m.text({data:"+JSON.stringify(y)+"})",l=",")}else l=(i+="block"===p?l+"Moon.view.m.text({data:"+w(d.value[1])+"})":l+w(d),",")}i+="]"}return""+w(u[1])+m(u[2])+w(u[3])+"({"+s.output+i+"})"}}function d(n,e){for(var t=e-n.length,r=0;r<t;r++)n=" "+n;return n}return{compile:function(n){var e,t=a(n);return t instanceof a.Error&&(e="Invalid input to parser.\n\nAttempted to parse input.\n\nExpected "+t.expected+".\n\nReceived:\n\n"+function(n,e){for(var t=n.split("\n"),r=1,a=1,c=0;c<n.length;c++){var o=n[c];if(c===e){var i=r-1,u=r+1,s=Math.max(Math.floor(Math.log10(i)+1),Math.floor(Math.log10(r)+1),Math.floor(Math.log10(u)+1))+2,f=t[i-1],h=t[r-1],l=t[u-1],v="";return void 0!==f&&(v+=d(i+"| ",s)+f+"\n"),v+=d(r+"| ",s)+h+"\n"+d("| ",s)+d("^",a),void 0!==l&&(v+="\n"+d(u+"| ",s)+l),v}"\n"===o?(r+=1,a=1):a+=1}}(n,t.index),console.error("[Moon] ERROR: "+e)),w(t[0][0])},generate:w,parse:a}});