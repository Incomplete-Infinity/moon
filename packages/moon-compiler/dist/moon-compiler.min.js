/**
 * Moon Compiler v1.0.0-beta.4
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(n,e){"undefined"==typeof module?n.MoonCompiler=e():module.exports=e()}(this,function(){"use strict";function i(n,e){this.expected=n,this.index=e}var t={type:function(r,a){return function(n,e){var t=a(n,e);return t instanceof i?t:[{type:r,value:t[0]},t[1]]}},EOF:function(n,e){return e===n.length?["EOF",e]:new i("EOF",e)},empty:function(n,e){return["",e]},any:function(n,e){return e<n.length?[n[e],e+1]:new i("any",e)},character:function(r){return function(n,e){var t=n[e];return t===r?[t,e+1]:new i('"'+r+'"',e)}},regex:function(r){return function(n,e){var t=n[e];return void 0!==t&&r.test(t)?[t,e+1]:new i(r.toString(),e)}},string:function(r){return function(n,e){var t=e+r.length;return n.slice(e,t)===r?[r,t]:new i('"'+r+'"',e)}},not:function(a){return function(n,e){if(e<n.length){for(var t=0;t<a.length;t++){var r=a[t];if(n.slice(e,e+r.length)===r)return new i('not "'+r+'"',e)}return[n[e],e+1]}return new i("not "+a.map(JSON.stringify).join(", "),e)}},or:function(a,o){return function(n,e){var t=a(n,e);if(t instanceof i){var r=o(n,e);return r instanceof i&&t.index>r.index?t:r}return t}},and:function(a,o){return function(n,e){var t=a(n,e);if(t instanceof i)return t;var r=o(n,t[1]);return r instanceof i?r:[[t[0],r[0]],r[1]]}},sequence:function(o){return function(n,e){for(var t=[],r=0;r<o.length;r++){var a=o[r](n,e);if(a instanceof i)return a;t.push(a[0]),e=a[1]}return[t,e]}},alternates:function(o){return function(n,e){for(var t=new i("alternates",-1),r=0;r<o.length;r++){var a=o[r](n,e);if(!(a instanceof i))return a;a.index>t.index&&(t=a)}return t}},many:function(a){return function(n,e){for(var t,r=[];!((t=a(n,e))instanceof i);)r.push(t[0]),e=t[1];return[r,e]}},many1:function(a){return function(n,e){var t=[],r=a(n,e);if(r instanceof i)return r;for(t.push(r[0]),e=r[1];!((r=a(n,e))instanceof i);)t.push(r[0]),e=r[1];return[t,e]}}},r={whitespace:t.alternates([t.character(" "),t.character("\t"),t.character("\n")]),whitespaces:function(n,e){return t.many(r.whitespace)(n,e)},identifier:t.many1(t.regex(/[@$\w.?]/)),string:t.alternates([t.sequence([t.character('"'),t.many(t.or(t.and(t.character("\\"),t.any),t.not(['"']))),t.character('"')]),t.sequence([t.character("'"),t.many(t.or(t.and(t.character("\\"),t.any),t.not(["'"]))),t.character("'")]),t.sequence([t.character("`"),t.many(t.or(t.and(t.character("\\"),t.any),t.not(["`"]))),t.character("`")])]),block:function(n,e){return t.type("block",t.sequence([t.character("{"),r.expression,t.character("}")]))(n,e)},value:function(n,e){return t.alternates([r.string,r.block,r.identifier])(n,e)},text:t.type("text",t.many1(t.not(["{","<"]))),attributes:function(n,e){return t.type("attributes",t.many(t.sequence([r.identifier,t.character("="),r.value,r.whitespaces])))(n,e)},node:function(n,e){return t.type("node",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,t.string("#>")]))(n,e)},nodeData:function(n,e){return t.type("nodeData",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,t.or(r.block,r.attributes),t.string("/>")]))(n,e)},nodeDataChildren:function(n,e){return t.type("nodeDataChildren",t.sequence([t.character("<"),r.whitespaces,r.value,r.whitespaces,r.attributes,t.character(">"),t.many(t.alternates([r.node,r.nodeData,r.nodeDataChildren,r.block,r.text])),t.string("</"),t.many(t.not([">"])),t.character(">")]))(n,e)},expression:function(n,e){return t.many(t.alternates([t.sequence([t.string("//"),t.many(t.not(["\n"]))]),t.sequence([t.string("/*"),t.many(t.not(["*/"])),t.string("*/")]),t.sequence([t.character("/"),t.many1(t.or(t.and(t.character("\\"),t.not(["\n"])),t.not(["/","\n"]))),t.character("/")]),r.block,r.string,r.node,r.nodeData,r.nodeDataChildren,t.and(t.alternates([t.character("/"),t.character("<"),t.empty]),t.many1(t.not(["/","{","}","<",'"',"'","`"])))]))(n,e)},main:function(n,e){return t.and(r.expression,t.EOF)(n,e)}};function a(n){return r.main(n,0)}function w(n){return"block"===n.type?"("+b(n.value[1])+")":b(n)}function b(n){var e=n.type;if("string"==typeof n)return n;if(Array.isArray(n)){for(var t="",r=0;r<n.length;r++)t+=b(n[r]);return t}if("block"===e)return b(n.value);if("text"===e)return"Moon.view.m.text({value:"+JSON.stringify(b(n.value))+"})";if("attributes"===e){for(var a=n.value,o="",i="",c=0;c<a.length;c++){var u=a[c];o+=i+'"'+b(u[0])+'":'+w(u[2])+b(u[3]),i=","}return{output:o,separator:i}}if("node"===e){var s=n.value;return b(s[1])+w(s[2])+b(s[3])}if("nodeData"===e){var f=n.value,h=f[4];return""+b(f[1])+w(f[2])+b(f[3])+"("+("attributes"===h.type?"{"+b(h).output+"}":w(h))+")"}if("nodeDataChildren"===e){var l,v=n.value,p=b(v[4]),d=v[6],y=d.length;if(0===y)l="";else{var g="";l=p.separator+"children:[";for(var m=0;m<y;m++){var x=d[m];"block"===x.type?l+=g+"Moon.view.m.text({value:"+w(x)+"})":l+=g+b(x),g=","}l+="]"}return""+b(v[1])+w(v[2])+b(v[3])+"({"+p.output+l+"})"}}function p(n,e){for(var t=e-n.length,r=0;r<t;r++)n=" "+n;return n}return a.Error=i,{compile:function(n){var e=a(n);return e instanceof a.Error&&function(n){console.error("[Moon] ERROR: "+n)}("Invalid input to parser.\n\nAttempted to parse input.\n\nExpected "+e.expected+".\n\nReceived:\n\n"+function(n,e){for(var t=n.split("\n"),r=1,a=1,o=0;o<n.length;o++){var i=n[o];if(o===e){var c=r-1,u=r+1,s=Math.max(Math.floor(Math.log10(c)+1),Math.floor(Math.log10(r)+1),Math.floor(Math.log10(u)+1))+2,f=t[c-1],h=t[r-1],l=t[u-1],v="";return void 0!==f&&(v+=p(c+"| ",s)+f+"\n"),v+=p(r+"| ",s)+h+"\n"+p("| ",s)+p("^",a),void 0!==l&&(v+="\n"+p(u+"| ",s)+l),v}"\n"===i?(r+=1,a=1):a+=1}}(n,e.index)),b(e[0][0])},generate:b,parse:a}});