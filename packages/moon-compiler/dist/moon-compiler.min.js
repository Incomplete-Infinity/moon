/**
 * Moon Compiler v1.0.0-beta.4
 * Copyright 2016-2019 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(n,e){"undefined"==typeof module?n.MoonCompiler=e():module.exports=e()}(this,(function(){"use strict";function n(n,e){this.expected=n,this.index=e}var e={type:function(e,t){return function(r,a){var o=t(r,a);return o instanceof n?o:[{type:e,value:o[0]},o[1]]}},EOF:function(e,t){return t===e.length?["EOF",t]:new n("EOF",t)},empty:function(n,e){return["",e]},any:function(e,t){return t<e.length?[e[t],t+1]:new n("any",t)},character:function(e){return function(t,r){var a=t[r];return a===e?[a,r+1]:new n('"'+e+'"',r)}},regex:function(e){return function(t,r){var a=t[r];return void 0!==a&&e.test(a)?[a,r+1]:new n(e.toString(),r)}},string:function(e){return function(t,r){var a=r+e.length;return t.slice(r,a)===e?[e,a]:new n('"'+e+'"',r)}},not:function(e){return function(t,r){if(r<t.length){for(var a=0;a<e.length;a++){var o=e[a];if(t.slice(r,r+o.length)===o)return new n('not "'+o+'"',r)}return[t[r],r+1]}return new n("not "+e.map(JSON.stringify).join(", "),r)}},or:function(e,t){return function(r,a){var o=e(r,a);if(o instanceof n){var c=t(r,a);return c instanceof n&&o.index>c.index?o:c}return o}},and:function(e,t){return function(r,a){var o=e(r,a);if(o instanceof n)return o;var c=t(r,o[1]);return c instanceof n?c:[[o[0],c[0]],c[1]]}},sequence:function(e){return function(t,r){for(var a=[],o=0;o<e.length;o++){var c=e[o](t,r);if(c instanceof n)return c;a.push(c[0]),r=c[1]}return[a,r]}},alternates:function(e){return function(t,r){for(var a=new n("alternates",-1),o=0;o<e.length;o++){var c=e[o](t,r);if(!(c instanceof n))return c;c.index>a.index&&(a=c)}return a}},many:function(e){return function(t,r){for(var a,o=[];!((a=e(t,r))instanceof n);)o.push(a[0]),r=a[1];return[o,r]}},many1:function(e){return function(t,r){var a=[],o=e(t,r);if(o instanceof n)return o;for(a.push(o[0]),r=o[1];!((o=e(t,r))instanceof n);)a.push(o[0]),r=o[1];return[a,r]}}},t={whitespace:e.alternates([e.character(" "),e.character("\t"),e.character("\n")]),whitespaces:function(n,r){return e.many(t.whitespace)(n,r)},identifier:e.many1(e.regex(/[@$\w.?]/)),string:e.alternates([e.sequence([e.character('"'),e.many(e.or(e.and(e.character("\\"),e.any),e.not(['"']))),e.character('"')]),e.sequence([e.character("'"),e.many(e.or(e.and(e.character("\\"),e.any),e.not(["'"]))),e.character("'")]),e.sequence([e.character("`"),e.many(e.or(e.and(e.character("\\"),e.any),e.not(["`"]))),e.character("`")])]),block:function(n,r){return e.type("block",e.sequence([e.character("{"),t.expression,e.character("}")]))(n,r)},value:function(n,r){return e.alternates([t.string,t.block,t.identifier])(n,r)},text:e.type("text",e.many1(e.or(e.and(e.character("\\"),e.any),e.not(["{","<"])))),attributes:function(n,r){return e.type("attributes",e.many(e.sequence([t.identifier,e.character("="),t.value,t.whitespaces])))(n,r)},node:function(n,r){return e.type("node",e.sequence([e.character("<"),t.whitespaces,t.value,t.whitespaces,e.string("#>")]))(n,r)},nodeData:function(n,r){return e.type("nodeData",e.sequence([e.character("<"),t.whitespaces,t.value,t.whitespaces,e.or(t.block,t.attributes),e.string("/>")]))(n,r)},nodeDataChildren:function(n,r){return e.type("nodeDataChildren",e.sequence([e.character("<"),t.whitespaces,t.value,t.whitespaces,t.attributes,e.character(">"),e.many(e.alternates([t.node,t.nodeData,t.nodeDataChildren,t.block,t.text])),e.string("</"),e.many(e.not([">"])),e.character(">")]))(n,r)},expression:function(n,r){return e.many(e.alternates([e.sequence([e.string("//"),e.many(e.not(["\n"]))]),e.sequence([e.string("/*"),e.many(e.not(["*/"])),e.string("*/")]),e.sequence([e.character("/"),e.many1(e.or(e.and(e.character("\\"),e.not(["\n"])),e.not(["/","\n"]))),e.character("/")]),t.string,t.block,t.node,t.nodeData,t.nodeDataChildren,e.and(e.alternates([e.character("/"),e.character("<"),e.empty]),e.many1(e.not(["/","{","}","<",'"',"'","`"])))]))(n,r)},main:function(n,r){return e.and(t.expression,e.EOF)(n,r)}};function r(n){return t.main(n,0)}r.Error=n;var a=/^\s+$/,o=/([^\\])("|\n)/g;function c(n){return"block"===n.type?"("+u(n.value[1])+")":u(n)}function i(n){for(var e=n.value,t="",r="",a=0;a<e.length;a++){var o=e[a];t+=r+'"'+u(o[0])+'":'+c(o[2])+u(o[3]),r=","}return{output:t,separator:r}}function u(n){var e=n.type;if("string"==typeof n)return n;if(Array.isArray(n)){for(var t="",r=0;r<n.length;r++)t+=u(n[r]);return t}if("block"===e)return u(n.value);if("node"===e){var s=n.value;return u(s[1])+c(s[2])+u(s[3])}if("nodeData"===e){var f=n.value,h=f[4];return""+u(f[1])+c(f[2])+u(f[3])+"("+("attributes"===h.type?"{"+i(h).output+"}":u(h.value[1]))+")"}if("nodeDataChildren"===e){var l,v=n.value,d=i(v[4]),p=v[6],y=p.length;if(0===y)l="";else{var g="";l=d.separator+"children:[";for(var m=0;m<y;m++){var x=p[m],w=x.type;if("text"===w){var b=u(x.value);a.test(b)&&-1!==b.indexOf("\n")?l+=b:(l+=g+'Moon.view.m.text({data:"'+b.replace(o,(function(n,e,t){return e+"\\"+t}))+'"})',g=",")}else"block"===w?(l+=g+"Moon.view.m.text({data:"+u(x.value[1])+"})",g=","):(l+=g+u(x),g=",")}l+="]"}return""+u(v[1])+c(v[2])+u(v[3])+"({"+d.output+l+"})"}}function s(n,e){for(var t=e-n.length,r=0;r<t;r++)n=" "+n;return n}return{compile:function(n){var e,t=r(n);return t instanceof r.Error&&(e="Invalid input to parser.\n\nAttempted to parse input.\n\nExpected "+t.expected+".\n\nReceived:\n\n"+function(n,e){for(var t=n.split("\n"),r=1,a=1,o=0;o<n.length;o++){var c=n[o];if(o===e){var i=r-1,u=r+1,f=Math.max(Math.floor(Math.log10(i)+1),Math.floor(Math.log10(r)+1),Math.floor(Math.log10(u)+1))+2,h=t[i-1],l=t[r-1],v=t[u-1],d="";return void 0!==h&&(d+=s(i+"| ",f)+h+"\n"),d+=s(r+"| ",f)+l+"\n"+s("| ",f)+s("^",a),void 0!==v&&(d+="\n"+s(u+"| ",f)+v),d}"\n"===c?(r+=1,a=1):a+=1}}(n,t.index),console.error("[Moon] ERROR: "+e)),u(t[0][0])},generate:u,parse:r}}));